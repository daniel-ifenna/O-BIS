module.exports=[99916,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(50944),f=a.i(40695),g=a.i(3130),h=a.i(21958),i=a.i(15618),j=a.i(77156),k=a.i(92759),l=a.i(34157),l=l,m=a.i(81010);let n=(0,a.i(70106).default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var o=a.i(73570),p=a.i(63588),q=a.i(5522),r=a.i(17171),s=a.i(46893),t=a.i(87682),u=a.i(73320),v=a.i(33508),w=a.i(21937),x=a.i(77687);function y({isOpen:a,onClose:d,onCreate:e}){let{user:f}=(0,w.useAuth)(),[g,h]=(0,c.useState)({title:"",category:"",location:"",description:"",detailedDescription:"",bidDays:"14",maxBids:"10",budget:"",estimatedCost:"",contingencyPercent:"10",paymentSchedule:"milestone",paymentTerms:"net30",retentionPercent:"5"}),[i,j]=(0,c.useState)({itb:null,specs:null,boq:null,financial:null}),[k,l]=(0,c.useState)({itbUrl:"",specsUrl:"",boqUrl:"",financialUrl:""}),[m,n]=(0,c.useState)(!1),o=a=>{h(b=>({...b,[a.target.name]:a.target.value}))},p=(a,b)=>{h(c=>({...c,[b]:a}))},y=async a=>{a.preventDefault(),n(!0);try{if(!g.title||!g.category||!g.location||!g.budget||!g.estimatedCost){(0,x.toast)({title:"Missing fields",description:"Please fill in all required fields",variant:"destructive"}),n(!1);return}let a={id:Date.now(),title:g.title,location:g.location,budget:String(Number(g.budget)),status:"Published",bids:0,category:g.category,description:g.description,detailedDescription:g.detailedDescription,estimatedCost:g.estimatedCost?String(Number(g.estimatedCost)):"",contingency:String(Math.round(Number(g.estimatedCost||0)*(Number(g.contingencyPercent||0)/100))),contingencyPercent:String(Number(g.contingencyPercent||0)),paymentSchedule:g.paymentSchedule,paymentTerms:g.paymentTerms,retentionPercent:String(Number(g.retentionPercent||0)),bidDays:Number(g.bidDays||0),maxBids:Number(g.maxBids||0),clientName:f?.name||"",clientCompany:f?.company||"",documents:{itb:i.itb?.name||"",itbUrl:k.itbUrl||"",specs:i.specs?.name||"",specsUrl:k.specsUrl||"",boq:i.boq?.name||"",boqUrl:k.boqUrl||"",financial:i.financial?.name||"",financialUrl:k.financialUrl||""}},b=await e(a);if(b&&b.ok)(0,x.toast)({title:"Project published",description:a.title});else{let a=b?.error||"Failed to create project. Please try again.";(0,x.toast)({title:"Publish failed",description:a,variant:"destructive"}),n(!1);return}h({title:"",category:"",location:"",description:"",detailedDescription:"",bidDays:"14",maxBids:"10",budget:"",estimatedCost:"",contingencyPercent:"10",paymentSchedule:"milestone",paymentTerms:"net30",retentionPercent:"5"}),j({itb:null,specs:null,boq:null,financial:null}),l({itbUrl:"",specsUrl:"",boqUrl:"",financialUrl:""}),d()}catch(a){(0,x.toast)({title:"Publish failed",description:"Unexpected error",variant:"destructive"})}finally{n(!1)}};return a?(0,b.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4 overflow-y-auto",children:(0,b.jsxs)("form",{onSubmit:y,className:"bg-background rounded-lg shadow-lg w-full max-w-2xl my-8 flex flex-col max-h-[90vh]",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-border flex-shrink-0",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Create New Project"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Set up a project to start receiving bids"})]}),(0,b.jsx)("button",{type:"button",onClick:d,className:"text-muted-foreground hover:text-foreground transition-colors",children:(0,b.jsx)(v.X,{className:"w-6 h-6"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6 overflow-y-auto flex-1",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:"Project Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"title",children:"Project Title *"}),(0,b.jsx)(q.Input,{id:"title",name:"title",placeholder:"e.g., Office Building Renovation",value:g.title,onChange:o,required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"category",children:"Category *"}),(0,b.jsxs)(t.Select,{value:g.category,onValueChange:a=>p(a,"category"),children:[(0,b.jsx)(t.SelectTrigger,{id:"category",children:(0,b.jsx)(t.SelectValue,{placeholder:"Select category"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"commercial",children:"Commercial"}),(0,b.jsx)(t.SelectItem,{value:"residential",children:"Residential"}),(0,b.jsx)(t.SelectItem,{value:"industrial",children:"Industrial"}),(0,b.jsx)(t.SelectItem,{value:"infrastructure",children:"Infrastructure"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"location",children:"Location *"}),(0,b.jsx)(q.Input,{id:"location",name:"location",placeholder:"e.g., Downtown, City",value:g.location,onChange:o,required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"budget",children:"Client Budget Allocation *"}),(0,b.jsx)(q.Input,{id:"budget",name:"budget",type:"number",placeholder:"e.g., 250000000",value:g.budget,onChange:o,required:!0})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"description",children:"Short Description *"}),(0,b.jsx)(s.Textarea,{id:"description",name:"description",placeholder:"Brief overview of the project",value:g.description,onChange:o,className:"min-h-20",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"detailedDescription",children:"Detailed Description"}),(0,b.jsx)(s.Textarea,{id:"detailedDescription",name:"detailedDescription",placeholder:"Comprehensive project details, requirements, and specifications",value:g.detailedDescription,onChange:o,className:"min-h-20"})]})]}),(0,b.jsxs)("div",{className:"space-y-4 bg-card/50 p-4 rounded-lg border border-border/50",children:[(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:"Financial Specifications"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"estimatedCost",children:"Estimated Project Cost *"}),(0,b.jsx)(q.Input,{id:"estimatedCost",name:"estimatedCost",type:"number",placeholder:"e.g., 250000000",value:g.estimatedCost,onChange:o,required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"contingencyPercent",children:"Contingency % *"}),(0,b.jsx)(q.Input,{id:"contingencyPercent",name:"contingencyPercent",type:"number",min:"0",max:"100",placeholder:"e.g., 10",value:g.contingencyPercent,onChange:o,required:!0}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Contingency Amount: ₦",Math.round(Number(g.estimatedCost||0)*(Number(g.contingencyPercent||0)/100)).toLocaleString()]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"paymentSchedule",children:"Payment Schedule *"}),(0,b.jsxs)(t.Select,{value:g.paymentSchedule,onValueChange:a=>p(a,"paymentSchedule"),children:[(0,b.jsx)(t.SelectTrigger,{id:"paymentSchedule",children:(0,b.jsx)(t.SelectValue,{placeholder:"Select payment schedule"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"upfront",children:"Upfront"}),(0,b.jsx)(t.SelectItem,{value:"milestone",children:"Milestone Based"}),(0,b.jsx)(t.SelectItem,{value:"monthly",children:"Monthly Installments"}),(0,b.jsx)(t.SelectItem,{value:"completion",children:"Upon Completion"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"paymentTerms",children:"Payment Terms *"}),(0,b.jsxs)(t.Select,{value:g.paymentTerms,onValueChange:a=>p(a,"paymentTerms"),children:[(0,b.jsx)(t.SelectTrigger,{id:"paymentTerms",children:(0,b.jsx)(t.SelectValue,{placeholder:"Select payment terms"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"cash",children:"Cash on Delivery"}),(0,b.jsx)(t.SelectItem,{value:"net30",children:"Net 30 Days"}),(0,b.jsx)(t.SelectItem,{value:"net60",children:"Net 60 Days"}),(0,b.jsx)(t.SelectItem,{value:"net90",children:"Net 90 Days"})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"retentionPercent",children:"Retention Percentage *"}),(0,b.jsx)(q.Input,{id:"retentionPercent",name:"retentionPercent",type:"number",min:"0",max:"100",placeholder:"e.g., 5",value:g.retentionPercent,onChange:o,required:!0}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Retention Amount: ₦",Math.round(Number(g.estimatedCost||0)*(Number(g.retentionPercent||0)/100)).toLocaleString()]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:"Bidding Rules"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"bidDays",children:"Bid Submission Days *"}),(0,b.jsx)(q.Input,{id:"bidDays",name:"bidDays",type:"number",value:g.bidDays,onChange:o,required:!0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"How many days to accept bids"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"maxBids",children:"Maximum Bids to Accept *"}),(0,b.jsx)(q.Input,{id:"maxBids",name:"maxBids",type:"number",value:g.maxBids,onChange:o,required:!0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Leave blank for unlimited"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:"Required Documents"}),(0,b.jsx)("div",{className:"space-y-4",children:[{key:"itb",label:"Invitation to Bid (ITB)",description:"PDF document"},{key:"specs",label:"Project Specifications",description:"Technical specifications"},{key:"boq",label:"Bill of Quantities (BoQ)",description:"Cost breakdown"},{key:"financial",label:"Financial Specifications",description:"Payment, retention, terms"}].map(a=>(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:a.label}),(0,b.jsxs)("div",{className:"border-2 border-dashed border-border rounded-lg p-4 text-center hover:border-primary/50 transition-colors cursor-pointer",children:[(0,b.jsx)("input",{type:"file",onChange:b=>((a,b)=>{let c=a.target.files?.[0];if(c){j(a=>({...a,[b]:c}));let a=new FileReader;a.onload=()=>{let c="string"==typeof a.result?a.result:"";l(a=>({...a,["itb"===b?"itbUrl":"specs"===b?"specsUrl":"boq"===b?"boqUrl":"financialUrl"]:c}))},a.readAsDataURL(c)}})(b,a.key),className:"hidden",id:a.key,accept:".pdf,.doc,.docx"}),(0,b.jsxs)("label",{htmlFor:a.key,className:"cursor-pointer flex flex-col items-center gap-2",children:[(0,b.jsx)(u.Upload,{className:"w-6 h-6 text-muted-foreground"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:i[a.key]?.name||"Click to upload"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.description})]})]})]},a.key))})]})]}),(0,b.jsxs)("div",{className:"flex gap-4 p-6 border-t border-border flex-shrink-0",children:[(0,b.jsx)("button",{type:"button",onClick:d,className:"flex-1 px-4 py-2 border border-border rounded-md hover:bg-background/80 transition-colors disabled:opacity-50",disabled:m,children:"Cancel"}),(0,b.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50",disabled:m,children:m?"Publishing...":"Publish Project"})]})]})}):null}var z=a.i(85850),A=a.i(84767),B=a.i(75652),C=a.i(72844),D=a.i(29664);function E(){let{projects:a,addProject:q,setSelectedProjectId:r,getProject:s,deleteProject:t}=(0,z.useProjects)(),{user:u,signOut:v}=(0,w.useAuth)(),D=(0,e.useRouter)(),[E,G]=(0,c.useState)(!1),{getComplaintsByManager:H}=(0,B.useComplaints)(),I=u?H(u.id):[],J=I.filter(a=>"open"===a.status),K=I.filter(a=>"open"===a.status||"investigating"===a.status),L=async a=>{let b=await q(a);return b?.ok&&G(!1),b},{bids:M}=(0,A.useBids)(),N=[...M].sort((a,b)=>new Date(b.submittedAt).getTime()-new Date(a.submittedAt).getTime()).reverse(),[O,P]=(0,c.useState)(0);(0,c.useEffect)(()=>{let a=N[0]?new Date(N[0].submittedAt).getTime():0;if(a>0&&0===O)return void P(a);if(a>O){let b=N[0];if(b){let a=s(b.projectId)?.title||`Project ${b.projectId}`;(0,x.toast)({title:"New bid submitted",description:`${b.companyName} • ${a}`})}P(a)}},[N]);let Q=[],R=[],[S,T]=(0,c.useState)({}),[U,V]=(0,c.useState)({});(0,c.useEffect)(()=>{(async()=>{try{let b={},c={};for(let d of a){let a=String(d.id);try{let c=await fetch(`/api/projects/${a}/daily-reports`);if(c.ok){let d=await c.json();b[a]=d.slice(0,3)}}catch{}try{let b=await fetch(`/api/projects/${a}/milestones`);if(b.ok){let d=await b.json(),e=Math.round(d.reduce((a,b)=>a+Number(b.weight||0)*Number(b.progress||0)/100,0));c[a]=e}}catch{}}T(b),V(c)}catch{}})()},[a]);let W=(a,c="default")=>{if("procurement"===c)switch(a){case"pending":return(0,b.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-xs font-semibold",children:"Pending Quotes"});case"quoted":return(0,b.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs font-semibold",children:"Quotes Received"});case"awarded":return(0,b.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-xs font-semibold",children:"Vendor Selected"});default:return null}if("payment"===c)return(0,b.jsx)("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 rounded text-xs font-semibold",children:"Pending Approval"})};return(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)("header",{className:"border-b border-border bg-card/50 backdrop-blur-sm sticky top-0 z-40",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex justify-between items-center",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{onClick:()=>D.push("/"),className:"p-2 hover:bg-accent/10 rounded-lg transition-colors",title:"Go to home",children:(0,b.jsx)(m.Home,{className:"w-5 h-5 text-foreground"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Manager Portal"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage projects and bids"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"text-right hidden sm:block",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-foreground",children:u?.name}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:u?.company})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Button,{onClick:()=>G(!0),className:"bg-primary hover:bg-primary/90",children:[(0,b.jsx)(i.Plus,{className:"w-4 h-4 mr-2"}),"New Project"]}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:v,className:"gap-2 bg-transparent",children:[(0,b.jsx)(n,{className:"w-4 h-4"}),"Sign Out"]})]})]})]})}),(0,b.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[K.length>0&&(0,b.jsx)(g.Card,{className:"bg-destructive/10 border-destructive/30 mb-6",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(o.AlertTriangle,{className:"w-5 h-5 text-destructive"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-destructive",children:"Contractor Complaints"}),(0,b.jsxs)("p",{className:"text-sm text-destructive/80",children:[J.length," new complaint(s) requiring your attention"]})]})]}),(0,b.jsx)(d.default,{href:"/manager/complaints",children:(0,b.jsx)(f.Button,{size:"sm",className:"bg-destructive hover:bg-destructive/90",children:"Review Now"})})]})})}),(0,b.jsxs)(h.Tabs,{defaultValue:"projects",className:"space-y-6",children:[(0,b.jsxs)(h.TabsList,{children:[(0,b.jsx)(h.TabsTrigger,{value:"projects",children:"My Projects"}),(0,b.jsx)(h.TabsTrigger,{value:"bids",children:"Recent Bids"}),(0,b.jsx)(h.TabsTrigger,{value:"reports",children:"Recent Daily Reports"}),(0,b.jsx)(h.TabsTrigger,{value:"milestones",children:"Milestone Summary"}),(0,b.jsx)(h.TabsTrigger,{value:"procurement",children:"Procurement Requests"}),(0,b.jsx)(h.TabsTrigger,{value:"payments",children:"Payment Approvals"}),(0,b.jsxs)(h.TabsTrigger,{value:"complaints",children:["Complaints (",I.length,")"]})]}),(0,b.jsx)(h.TabsContent,{value:"projects",className:"space-y-4",children:(0,b.jsx)("div",{className:"grid gap-4",children:a.filter(a=>!a.contractorId).map(a=>(0,b.jsxs)(g.Card,{className:"bg-card/60 border-border/50 hover:border-primary/30 transition-colors cursor-pointer",onClick:()=>{r(a.id)},children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(g.CardTitle,{children:a.title}),(0,b.jsx)(g.CardDescription,{children:a.location})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-primary",children:(0,C.formatNaira)(Number(a.budget||0))}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[M.filter(b=>String(b.projectId)===String(a.id)).length," bids received"]}),(0,b.jsxs)("p",{className:"text-xs font-semibold text-accent mt-1",children:["Overall Progress: ",U[String(a.id)]??0,"%"]})]})]})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Bids Received"}),(0,b.jsx)("p",{className:"font-semibold",children:M.filter(b=>String(b.projectId)===String(a.id)).length})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Created"}),(0,b.jsx)("p",{className:"font-semibold text-sm",children:a.createdAt})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(d.default,{href:`/manager/project/${a.id}`,children:(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(j.Eye,{className:"w-4 h-4 mr-1"}),"View"]})}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>D.push(`/manager/project/${a.id}`),children:[(0,b.jsx)(k.Send,{className:"w-4 h-4 mr-1"}),"Manage"]}),(0,b.jsx)(f.Button,{variant:"destructive",size:"sm",onClick:b=>{b.stopPropagation(),console.log("Dashboard Delete clicked",a.id),t(a.id)},children:"Delete"})]})]})})]},a.id))})}),(0,b.jsx)(h.TabsContent,{value:"bids",className:"space-y-4",children:N.length>0?N.map(a=>(0,b.jsx)(g.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold",children:a.companyName}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:s(a.projectId)?.title||`Project ${a.projectId}`}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(a.submittedAt).toLocaleString()})]}),(0,b.jsxs)("div",{className:"text-right mr-4",children:[(0,b.jsx)("p",{className:"text-lg font-bold text-accent",children:(0,C.formatNaira)(a.amount)}),(0,b.jsx)("p",{className:`text-xs font-semibold ${"New"===a.status?"text-accent":"text-muted-foreground"}`,children:a.status})]}),(0,b.jsx)(d.default,{href:`/manager/project/${a.projectId}`,children:(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(l.default,{className:"w-4 h-4 mr-1"}),"Review"]})})]})})},a.id)):(0,b.jsx)(g.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"No recent bids"})})})}),(0,b.jsxs)(h.TabsContent,{value:"procurement",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold",children:"Active Procurement Requests"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Review and approve vendor quotes"})]}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",children:"View All"})]}),Q.length>0?Q.map(a=>(0,b.jsx)(g.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsxs)(g.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold text-lg",children:a.item}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.project}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Quantity: ",a.quantity," ",a.unit]})]}),(0,b.jsxs)("div",{className:"text-right",children:[W(a.status,"procurement"),(0,b.jsxs)("p",{className:"text-sm mt-2 font-semibold",children:[a.quotes," quotes"]})]})]}),(0,b.jsxs)("div",{className:"mt-4 flex gap-2 pt-4 border-t border-border",children:[(0,b.jsx)(d.default,{href:`/manager/procurement/${a.id}`,className:"flex-1",children:(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",className:"w-full bg-transparent",children:[(0,b.jsx)(j.Eye,{className:"w-4 h-4 mr-1"}),"Review Quotes"]})}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",className:"flex-1 bg-transparent",children:[(0,b.jsx)(k.Send,{className:"w-4 h-4 mr-1"}),"Approve Vendor"]})]})]})},a.id)):(0,b.jsx)(g.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"No active procurement requests"})})})]}),(0,b.jsxs)(h.TabsContent,{value:"payments",className:"space-y-4",children:[(0,b.jsx)(g.Card,{className:"bg-card/60 border-border/50 mb-4",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex justify-between p-4 bg-primary/5 rounded-lg border border-primary/20",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold",children:"Escrow Balance"}),(0,b.jsx)(F,{})]}),(0,b.jsx)(d.default,{href:"/manager/payments",children:(0,b.jsx)(f.Button,{variant:"outline",children:"View All"})})]})})}),R.length>0?R.map(a=>(0,b.jsx)(g.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsxs)(g.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold",children:a.requester}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.project}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Milestone: ",a.milestone]})]}),(0,b.jsxs)("div",{className:"text-right",children:[W(a.status,"payment"),(0,b.jsx)("p",{className:"text-lg font-bold text-primary mt-2",children:(0,C.formatNaira)(a.amount)})]})]}),(0,b.jsx)("div",{className:"mt-4 flex gap-2 pt-4 border-t border-border",children:(0,b.jsx)(d.default,{href:`/manager/payments/${a.id}/review`,className:"flex-1",children:(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",className:"w-full bg-transparent",children:[(0,b.jsx)(l.default,{className:"w-4 h-4 mr-1"}),"Review"]})})})]})},a.id)):(0,b.jsx)(g.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"No pending payment requests"})})})]}),(0,b.jsx)(h.TabsContent,{value:"reports",className:"space-y-4",children:a.length>0?a.map(a=>(0,b.jsx)(g.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsxs)(g.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold",children:a.title}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Last 3 reports"})]}),(0,b.jsx)(d.default,{href:`/manager/project/${a.id}/overview`,children:(0,b.jsx)(f.Button,{variant:"outline",size:"sm",children:"View Overview"})})]}),(0,b.jsx)("div",{className:"mt-3 space-y-2",children:(S[String(a.id)]||[]).length>0?(S[String(a.id)]||[]).map((a,c)=>(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsxs)("span",{children:[a.date," ",a.time," • ",a.workDescription]}),(0,b.jsxs)("span",{className:"text-primary font-semibold",children:[a.workPercentage,"%"]})]},c)):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No reports"})})]})},a.id)):(0,b.jsx)(g.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"No projects"})})})}),(0,b.jsx)(h.TabsContent,{value:"milestones",className:"space-y-4",children:a.length>0?a.map(a=>(0,b.jsx)(g.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold",children:a.title}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Weighted progress"})]}),(0,b.jsx)("div",{className:"text-right",children:(0,b.jsxs)("p",{className:"text-2xl font-bold text-primary",children:[U[String(a.id)]??0,"%"]})})]})})},a.id)):(0,b.jsx)(g.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"No projects"})})})}),(0,b.jsx)(h.TabsContent,{value:"complaints",className:"space-y-4",children:I.length>0?(0,b.jsx)("div",{className:"grid gap-4",children:I.map(a=>(0,b.jsx)(g.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsxs)(g.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:a.subject}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["From: ",a.contractorName]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Category: ",a.category.replace("-"," ")]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("span",{className:`text-xs font-semibold px-2 py-1 rounded block mb-2 ${"open"===a.status?"bg-red-100 text-red-800":"resolved"===a.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:a.status}),(0,b.jsx)("span",{className:`text-xs font-semibold px-2 py-1 rounded block ${"critical"===a.severity?"bg-destructive/20 text-destructive":"bg-orange-100 text-orange-800"}`,children:a.severity})]})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:a.description}),(0,b.jsx)(d.default,{href:`/manager/complaints/${a.id}`,children:(0,b.jsxs)(f.Button,{size:"sm",className:"bg-primary hover:bg-primary/90",children:[(0,b.jsx)(p.MessageSquare,{className:"w-4 h-4 mr-2"}),"Review & Respond"]})})]})},a.id))}):(0,b.jsx)(g.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsxs)(g.CardContent,{className:"pt-6 text-center",children:[(0,b.jsx)(p.MessageSquare,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground opacity-50"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"No complaints filed by contractors"})]})})})]})]}),(0,b.jsx)(y,{isOpen:E,onClose:()=>G(!1),onCreate:L})]})}function F(){let{user:a}=(0,w.useAuth)(),[e,g]=(0,c.useState)(null);return(0,c.useEffect)(()=>{(async()=>{if(!a?.id)return;let b=await fetch(`/api/wallet/${a.id}`,{headers:{}});b.ok&&g(Number((await b.json()).balance||0))})()},[a?.id]),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-primary",children:null==e?"Loading...":(0,C.formatNaira)(e)}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1 mb-3",children:"This is a virtual wallet. Deposits are now supported via API simulation."}),(0,b.jsx)(d.default,{href:"/manager/wallet/deposit",children:(0,b.jsxs)(f.Button,{size:"sm",className:"w-full sm:w-auto bg-primary hover:bg-primary/90",children:[(0,b.jsx)(i.Plus,{className:"w-3 h-3 mr-1"}),"Deposit Funds"]})})]})}function G(){return(0,b.jsx)(D.ProtectedRoute,{requiredRole:"manager",children:(0,b.jsx)(E,{})})}a.s(["default",()=>G],99916)}];

//# sourceMappingURL=app_manager_dashboard_page_tsx_b5f08428._.js.map