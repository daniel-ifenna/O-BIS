module.exports=[4096,a=>{"use strict";var b=a.i(87924),c=a.i(38246),d=a.i(50944),e=a.i(40695),f=a.i(3130),g=a.i(21958),h=a.i(13749),i=a.i(16201),j=a.i(41710),k=a.i(92e3),l=a.i(85850),m=a.i(29664),n=a.i(84767),o=a.i(72844),p=a.i(77687),q=a.i(72131);function r(){let{id:a}=(0,d.useParams)(),{getProject:m,isLoaded:r,closeBidding:s,deleteProject:t,setProjectStatus:u}=(0,l.useProjects)(),v=m(a),{getBidsByProject:w,shortlistBid:x,awardBid:y,updateBidStatus:z,getEventsByProject:A,logBidAction:B,updateBid:C}=(0,n.useBids)(),[D,E]=(0,q.useState)([]),[F,G]=(0,q.useState)(""),[H,I]=(0,q.useState)("UTC"),[J,K]=(0,q.useState)(""),[L,M]=(0,q.useState)(""),[N,O]=(0,q.useState)(""),[P,Q]=(0,q.useState)(""),[R,S]=(0,q.useState)(""),[T,U]=(0,q.useState)(""),[V,W]=(0,q.useState)({}),[X,Y]=(0,q.useState)("");(0,q.useEffect)(()=>{let b=async()=>{try{let b=await fetch(`/api/projects/${a}/bids`);if(b.ok){let c=await b.json(),d=w(a),e=c.map(a=>{let b=d.find(b=>b.id===a.id),c=a.uploads&&Object.values(a.uploads).some(a=>Array.isArray(a)&&a.length>0)?a.uploads:b?.uploads||a.uploads,e=Array.isArray(a.subcontractors)?a.subcontractors:b?.subcontractors||[],f=a.message??b?.message??null,g=a.phone??b?.phone??null,h=a.address??b?.address??null;return{...a,uploads:c,subcontractors:e,message:f,phone:g,address:h}});E(e)}}catch{}};(async()=>{await b()})(),window.__refreshProjectBids=b},[a]),(0,q.useEffect)(()=>{let a=v?.title||"";S(a?`Bid Review Meeting for ${a}`:"Bid Review Meeting")},[v]),(0,q.useEffect)(()=>{(async()=>{try{let b=(D&&D.length>0?D:w(a)).filter(a=>"Reviewed"===a.status),c=await Promise.all(b.map(async a=>{try{let b=await fetch(`/api/bids/${a.id}/invite-meeting`,{headers:{Authorization:`Bearer ${Z()}`}});if(b.ok){let c=await b.json();return{bidId:a.id,arr:c}}}catch{}return{bidId:a.id,arr:[]}})),d={};for(let a of c)d[a.bidId]=a.arr;W(d)}catch{}})()},[D,a]);let Z=()=>"",$=/^(https:\/\/)(meet\.google\.com|teams\.microsoft\.com|zoom\.us)\/.+/i,_=a=>{let b=String(a||"").trim();if(!b)return"";if(/^https?:\/\//i.test(b))return b;let c=b.toLowerCase().replace(/\s+/g,"").replace(/[^a-z0-9\-]/g,"");return c.length>=3?`https://meet.google.com/${c}`:b},aa=async a=>{Y("");try{if(!P)return void Y("Google Meet link is required");if(P&&!$.test(P))return void Y("Invalid Google Meet link format");let b={meetingTitle:R||`Bid Review Meeting for ${v?.title||"Project"}`,date:J,time:L,googleMeetLink:_(P),message:T||void 0,attendees:N.split(",").map(a=>a.trim()).filter(Boolean)},c=await fetch(`/api/bids/${a}/invite-meeting`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Z()}`},body:JSON.stringify(b)});if(c.ok){let b=await c.json();Y(`Invitation sent to ${Array.isArray(b.results)?b.results.length:1} recipient(s)`),B(a,"invited");try{let b=await fetch(`/api/bids/${a}/invite-meeting`,{headers:{Authorization:`Bearer ${Z()}`}});if(b.ok){let c=await b.json();W(b=>({...b,[a]:c}))}}catch{}}else{let a=await c.json().catch(()=>({}));Y(a?.error||"Failed to send invitation")}}catch{Y("Network error")}},ab=async()=>{Y("");try{let b=(D&&D.length>0?D:w(a)).filter(a=>"Reviewed"===a.status);if(0===b.length)return void Y("No shortlisted bids to invite");if(!P)return void Y("Google Meet link is required");if(!$.test(P))return void Y("Invalid Google Meet link format");let c=b[0].id,d={meetingTitle:R||`Bid Review Meeting for ${v?.title||"Project"}`,date:J,time:L,googleMeetLink:_(P),message:T||void 0,attendees:N.split(",").map(a=>a.trim()).filter(Boolean),includeAllShortlisted:!0},e=await fetch(`/api/bids/${c}/invite-meeting`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Z()}`},body:JSON.stringify(d)});if(e.ok){let a=await e.json(),c=Array.isArray(a.results)?a.results.filter(a=>a.ok).length:0,d=Array.isArray(a.results)?a.results.filter(a=>a.skippedDuplicate).length:0;for(let a of(Y(`Invited ${c} shortlisted bidder(s)${d?`; ${d} duplicate(s) skipped`:""}`),b))try{let b=await fetch(`/api/bids/${a.id}/invite-meeting`,{headers:{Authorization:`Bearer ${Z()}`}});if(b.ok){let c=await b.json();W(b=>({...b,[a.id]:c}))}}catch{}}else{let a=await e.json().catch(()=>({}));Y(a?.error||"Failed to send invitations")}}catch{Y("Network error")}},ac=async b=>{Y("");try{let c=await fetch(`/api/bids/${b}/award`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Z()}`},body:JSON.stringify({ownerName:F||"Manager"})});if(c.ok){let d=await c.json(),e=!!d?.contractSent,f=String(d?.contractSentAt||"");if(C(b,{status:"Awarded",contractSent:e,contractSentAt:f}),u(a,"Awarded"),s(a),Y("Contract awarded. Move to Overview to track progress."),(0,p.toast)({title:"Contract awarded",description:"Move to Overview to track progress"}),e)(0,p.toast)({title:"Bidding closed",description:"New submissions are blocked"});else{let a=String(d?.emailError||"Email delivery failed");Y(a),d.fallbackCredentials?((0,p.toast)({title:"Email Failed - ACTION REQUIRED",description:"Could not email credentials. Please copy them now.",variant:"destructive",duration:3e4}),alert(`IMPORTANT: The email with login credentials failed to send.

Please securely share these with the contractor:

Email: ${d.fallbackCredentials.email}
Password: ${d.fallbackCredentials.password}`)):(0,p.toast)({title:"Email failed",description:a,variant:"destructive"})}}else{let a=await c.json().catch(()=>({}));Y(a?.error||"Failed to send award email"),(0,p.toast)({title:"Failed to award",description:String(a?.error||"Error"),variant:"destructive"})}}catch{Y("Network error"),(0,p.toast)({title:"Network error",description:"Unable to send award",variant:"destructive"})}};if(!r)return(0,b.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"Loading project..."})})})});if(!v)return(0,b.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"Project not found"})})})});let ad=w(a),ae=D&&D.length>0?D.length:v?.bids||ad.length;return(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)("header",{className:"border-b border-border bg-card/50 backdrop-blur-sm sticky top-0 z-40",children:(0,b.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-4 flex items-center gap-4",children:[(0,b.jsx)(c.default,{href:"/manager/dashboard",children:(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(h.ChevronLeft,{className:"w-5 h-5"})})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:v.title}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:v.location})]}),(0,b.jsx)(c.default,{href:`/manager/project/${a}/overview`,children:(0,b.jsx)(e.Button,{variant:"outline",size:"sm",children:"View Overview"})}),(0,b.jsx)(e.Button,{variant:"destructive",size:"sm",onClick:()=>{console.log("Close Bidding clicked",v.id),s(v.id);try{(0,p.toast)({title:"Bidding closed",description:v.title})}catch{}},className:"ml-2",children:"Close Bidding"}),(0,b.jsx)(e.Button,{variant:"destructive",size:"sm",className:"ml-2",onClick:()=>{console.log("Delete Project clicked",v.id),t(v.id),(0,p.toast)({title:"Project deleted",description:v.title})},children:"Delete Project"})]})}),(0,b.jsxs)("main",{className:"max-w-6xl mx-auto px-4 py-8 space-y-6",children:[(0,b.jsxs)(f.Card,{className:"bg-card/60 border-border/50",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Invitation & Award Actions"}),(0,b.jsx)(f.CardDescription,{children:"Configure meeting and email details"})]}),(0,b.jsxs)(f.CardContent,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[(0,b.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"Owner name",value:F,onChange:a=>G(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"Time zone",value:H,onChange:a=>I(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2",type:"date",value:J,onChange:a=>K(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2",type:"time",value:L,onChange:a=>M(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"Attendees (comma-separated emails)",value:N,onChange:a=>O(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"Meeting link",value:P,onChange:a=>Q(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2 md:col-span-3",placeholder:"Meeting title",value:R,onChange:a=>S(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2 md:col-span-3",placeholder:"Message to bidders (optional)",value:T,onChange:a=>U(a.target.value)})]}),(0,b.jsx)("div",{className:"mt-3 flex gap-2",children:(0,b.jsx)(e.Button,{variant:"outline",size:"sm",title:"Invite all shortlisted bidders",disabled:0===w(a).filter(a=>"Reviewed"===a.status).length,onClick:ab,children:"Invite All Shortlisted"})}),X&&(0,b.jsx)("p",{className:"mt-3 text-sm",children:X})]})]}),(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Budget"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-primary",children:(0,o.formatNaira)(v.budget)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Status"}),(0,b.jsx)("p",{className:"font-semibold",children:v.status})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Bids Received"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:ae})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Created"}),(0,b.jsx)("p",{className:"font-semibold",children:v.createdAt})]})]})})}),(0,b.jsxs)(f.Card,{className:"bg-card/60 border-border/50",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Project Documents"}),(0,b.jsx)(f.CardDescription,{children:"Uploaded by the manager for this project"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"p-3 border rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Invitation to Bid (ITB)"}),(0,b.jsx)("p",{className:"font-semibold truncate",children:v.documents?.itb||v.itbName||"Not uploaded"}),(0,b.jsx)("div",{className:"mt-2",children:v.documents?.itbUrl?(0,b.jsx)("a",{href:v.documents?.itbUrl,download:v.documents?.itb||void 0,rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:"Download"}):(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"No file"})})]}),(0,b.jsxs)("div",{className:"p-3 border rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Project Specifications"}),(0,b.jsx)("p",{className:"font-semibold truncate",children:v.documents?.specs||v.specsName||"Not uploaded"}),(0,b.jsx)("div",{className:"mt-2",children:v.documents?.specsUrl?(0,b.jsx)("a",{href:v.documents?.specsUrl,download:v.documents?.specs||void 0,rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:"Download"}):(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"No file"})})]}),(0,b.jsxs)("div",{className:"p-3 border rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Bill of Quantities (BoQ)"}),(0,b.jsx)("p",{className:"font-semibold truncate",children:v.documents?.boq||v.boqName||"Not uploaded"}),(0,b.jsx)("div",{className:"mt-2",children:v.documents?.boqUrl?(0,b.jsx)("a",{href:v.documents?.boqUrl,download:v.documents?.boq||void 0,rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:"Download"}):(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"No file"})})]}),(0,b.jsxs)("div",{className:"p-3 border rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Financial Specifications"}),(0,b.jsx)("p",{className:"font-semibold truncate",children:v.documents?.financial||"Not uploaded"}),(0,b.jsx)("div",{className:"mt-2",children:v.documents?.financialUrl?(0,b.jsx)("a",{href:v.documents?.financialUrl,download:v.documents?.financial||void 0,rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:"Download"}):(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"No file"})})]})]})})]}),(0,b.jsxs)(g.Tabs,{defaultValue:"all",className:"space-y-4",children:[(0,b.jsxs)(g.TabsList,{children:[(0,b.jsx)(g.TabsTrigger,{value:"all",children:"All Bids"}),(0,b.jsx)(g.TabsTrigger,{value:"new",children:"New"}),(0,b.jsx)(g.TabsTrigger,{value:"shortlisted",children:"Shortlisted"}),(0,b.jsx)(g.TabsTrigger,{value:"accepted",children:"Accepted"}),(0,b.jsx)(g.TabsTrigger,{value:"rejected",children:"Rejected"})]}),(0,b.jsx)(g.TabsContent,{value:"all",className:"space-y-4",children:(D&&D.length>0?D:ad).map(d=>(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsxs)(f.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{className:"flex gap-4 flex-1",children:[(0,b.jsx)("div",{className:"flex items-center justify-center w-12 h-12 bg-primary/10 rounded-lg",children:(a=>{switch(a){case"New":return(0,b.jsx)(k.AlertCircle,{className:"w-4 h-4 text-accent"});case"Reviewed":return(0,b.jsx)(j.Clock,{className:"w-4 h-4 text-primary"});case"Accepted":return(0,b.jsx)(i.CheckCircle,{className:"w-4 h-4 text-green-600"});case"Awarded":return(0,b.jsx)(i.CheckCircle,{className:"w-4 h-4 text-green-700"});case"Rejected":return(0,b.jsx)(k.AlertCircle,{className:"w-4 h-4 text-destructive"});default:return null}})(d.status)}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold text-lg",children:d.companyName}),(0,b.jsxs)("div",{className:"flex gap-6 mt-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Amount"}),(0,b.jsx)("p",{className:"font-semibold",children:(0,o.formatNaira)(d.amount)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Duration"}),(0,b.jsx)("p",{className:"font-semibold",children:d.duration})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Submitted"}),(0,b.jsx)("p",{className:"font-semibold text-sm",children:new Date(d.submittedAt).toLocaleString()})]})]}),(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsx)("span",{className:"px-2 py-1 bg-muted text-muted-foreground rounded text-xs font-semibold",children:`Status: ${d.status} • ${(()=>{let a=d.reviewedAt||d.submittedAt||"";if(a)return new Date(a).toLocaleString();let b=d.recordDate||"",c=d.recordTime||"";return`${b} ${c}`.trim()})()}`})})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:["New"===d.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{variant:"outline",title:"Shortlist",onClick:()=>x(a,d.id),children:"Shortlist"}),(0,b.jsx)(e.Button,{variant:"destructive",title:"Reject",onClick:()=>z(d.id,"Rejected","manager-1").then(()=>(0,p.toast)({title:"Bid rejected",description:d.companyName})),children:"Reject"})]}),"Reviewed"===d.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{variant:"outline",title:"Invite Meeting",onClick:()=>aa(d.id),children:"Invite Meeting"}),(0,b.jsx)(e.Button,{variant:"secondary",title:"Accept",onClick:()=>z(d.id,"Accepted","manager-1").then(()=>(0,p.toast)({title:"Bid accepted",description:d.companyName})),children:"Accept"})]}),"Accepted"===d.status?(0,b.jsx)(e.Button,{title:"Award",onClick:()=>ac(d.id),children:"Award"}):"Awarded"===d.status?(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Button,{disabled:!0,title:"Awarded",children:"Awarded"}),(0,b.jsx)(c.default,{href:`/manager/project/${a}/overview`,className:"text-sm text-primary underline",children:"Move to Overview to track progress"})]}):null]})]}),d.uploads&&(0,b.jsx)("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3",children:["proposal","profile","specs","tax","bond","additional"].map(a=>(0,b.jsxs)("div",{className:"border rounded p-2",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground capitalize",children:a}),Array.isArray(d.uploads?.[a])&&d.uploads[a].length>0?(0,b.jsx)("div",{className:"space-y-1",children:d.uploads[a].slice(0,3).map((a,c)=>(0,b.jsxs)("a",{href:a,target:"_blank",rel:"noopener",className:"text-xs text-primary hover:underline truncate inline-block max-w-[180px]",children:["Document ",c+1]},c))}):(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"No files"})]},a))}),(0,b.jsxs)("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3",children:[(0,b.jsxs)("div",{className:"border rounded p-3 bg-card/40",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Contact"}),(0,b.jsxs)("div",{className:"text-sm space-y-1",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Name:"})," ",(0,b.jsx)("span",{className:"font-medium",children:d.bidderName})]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Email:"})," ",(0,b.jsx)("a",{href:`mailto:${d.email}`,className:"text-primary hover:underline",children:d.email})]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Phone:"})," ",(0,b.jsx)("span",{children:d.phone||"—"})]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Address:"})," ",(0,b.jsx)("span",{className:"break-all",children:d.address||"—"})]})]})]}),d.message&&(0,b.jsxs)("div",{className:"border rounded p-3 bg-card/40 col-span-2",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Contractor Message"}),(0,b.jsx)("p",{className:"text-sm whitespace-pre-line",children:d.message})]})]}),Array.isArray(d.subcontractors)&&d.subcontractors.length>0&&(0,b.jsxs)("div",{className:"mt-4 border rounded p-3 bg-card/40",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Subcontractors"}),(0,b.jsx)("div",{className:"mt-2 space-y-1",children:d.subcontractors.map((a,c)=>(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Name:"})," ",(0,b.jsx)("span",{className:"font-medium",children:a.name})]}),a.email&&(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Email:"})," ",(0,b.jsx)("a",{href:`mailto:${a.email}`,className:"text-primary hover:underline",children:a.email})]}),a.phone&&(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Phone:"})," ",(0,b.jsx)("span",{children:a.phone})]}),a.address&&(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Address:"})," ",(0,b.jsx)("span",{className:"break-all",children:a.address})]}),a.company&&(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Company:"})," ",(0,b.jsx)("span",{children:a.company})]}),a.scope&&(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Scope:"})," ",(0,b.jsx)("span",{children:a.scope})]})]},c))})]}),d.proposalText&&(0,b.jsxs)("div",{className:"mt-4 border rounded p-3 bg-card/40",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Proposal"}),(0,b.jsx)("p",{className:"text-sm whitespace-pre-line",children:d.proposalText})]}),Array.isArray(V[d.id])&&V[d.id].length>0&&(0,b.jsxs)("div",{className:"mt-4 border rounded p-3 bg-card/40",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Meeting Invites"}),(0,b.jsx)("div",{className:"mt-2 space-y-1",children:V[d.id].map((a,c)=>(0,b.jsxs)("div",{className:"text-sm flex justify-between",children:[(0,b.jsxs)("span",{children:[a.meetingTitle," • ",a.date," ",a.time]}),(0,b.jsx)("a",{href:a.googleMeetLink,target:"_blank",rel:"noopener",className:"text-primary hover:underline",children:"Join"})]},c))})]})]})},d.id))}),(0,b.jsx)(g.TabsContent,{value:"new",children:(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(D&&D.length>0?D:ad).filter(a=>"New"===a.status).length>0?(D&&D.length>0?D:ad).filter(a=>"New"===a.status).map(c=>(0,b.jsxs)("div",{className:"flex justify-between items-center pb-3 mb-3 border-b border-border",children:[(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsx)("span",{className:"font-semibold",children:c.companyName}),(0,b.jsx)("span",{children:(0,o.formatNaira)(c.amount)}),(0,b.jsxs)("span",{children:[c.duration," days"]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",title:"Shortlist this bid",disabled:"New"!==c.status,onClick:()=>x(a,c.id).then(async()=>{try{let a=window.__refreshProjectBids;"function"==typeof a&&await a()}catch{}}),children:"Shortlist"}),(0,b.jsx)(e.Button,{variant:"destructive",title:"Reject this bid",onClick:async()=>{let a=await z(c.id,"Rejected","manager-1");a.ok?(0,p.toast)({title:"Bid rejected",description:c.companyName}):(0,p.toast)({title:"Unable to reject",description:a.error||""});try{let a=window.__refreshProjectBids;"function"==typeof a&&await a()}catch{}},children:"Reject"})]})]},c.id)):(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"No new bids"})})})}),(0,b.jsx)(g.TabsContent,{value:"shortlisted",children:(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsxs)(f.CardContent,{className:"pt-6",children:[(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)(e.Button,{variant:"outline",size:"sm",title:"Invite all shortlisted bidders",disabled:0===(D&&D.length>0?D:ad).filter(a=>"Reviewed"===a.status).length,onClick:ab,children:"Invite All Shortlisted"})}),(D&&D.length>0?D:ad).filter(a=>"Reviewed"===a.status).length>0?(D&&D.length>0?D:ad).filter(a=>"Reviewed"===a.status).map(c=>(0,b.jsxs)("div",{className:"flex justify-between items-center pb-3 mb-3 border-b border-border",children:[(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsx)("span",{className:"font-semibold",children:c.companyName}),(0,b.jsx)("span",{children:(0,o.formatNaira)(c.amount)}),(0,b.jsxs)("span",{children:[c.duration," days"]}),(0,b.jsx)("span",{className:"px-2 py-1 bg-muted text-muted-foreground rounded text-xs font-semibold",children:`Status: ${c.status} • ${(()=>{let a=c.reviewedAt||c.submittedAt||"";if(a)return new Date(a).toLocaleString();let b=c.recordDate||"",d=c.recordTime||"";return`${b} ${d}`.trim()})()}`})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",title:"Invite shortlisted bidder to meeting",disabled:A(a).some(a=>a.bidId===c.id&&"invited"===a.action),onClick:()=>aa(c.id),children:"Invite Meeting"}),(0,b.jsx)(e.Button,{variant:"secondary",title:"Accept this bid",disabled:"Reviewed"!==c.status,onClick:async()=>{let a=await z(c.id,"Accepted","manager-1");a.ok?(0,p.toast)({title:"Bid accepted",description:c.companyName}):(0,p.toast)({title:"Unable to accept",description:a.error||""});try{let a=window.__refreshProjectBids;"function"==typeof a&&await a()}catch{}},children:"Accept"}),(0,b.jsx)(e.Button,{title:"Award contract to bidder",disabled:"Accepted"!==c.status&&"Reviewed"!==c.status,onClick:async()=>{await ac(c.id),B(c.id,"awarded");try{let a=window.__refreshProjectBids;"function"==typeof a&&await a()}catch{}},children:"Award Contract"}),(0,b.jsx)(e.Button,{variant:"destructive",title:"Reject this bid",onClick:async()=>{let a=await z(c.id,"Rejected","manager-1");a.ok?(0,p.toast)({title:"Bid rejected",description:c.companyName}):(0,p.toast)({title:"Unable to reject",description:a.error||""});try{let a=window.__refreshProjectBids;"function"==typeof a&&await a()}catch{}},children:"Reject"})]})]},c.id)):(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"Shortlisted bids appear here"})]})})}),(0,b.jsx)(g.TabsContent,{value:"accepted",children:(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(D&&D.length>0?D:ad).filter(a=>"Accepted"===a.status).length>0?(D&&D.length>0?D:ad).filter(a=>"Accepted"===a.status).map(a=>(0,b.jsxs)("div",{className:"flex justify-between items-center pb-3 mb-3 border-b border-border",children:[(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsx)("span",{className:"font-semibold",children:a.companyName}),(0,b.jsx)("span",{children:(0,o.formatNaira)(a.amount)}),(0,b.jsxs)("span",{children:[a.duration," days"]}),(0,b.jsx)("span",{className:"px-2 py-1 bg-muted text-muted-foreground rounded text-xs font-semibold",children:`Status: ${a.status} • ${(()=>{let b=a.reviewedAt||a.submittedAt||"";if(b)return new Date(b).toLocaleString();let c=a.recordDate||"",d=a.recordTime||"";return`${c} ${d}`.trim()})()}`})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)("span",{className:"text-green-700 font-semibold",children:"Accepted"})})]},a.id)):(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"No accepted bids yet"})})})}),(0,b.jsx)(g.TabsContent,{value:"rejected",children:(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:ad.filter(a=>"Rejected"===a.status).length>0?ad.filter(a=>"Rejected"===a.status).map(a=>(0,b.jsxs)("div",{className:"flex justify-between items-center pb-3 mb-3 border-b border-border opacity-60",children:[(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsx)("span",{className:"font-semibold",children:a.companyName}),(0,b.jsx)("span",{children:(0,o.formatNaira)(a.amount)}),(0,b.jsxs)("span",{children:[a.duration," days"]}),(0,b.jsx)("span",{className:"px-2 py-1 bg-muted text-muted-foreground rounded text-xs font-semibold",children:`Status: ${a.status} • ${(()=>{let b=a.reviewedAt||a.submittedAt||"";if(b)return new Date(b).toLocaleString();let c=a.recordDate||"",d=a.recordTime||"";return`${c} ${d}`.trim()})()}`})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)("span",{className:"text-destructive font-semibold",children:"Rejected"})})]},a.id)):(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"No rejected bids"})})})}),(0,b.jsxs)(f.Card,{className:"bg-card/60 border-border/50",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Bid Activity"}),(0,b.jsx)(f.CardDescription,{children:"Audit trail of bid actions"})]}),(0,b.jsx)(f.CardContent,{className:"pt-6",children:A(a).length>0?(0,b.jsx)("div",{className:"space-y-3",children:A(a).map(a=>(0,b.jsxs)("div",{className:"flex justify-between items-center pb-2 border-b border-border/50",children:[(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)("span",{className:"font-medium capitalize",children:a.action}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Bid ID: ",a.bidId]})]}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:new Date(a.timestamp).toLocaleString()})]},a.id))}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No activity yet"})})]})]})]})]})}function s(){return(0,b.jsx)(m.ProtectedRoute,{requiredRole:"manager",children:(0,b.jsx)(r,{})})}a.s(["default",()=>s])}];

//# sourceMappingURL=app_manager_project_%5Bid%5D_page_tsx_a642530d._.js.map