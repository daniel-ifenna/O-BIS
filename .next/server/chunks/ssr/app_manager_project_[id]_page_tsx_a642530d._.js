module.exports=[4096,a=>{"use strict";var b=a.i(87924),c=a.i(38246),d=a.i(50944),e=a.i(40695),f=a.i(3130),g=a.i(21958),h=a.i(13749),i=a.i(16201),j=a.i(41710),k=a.i(92e3),l=a.i(85850),m=a.i(29664),n=a.i(84767),o=a.i(72844),p=a.i(77687),q=a.i(72131);function r(){let{id:a}=(0,d.useParams)(),{getProject:m,isLoaded:r,closeBidding:s,deleteProject:t}=(0,l.useProjects)(),u=m(a),{getBidsByProject:v,shortlistBid:w,awardBid:x,updateBidStatus:y,getEventsByProject:z,logBidAction:A,updateBid:B}=(0,n.useBids)(),[C,D]=(0,q.useState)([]),[E,F]=(0,q.useState)(""),[G,H]=(0,q.useState)("UTC"),[I,J]=(0,q.useState)(""),[K,L]=(0,q.useState)(""),[M,N]=(0,q.useState)(""),[O,P]=(0,q.useState)(""),[Q,R]=(0,q.useState)(""),[S,T]=(0,q.useState)(""),[U,V]=(0,q.useState)({}),[W,X]=(0,q.useState)("");(0,q.useEffect)(()=>{let b=async()=>{try{let b=await fetch(`/api/projects/${a}/bids`);if(b.ok){let c=await b.json(),d=v(a),e=c.map(a=>{let b=d.find(b=>b.id===a.id),c=a.uploads&&Object.values(a.uploads).some(a=>Array.isArray(a)&&a.length>0)?a.uploads:b?.uploads||a.uploads,e=Array.isArray(a.subcontractors)?a.subcontractors:b?.subcontractors||[],f=a.message??b?.message??null,g=a.phone??b?.phone??null,h=a.address??b?.address??null;return{...a,uploads:c,subcontractors:e,message:f,phone:g,address:h}});D(e)}}catch{}};(async()=>{await b()})(),window.__refreshProjectBids=b},[a]),(0,q.useEffect)(()=>{let a=u?.title||"";R(a?`Bid Review Meeting for ${a}`:"Bid Review Meeting")},[u]),(0,q.useEffect)(()=>{(async()=>{try{let b=(C&&C.length>0?C:v(a)).filter(a=>"Reviewed"===a.status),c=await Promise.all(b.map(async a=>{try{let b=await fetch(`/api/bids/${a.id}/invite-meeting`,{headers:{Authorization:`Bearer ${Y()}`}});if(b.ok){let c=await b.json();return{bidId:a.id,arr:c}}}catch{}return{bidId:a.id,arr:[]}})),d={};for(let a of c)d[a.bidId]=a.arr;V(d)}catch{}})()},[C,a]);let Y=()=>"",Z=/^(https:\/\/)(meet\.google\.com|teams\.microsoft\.com|zoom\.us)\/.+/i,$=a=>{let b=String(a||"").trim();if(!b)return"";if(/^https?:\/\//i.test(b))return b;let c=b.toLowerCase().replace(/\s+/g,"").replace(/[^a-z0-9\-]/g,"");return c.length>=3?`https://meet.google.com/${c}`:b},_=async a=>{X("");try{if(!O)return void X("Google Meet link is required");if(O&&!Z.test(O))return void X("Invalid Google Meet link format");let b={meetingTitle:Q||`Bid Review Meeting for ${u?.title||"Project"}`,date:I,time:K,googleMeetLink:$(O),message:S||void 0,attendees:M.split(",").map(a=>a.trim()).filter(Boolean)},c=await fetch(`/api/bids/${a}/invite-meeting`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Y()}`},body:JSON.stringify(b)});if(c.ok){let b=await c.json();X(`Invitation sent to ${Array.isArray(b.results)?b.results.length:1} recipient(s)`),A(a,"invited");try{let b=await fetch(`/api/bids/${a}/invite-meeting`,{headers:{Authorization:`Bearer ${Y()}`}});if(b.ok){let c=await b.json();V(b=>({...b,[a]:c}))}}catch{}}else{let a=await c.json().catch(()=>({}));X(a?.error||"Failed to send invitation")}}catch{X("Network error")}},aa=async()=>{X("");try{let b=(C&&C.length>0?C:v(a)).filter(a=>"Reviewed"===a.status);if(0===b.length)return void X("No shortlisted bids to invite");if(!O)return void X("Google Meet link is required");if(!Z.test(O))return void X("Invalid Google Meet link format");let c=b[0].id,d={meetingTitle:Q||`Bid Review Meeting for ${u?.title||"Project"}`,date:I,time:K,googleMeetLink:$(O),message:S||void 0,attendees:M.split(",").map(a=>a.trim()).filter(Boolean),includeAllShortlisted:!0},e=await fetch(`/api/bids/${c}/invite-meeting`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Y()}`},body:JSON.stringify(d)});if(e.ok){let a=await e.json(),c=Array.isArray(a.results)?a.results.filter(a=>a.ok).length:0,d=Array.isArray(a.results)?a.results.filter(a=>a.skippedDuplicate).length:0;for(let a of(X(`Invited ${c} shortlisted bidder(s)${d?`; ${d} duplicate(s) skipped`:""}`),b))try{let b=await fetch(`/api/bids/${a.id}/invite-meeting`,{headers:{Authorization:`Bearer ${Y()}`}});if(b.ok){let c=await b.json();V(b=>({...b,[a.id]:c}))}}catch{}}else{let a=await e.json().catch(()=>({}));X(a?.error||"Failed to send invitations")}}catch{X("Network error")}},ab=async a=>{X("");try{let b=await fetch(`/api/bids/${a}/award`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Y()}`},body:JSON.stringify({ownerName:E||"Manager"})});if(b.ok){let c=await b.json(),d=!!c?.contractSent,e=String(c?.contractSentAt||"");B(a,{status:"Awarded",contractSent:d,contractSentAt:e}),(0,p.toast)({title:"Contract award sent",description:`Bid ${a} marked Awarded`})}else{let a=await b.json().catch(()=>({}));X(a?.error||"Failed to send award email"),(0,p.toast)({title:"Failed to award",description:String(a?.error||"Error"),variant:"destructive"})}}catch{X("Network error"),(0,p.toast)({title:"Network error",description:"Unable to send award",variant:"destructive"})}};if(!r)return(0,b.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"Loading project..."})})})});if(!u)return(0,b.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"Project not found"})})})});let ac=v(a),ad=C&&C.length>0?C.length:u?.bids||ac.length;return(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)("header",{className:"border-b border-border bg-card/50 backdrop-blur-sm sticky top-0 z-40",children:(0,b.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-4 flex items-center gap-4",children:[(0,b.jsx)(c.default,{href:"/manager/dashboard",children:(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(h.ChevronLeft,{className:"w-5 h-5"})})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:u.title}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:u.location})]}),(0,b.jsx)(c.default,{href:`/manager/project/${a}/overview`,children:(0,b.jsx)(e.Button,{variant:"outline",size:"sm",children:"View Overview"})}),(0,b.jsx)(e.Button,{variant:"destructive",size:"sm",onClick:()=>{console.log("Close Bidding clicked",u.id),s(u.id)},className:"ml-2",children:"Close Bidding"}),(0,b.jsx)(e.Button,{variant:"destructive",size:"sm",className:"ml-2",onClick:()=>{console.log("Delete Project clicked",u.id),t(u.id),(0,p.toast)({title:"Project deleted",description:u.title})},children:"Delete Project"})]})}),(0,b.jsxs)("main",{className:"max-w-6xl mx-auto px-4 py-8 space-y-6",children:[(0,b.jsxs)(f.Card,{className:"bg-card/60 border-border/50",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Invitation & Award Actions"}),(0,b.jsx)(f.CardDescription,{children:"Configure meeting and email details"})]}),(0,b.jsxs)(f.CardContent,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[(0,b.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"Owner name",value:E,onChange:a=>F(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"Time zone",value:G,onChange:a=>H(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2",type:"date",value:I,onChange:a=>J(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2",type:"time",value:K,onChange:a=>L(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"Attendees (comma-separated emails)",value:M,onChange:a=>N(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"Meeting link",value:O,onChange:a=>P(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2 md:col-span-3",placeholder:"Meeting title",value:Q,onChange:a=>R(a.target.value)}),(0,b.jsx)("input",{className:"border rounded px-3 py-2 md:col-span-3",placeholder:"Message to bidders (optional)",value:S,onChange:a=>T(a.target.value)})]}),(0,b.jsx)("div",{className:"mt-3 flex gap-2",children:(0,b.jsx)(e.Button,{variant:"outline",size:"sm",title:"Invite all shortlisted bidders",disabled:0===v(a).filter(a=>"Reviewed"===a.status).length,onClick:aa,children:"Invite All Shortlisted"})}),W&&(0,b.jsx)("p",{className:"mt-3 text-sm",children:W})]})]}),(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Budget"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-primary",children:(0,o.formatNaira)(u.budget)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Status"}),(0,b.jsx)("p",{className:"font-semibold",children:u.status})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Bids Received"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:ad})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Created"}),(0,b.jsx)("p",{className:"font-semibold",children:u.createdAt})]})]})})}),(0,b.jsxs)(f.Card,{className:"bg-card/60 border-border/50",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Project Documents"}),(0,b.jsx)(f.CardDescription,{children:"Uploaded by the manager for this project"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"p-3 border rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Invitation to Bid (ITB)"}),(0,b.jsx)("p",{className:"font-semibold truncate",children:u.documents?.itb||u.itbName||"Not uploaded"}),(0,b.jsx)("div",{className:"mt-2",children:u.documents?.itbUrl?(0,b.jsx)("a",{href:u.documents?.itbUrl,download:u.documents?.itb||void 0,rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:"Download"}):(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"No file"})})]}),(0,b.jsxs)("div",{className:"p-3 border rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Project Specifications"}),(0,b.jsx)("p",{className:"font-semibold truncate",children:u.documents?.specs||u.specsName||"Not uploaded"}),(0,b.jsx)("div",{className:"mt-2",children:u.documents?.specsUrl?(0,b.jsx)("a",{href:u.documents?.specsUrl,download:u.documents?.specs||void 0,rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:"Download"}):(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"No file"})})]}),(0,b.jsxs)("div",{className:"p-3 border rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Bill of Quantities (BoQ)"}),(0,b.jsx)("p",{className:"font-semibold truncate",children:u.documents?.boq||u.boqName||"Not uploaded"}),(0,b.jsx)("div",{className:"mt-2",children:u.documents?.boqUrl?(0,b.jsx)("a",{href:u.documents?.boqUrl,download:u.documents?.boq||void 0,rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:"Download"}):(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"No file"})})]}),(0,b.jsxs)("div",{className:"p-3 border rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Financial Specifications"}),(0,b.jsx)("p",{className:"font-semibold truncate",children:u.documents?.financial||"Not uploaded"}),(0,b.jsx)("div",{className:"mt-2",children:u.documents?.financialUrl?(0,b.jsx)("a",{href:u.documents?.financialUrl,download:u.documents?.financial||void 0,rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:"Download"}):(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"No file"})})]})]})})]}),(0,b.jsxs)(g.Tabs,{defaultValue:"all",className:"space-y-4",children:[(0,b.jsxs)(g.TabsList,{children:[(0,b.jsx)(g.TabsTrigger,{value:"all",children:"All Bids"}),(0,b.jsx)(g.TabsTrigger,{value:"new",children:"New"}),(0,b.jsx)(g.TabsTrigger,{value:"shortlisted",children:"Shortlisted"}),(0,b.jsx)(g.TabsTrigger,{value:"accepted",children:"Accepted"}),(0,b.jsx)(g.TabsTrigger,{value:"rejected",children:"Rejected"})]}),(0,b.jsx)(g.TabsContent,{value:"all",className:"space-y-4",children:(C&&C.length>0?C:ac).map(c=>(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsxs)(f.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{className:"flex gap-4 flex-1",children:[(0,b.jsx)("div",{className:"flex items-center justify-center w-12 h-12 bg-primary/10 rounded-lg",children:(a=>{switch(a){case"New":return(0,b.jsx)(k.AlertCircle,{className:"w-4 h-4 text-accent"});case"Reviewed":return(0,b.jsx)(j.Clock,{className:"w-4 h-4 text-primary"});case"Accepted":return(0,b.jsx)(i.CheckCircle,{className:"w-4 h-4 text-green-600"});case"Awarded":return(0,b.jsx)(i.CheckCircle,{className:"w-4 h-4 text-green-700"});case"Rejected":return(0,b.jsx)(k.AlertCircle,{className:"w-4 h-4 text-destructive"});default:return null}})(c.status)}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold text-lg",children:c.companyName}),(0,b.jsxs)("div",{className:"flex gap-6 mt-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Amount"}),(0,b.jsx)("p",{className:"font-semibold",children:(0,o.formatNaira)(c.amount)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Duration"}),(0,b.jsx)("p",{className:"font-semibold",children:c.duration})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Submitted"}),(0,b.jsx)("p",{className:"font-semibold text-sm",children:new Date(c.submittedAt).toLocaleString()})]})]}),(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsx)("span",{className:"px-2 py-1 bg-muted text-muted-foreground rounded text-xs font-semibold",children:`Status: ${c.status} • ${(()=>{let a=c.reviewedAt||c.submittedAt||"";if(a)return new Date(a).toLocaleString();let b=c.recordDate||"",d=c.recordTime||"";return`${b} ${d}`.trim()})()}`})})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:["New"===c.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{variant:"outline",title:"Shortlist",onClick:()=>w(a,c.id),children:"Shortlist"}),(0,b.jsx)(e.Button,{variant:"destructive",title:"Reject",onClick:()=>y(c.id,"Rejected","manager-1").then(()=>(0,p.toast)({title:"Bid rejected",description:c.companyName})),children:"Reject"})]}),"Reviewed"===c.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{variant:"outline",title:"Invite Meeting",onClick:()=>_(c.id),children:"Invite Meeting"}),(0,b.jsx)(e.Button,{variant:"secondary",title:"Accept",onClick:()=>y(c.id,"Accepted","manager-1").then(()=>(0,p.toast)({title:"Bid accepted",description:c.companyName})),children:"Accept"})]}),"Accepted"===c.status&&(0,b.jsx)(e.Button,{title:"Award",onClick:()=>ab(c.id),children:"Award"})]})]}),c.uploads&&(0,b.jsx)("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3",children:["proposal","profile","specs","tax","bond","additional"].map(a=>(0,b.jsxs)("div",{className:"border rounded p-2",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground capitalize",children:a}),Array.isArray(c.uploads?.[a])&&c.uploads[a].length>0?(0,b.jsx)("div",{className:"space-y-1",children:c.uploads[a].slice(0,3).map((a,c)=>(0,b.jsxs)("a",{href:a,target:"_blank",rel:"noopener",className:"text-xs text-primary hover:underline truncate inline-block max-w-[180px]",children:["Document ",c+1]},c))}):(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"No files"})]},a))}),(0,b.jsxs)("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3",children:[(0,b.jsxs)("div",{className:"border rounded p-3 bg-card/40",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Contact"}),(0,b.jsxs)("div",{className:"text-sm space-y-1",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Name:"})," ",(0,b.jsx)("span",{className:"font-medium",children:c.bidderName})]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Email:"})," ",(0,b.jsx)("a",{href:`mailto:${c.email}`,className:"text-primary hover:underline",children:c.email})]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Phone:"})," ",(0,b.jsx)("span",{children:c.phone||"—"})]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Address:"})," ",(0,b.jsx)("span",{className:"break-all",children:c.address||"—"})]})]})]}),c.message&&(0,b.jsxs)("div",{className:"border rounded p-3 bg-card/40 col-span-2",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Contractor Message"}),(0,b.jsx)("p",{className:"text-sm whitespace-pre-line",children:c.message})]})]}),Array.isArray(c.subcontractors)&&c.subcontractors.length>0&&(0,b.jsxs)("div",{className:"mt-4 border rounded p-3 bg-card/40",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Subcontractors"}),(0,b.jsx)("div",{className:"mt-2 space-y-1",children:c.subcontractors.map((a,c)=>(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Name:"})," ",(0,b.jsx)("span",{className:"font-medium",children:a.name})]}),a.email&&(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Email:"})," ",(0,b.jsx)("a",{href:`mailto:${a.email}`,className:"text-primary hover:underline",children:a.email})]}),a.phone&&(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Phone:"})," ",(0,b.jsx)("span",{children:a.phone})]}),a.address&&(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Address:"})," ",(0,b.jsx)("span",{className:"break-all",children:a.address})]}),a.company&&(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Company:"})," ",(0,b.jsx)("span",{children:a.company})]}),a.scope&&(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Scope:"})," ",(0,b.jsx)("span",{children:a.scope})]})]},c))})]}),c.proposalText&&(0,b.jsxs)("div",{className:"mt-4 border rounded p-3 bg-card/40",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Proposal"}),(0,b.jsx)("p",{className:"text-sm whitespace-pre-line",children:c.proposalText})]}),Array.isArray(U[c.id])&&U[c.id].length>0&&(0,b.jsxs)("div",{className:"mt-4 border rounded p-3 bg-card/40",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Meeting Invites"}),(0,b.jsx)("div",{className:"mt-2 space-y-1",children:U[c.id].map((a,c)=>(0,b.jsxs)("div",{className:"text-sm flex justify-between",children:[(0,b.jsxs)("span",{children:[a.meetingTitle," • ",a.date," ",a.time]}),(0,b.jsx)("a",{href:a.googleMeetLink,target:"_blank",rel:"noopener",className:"text-primary hover:underline",children:"Join"})]},c))})]})]})},c.id))}),(0,b.jsx)(g.TabsContent,{value:"new",children:(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(C&&C.length>0?C:ac).filter(a=>"New"===a.status).length>0?(C&&C.length>0?C:ac).filter(a=>"New"===a.status).map(c=>(0,b.jsxs)("div",{className:"flex justify-between items-center pb-3 mb-3 border-b border-border",children:[(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsx)("span",{className:"font-semibold",children:c.companyName}),(0,b.jsx)("span",{children:(0,o.formatNaira)(c.amount)}),(0,b.jsxs)("span",{children:[c.duration," days"]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",title:"Shortlist this bid",disabled:"New"!==c.status,onClick:()=>w(a,c.id).then(async()=>{try{let a=window.__refreshProjectBids;"function"==typeof a&&await a()}catch{}}),children:"Shortlist"}),(0,b.jsx)(e.Button,{variant:"destructive",title:"Reject this bid",onClick:async()=>{let a=await y(c.id,"Rejected","manager-1");a.ok?(0,p.toast)({title:"Bid rejected",description:c.companyName}):(0,p.toast)({title:"Unable to reject",description:a.error||""});try{let a=window.__refreshProjectBids;"function"==typeof a&&await a()}catch{}},children:"Reject"})]})]},c.id)):(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"No new bids"})})})}),(0,b.jsx)(g.TabsContent,{value:"shortlisted",children:(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsxs)(f.CardContent,{className:"pt-6",children:[(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)(e.Button,{variant:"outline",size:"sm",title:"Invite all shortlisted bidders",disabled:0===(C&&C.length>0?C:ac).filter(a=>"Reviewed"===a.status).length,onClick:aa,children:"Invite All Shortlisted"})}),(C&&C.length>0?C:ac).filter(a=>"Reviewed"===a.status).length>0?(C&&C.length>0?C:ac).filter(a=>"Reviewed"===a.status).map(c=>(0,b.jsxs)("div",{className:"flex justify-between items-center pb-3 mb-3 border-b border-border",children:[(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsx)("span",{className:"font-semibold",children:c.companyName}),(0,b.jsx)("span",{children:(0,o.formatNaira)(c.amount)}),(0,b.jsxs)("span",{children:[c.duration," days"]}),(0,b.jsx)("span",{className:"px-2 py-1 bg-muted text-muted-foreground rounded text-xs font-semibold",children:`Status: ${c.status} • ${(()=>{let a=c.reviewedAt||c.submittedAt||"";if(a)return new Date(a).toLocaleString();let b=c.recordDate||"",d=c.recordTime||"";return`${b} ${d}`.trim()})()}`})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",title:"Invite shortlisted bidder to meeting",disabled:z(a).some(a=>a.bidId===c.id&&"invited"===a.action),onClick:()=>_(c.id),children:"Invite Meeting"}),(0,b.jsx)(e.Button,{variant:"secondary",title:"Accept this bid",disabled:"Reviewed"!==c.status,onClick:async()=>{let a=await y(c.id,"Accepted","manager-1");a.ok?(0,p.toast)({title:"Bid accepted",description:c.companyName}):(0,p.toast)({title:"Unable to accept",description:a.error||""});try{let a=window.__refreshProjectBids;"function"==typeof a&&await a()}catch{}},children:"Accept"}),(0,b.jsx)(e.Button,{title:"Award contract to bidder",disabled:"Accepted"!==c.status&&"Reviewed"!==c.status,onClick:async()=>{await ab(c.id),A(c.id,"awarded");try{let a=window.__refreshProjectBids;"function"==typeof a&&await a()}catch{}},children:"Award Contract"}),(0,b.jsx)(e.Button,{variant:"destructive",title:"Reject this bid",onClick:async()=>{let a=await y(c.id,"Rejected","manager-1");a.ok?(0,p.toast)({title:"Bid rejected",description:c.companyName}):(0,p.toast)({title:"Unable to reject",description:a.error||""});try{let a=window.__refreshProjectBids;"function"==typeof a&&await a()}catch{}},children:"Reject"})]})]},c.id)):(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"Shortlisted bids appear here"})]})})}),(0,b.jsx)(g.TabsContent,{value:"accepted",children:(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(C&&C.length>0?C:ac).filter(a=>"Awarded"===a.status).length>0?(C&&C.length>0?C:ac).filter(a=>"Awarded"===a.status).map(a=>(0,b.jsxs)("div",{className:"flex justify-between items-center pb-3 mb-3 border-b border-border",children:[(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsx)("span",{className:"font-semibold",children:a.companyName}),(0,b.jsx)("span",{children:(0,o.formatNaira)(a.amount)}),(0,b.jsxs)("span",{children:[a.duration," days"]}),(0,b.jsx)("span",{className:"px-2 py-1 bg-muted text-muted-foreground rounded text-xs font-semibold",children:`Status: ${a.status} • ${(()=>{let b=a.reviewedAt||a.submittedAt||"";if(b)return new Date(b).toLocaleString();let c=a.recordDate||"",d=a.recordTime||"";return`${c} ${d}`.trim()})()}`})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)("span",{className:"text-green-700 font-semibold",children:"Awarded"})})]},a.id)):(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"No accepted bids yet"})})})}),(0,b.jsx)(g.TabsContent,{value:"rejected",children:(0,b.jsx)(f.Card,{className:"bg-card/60 border-border/50",children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:ac.filter(a=>"Rejected"===a.status).length>0?ac.filter(a=>"Rejected"===a.status).map(a=>(0,b.jsxs)("div",{className:"flex justify-between items-center pb-3 mb-3 border-b border-border opacity-60",children:[(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsx)("span",{className:"font-semibold",children:a.companyName}),(0,b.jsx)("span",{children:(0,o.formatNaira)(a.amount)}),(0,b.jsxs)("span",{children:[a.duration," days"]}),(0,b.jsx)("span",{className:"px-2 py-1 bg-muted text-muted-foreground rounded text-xs font-semibold",children:`Status: ${a.status} • ${(()=>{let b=a.reviewedAt||a.submittedAt||"";if(b)return new Date(b).toLocaleString();let c=a.recordDate||"",d=a.recordTime||"";return`${c} ${d}`.trim()})()}`})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)("span",{className:"text-destructive font-semibold",children:"Rejected"})})]},a.id)):(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"No rejected bids"})})})}),(0,b.jsxs)(f.Card,{className:"bg-card/60 border-border/50",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Bid Activity"}),(0,b.jsx)(f.CardDescription,{children:"Audit trail of bid actions"})]}),(0,b.jsx)(f.CardContent,{className:"pt-6",children:z(a).length>0?(0,b.jsx)("div",{className:"space-y-3",children:z(a).map(a=>(0,b.jsxs)("div",{className:"flex justify-between items-center pb-2 border-b border-border/50",children:[(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)("span",{className:"font-medium capitalize",children:a.action}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Bid ID: ",a.bidId]})]}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:new Date(a.timestamp).toLocaleString()})]},a.id))}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No activity yet"})})]})]})]})]})}function s(){return(0,b.jsx)(m.ProtectedRoute,{requiredRole:"manager",children:(0,b.jsx)(r,{})})}a.s(["default",()=>s])}];

//# sourceMappingURL=app_manager_project_%5Bid%5D_page_tsx_a642530d._.js.map