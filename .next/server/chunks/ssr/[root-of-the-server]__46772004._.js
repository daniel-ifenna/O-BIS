module.exports=[43285,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/dynamic-access-async-storage.external.js",()=>require("next/dist/server/app-render/dynamic-access-async-storage.external.js"))},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},77192,a=>{"use strict";var b=a.i(72131),c=a.i(70121),d=a.i(72752),e=a=>{var e;let g,h,{present:i,children:j}=a,k=function(a){var c,e;let[g,h]=b.useState(),i=b.useRef(null),j=b.useRef(a),k=b.useRef("none"),[l,m]=(c=a?"mounted":"unmounted",e={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},b.useReducer((a,b)=>e[a][b]??a,c));return b.useEffect(()=>{let a=f(i.current);k.current="mounted"===l?a:"none"},[l]),(0,d.useLayoutEffect)(()=>{let b=i.current,c=j.current;if(c!==a){let d=k.current,e=f(b);a?m("MOUNT"):"none"===e||b?.display==="none"?m("UNMOUNT"):c&&d!==e?m("ANIMATION_OUT"):m("UNMOUNT"),j.current=a}},[a,m]),(0,d.useLayoutEffect)(()=>{if(g){let a,b=g.ownerDocument.defaultView??window,c=c=>{let d=f(i.current).includes(CSS.escape(c.animationName));if(c.target===g&&d&&(m("ANIMATION_END"),!j.current)){let c=g.style.animationFillMode;g.style.animationFillMode="forwards",a=b.setTimeout(()=>{"forwards"===g.style.animationFillMode&&(g.style.animationFillMode=c)})}},d=a=>{a.target===g&&(k.current=f(i.current))};return g.addEventListener("animationstart",d),g.addEventListener("animationcancel",c),g.addEventListener("animationend",c),()=>{b.clearTimeout(a),g.removeEventListener("animationstart",d),g.removeEventListener("animationcancel",c),g.removeEventListener("animationend",c)}}m("ANIMATION_END")},[g,m]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:b.useCallback(a=>{i.current=a?getComputedStyle(a):null,h(a)},[])}}(i),l="function"==typeof j?j({present:k.isPresent}):b.Children.only(j),m=(0,c.useComposedRefs)(k.ref,(e=l,(h=(g=Object.getOwnPropertyDescriptor(e.props,"ref")?.get)&&"isReactWarning"in g&&g.isReactWarning)?e.ref:(h=(g=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in g&&g.isReactWarning)?e.props.ref:e.props.ref||e.ref));return"function"==typeof j||k.isPresent?b.cloneElement(l,{ref:m}):null};function f(a){return a?.animationName||"none"}e.displayName="Presence",a.s(["Presence",()=>e])},46058,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},39118,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DEFAULT_SEGMENT_KEY:function(){return l},PAGE_SEGMENT_KEY:function(){return k},addSearchParamsIfPageSegment:function(){return i},computeSelectedLayoutSegment:function(){return j},getSegmentValue:function(){return f},getSelectedLayoutSegmentPath:function(){return function a(b,c,d=!0,e=[]){let g;if(d)g=b[1][c];else{let a=b[1];g=a.children??Object.values(a)[0]}if(!g)return e;let h=f(g[0]);return!h||h.startsWith(k)?e:(e.push(h),a(g,c,!1,e))}},isGroupSegment:function(){return g},isParallelRouteSegment:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return Array.isArray(a)?a[1]:a}function g(a){return"("===a[0]&&a.endsWith(")")}function h(a){return a.startsWith("@")&&"@children"!==a}function i(a,b){if(a.includes(k)){let a=JSON.stringify(b);return"{}"!==a?k+"?"+a:k}return a}function j(a,b){if(!a||0===a.length)return null;let c="children"===b?a[0]:a[a.length-1];return c===l?null:c}let k="__PAGE__",l="__DEFAULT__"},54427,(a,b,c)=>{"use strict";function d(){let a,b,c=new Promise((c,d)=>{a=c,b=d});return{resolve:a,reject:b,promise:c}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createPromiseWithResolvers",{enumerable:!0,get:function(){return d}})},187,a=>{"use strict";var b=a.i(98621);let c=a=>"boolean"==typeof a?`${a}`:0===a?"0":a,d=b.clsx;a.s(["cva",0,(a,b)=>e=>{var f;if((null==b?void 0:b.variants)==null)return d(a,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:g,defaultVariants:h}=b,i=Object.keys(g).map(a=>{let b=null==e?void 0:e[a],d=null==h?void 0:h[a];if(null===b)return null;let f=c(b)||c(d);return g[a][f]}),j=e&&Object.entries(e).reduce((a,b)=>{let[c,d]=b;return void 0===d||(a[c]=d),a},{});return d(a,i,null==b||null==(f=b.compoundVariants)?void 0:f.reduce((a,b)=>{let{class:c,className:d,...e}=b;return Object.entries(e).every(a=>{let[b,c]=a;return Array.isArray(c)?c.includes({...h,...j}[b]):({...h,...j})[b]===c})?[...a,c,d]:a},[]),null==e?void 0:e.class,null==e?void 0:e.className)}])},70106,a=>{"use strict";var b=a.i(72131);let c=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let e=(0,b.forwardRef)(({color:a="currentColor",size:e=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...d,width:e,height:e,stroke:a,strokeWidth:g?24*Number(f)/Number(e):f,className:c("lucide",h),...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),f=(a,d)=>{let f=(0,b.forwardRef)(({className:f,...g},h)=>(0,b.createElement)(e,{ref:h,iconNode:d,className:c(`lucide-${a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,f),...g}));return f.displayName=`${a}`,f};a.s(["default",()=>f],70106)},21937,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);let e=(0,c.createContext)(void 0);function f({children:a}){let[f,g]=(0,c.useState)(null),[h,i]=(0,c.useState)(!0),j=(0,d.useRouter)();(0,c.useEffect)(()=>{let a=localStorage.getItem("auth_user");if(a)try{let b=JSON.parse(a);fetch(`/api/auth/exists?email=${encodeURIComponent(b.email)}`).then(async a=>{if(!a.ok)throw Error("verify failed");let c=await a.json();if(c?.exists&&c.user?.email===b.email){g(c.user);try{document.cookie=`auth_role=${c.user.role}; Path=/; SameSite=Lax`}catch{}console.log("[v0] User verified via Prisma:",b.email)}else localStorage.removeItem("auth_user")}).catch(()=>{localStorage.removeItem("auth_user")})}catch(a){console.error("[v0] Failed to parse saved user:",a),localStorage.removeItem("auth_user")}i(!1)},[]);let k=async a=>{i(!0);try{let b;console.log("[v0] Signing up user:",a.email);let c=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!c.ok){let a="Sign up failed";try{a=(await c.json()).error||a}catch(b){a=`Sign up failed: ${c.statusText}`}throw Error(a)}try{b=await c.json()}catch(a){throw Error("Invalid server response")}if(g(b),localStorage.setItem("auth_user",JSON.stringify(b)),b?.token)try{localStorage.setItem("auth_token",String(b.token))}catch{}try{document.cookie=`auth_role=${b.role}; Path=/; SameSite=Lax`}catch{}let d="vendor"===b.role?"/vendor/portal":"contractor"===b.role?"/contractor/dashboard":"/manager/dashboard";console.log("[v0] Sign up successful, redirecting to:",d),j.push(d)}catch(a){throw console.error("[v0] Sign up error:",a),a}finally{i(!1)}},l=async(a,b)=>{i(!0);try{let c;console.log("[v0] Signing in user:",a);let d=await fetch("/api/auth/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,password:b})});if(!d.ok){let a="Sign in failed";try{a=(await d.json()).error||a}catch(b){a=`Sign in failed: ${d.statusText}`}throw Error(a)}try{c=await d.json()}catch(a){throw Error("Invalid server response")}if(g(c),localStorage.setItem("auth_user",JSON.stringify(c)),c?.token)try{localStorage.setItem("auth_token",String(c.token))}catch{}try{document.cookie=`auth_role=${c.role}; Path=/; SameSite=Lax`}catch{}let e="vendor"===c.role?"/vendor/portal":"contractor"===c.role?"/contractor/dashboard":"/manager/dashboard";console.log("[v0] Sign in successful, redirecting to:",e),j.push(e)}catch(a){throw console.error("[v0] Sign in error:",a),a}finally{i(!1)}},m=async(a,b,c)=>{i(!0);try{let d,e="/api/auth/signin";"contractor"===c&&(e="/api/auth/contractor/signin"),"manager"===c&&(e="/api/auth/manager/signin"),"vendor"===c&&(e="/api/auth/vendor/signin");let f=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,password:b})});if(!f.ok){let a="Sign in failed";try{a=(await f.json()).error||a}catch{}throw Error(a)}try{d=await f.json()}catch{throw Error("Invalid server response")}let h=d?.user||d;if(h?.role!==c)throw Error("Account role mismatch for this portal");if(g(h),localStorage.setItem("auth_user",JSON.stringify(h)),d?.token)try{localStorage.setItem("auth_token",String(d.token))}catch{}try{document.cookie=`auth_role=${h.role}; Path=/; SameSite=Lax`}catch{}let i="vendor"===h.role?"/vendor/portal":"contractor"===h.role?"/contractor/dashboard":"/manager/dashboard";j.push(i)}catch(a){throw a}finally{i(!1)}};return(0,b.jsx)(e.Provider,{value:{user:f,isLoading:h,signUp:k,signIn:l,signInWithRole:m,signOut:()=>{console.log("[v0] Signing out user"),g(null),localStorage.removeItem("auth_user");try{document.cookie="auth_role=; Path=/; Max-Age=0; SameSite=Lax"}catch{}j.push("/")}},children:a})}function g(){let a=(0,c.useContext)(e);if(!a)throw Error("useAuth must be used within AuthProvider");return a}a.s(["AuthProvider",()=>f,"useAuth",()=>g])},75652,a=>{"use strict";var b=a.i(87924),c=a.i(72131);let d=(0,c.createContext)(void 0);function e({children:a}){let[e,f]=(0,c.useState)([]),g=async a=>{try{let b=await fetch("/api/complaints",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(b.ok){let a=await b.json();f(b=>[a,...b]);return}}catch{}let b={...a,id:`complaint-${Date.now()}`,filedAt:new Date().toISOString(),activities:[],status:"open"};f(a=>[b,...a])};return(0,b.jsx)(d.Provider,{value:{complaints:e,addComplaint:g,getComplaint:a=>e.find(b=>b.id===a),getComplaintsByProject:a=>e.filter(b=>b.projectId===a),getComplaintsByContractor:a=>e.filter(b=>b.contractorId===a),getComplaintsByManager:a=>e.filter(b=>b.managerId===a),updateComplaintStatus:(a,b)=>{f(c=>c.map(c=>{if(c.id===a){let d={id:`activity-${Date.now()}`,complaintId:a,action:"updated",notes:`Status changed to ${b}`,timestamp:new Date().toISOString()};return{...c,status:b,acknowledgedAt:"acknowledged"===b?new Date().toISOString():c.acknowledgedAt,activities:[...c.activities,d]}}return c}))},resolveComplaint:(a,b)=>{f(c=>c.map(c=>{if(c.id===a){let d={id:`activity-${Date.now()}`,complaintId:a,action:"resolved",notes:b,timestamp:new Date().toISOString()};return{...c,status:"resolved",resolution:b,resolvedAt:new Date().toISOString(),activities:[...c.activities,d]}}return c}))},addActivity:(a,b)=>{f(c=>c.map(c=>c.id===a?{...c,activities:[...c.activities,{...b,id:`activity-${Date.now()}`}]}:c))}},children:a})}function f(){let a=(0,c.useContext)(d);if(!a)throw Error("useComplaints must be used within ComplaintProvider");return a}a.s(["ComplaintProvider",()=>e,"useComplaints",()=>f])},63491,a=>{"use strict";var b=a.i(87924),c=a.i(72131);let d=(0,c.createContext)(void 0);function e({children:a}){let[e,f]=(0,c.useState)([]);(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/procurements/public");if(a.ok){let b=await a.json();Array.isArray(b)&&f(b)}}catch{}})()},[]);let g=async()=>{try{let a=await fetch("/api/procurements/public");if(a.ok){let b=await a.json();Array.isArray(b)&&f(b)}}catch{}},h=a=>e.find(b=>b.id===a),i=async(a,b)=>{try{let c=await fetch(`/api/procurements/${a}/quotes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(c.ok){let b=await c.json();f(c=>c.map(c=>c.id===a?{...c,quotes:[...c.quotes,b],status:"quoted"}:c)),await g();return}}catch{}f(c=>c.map(c=>c.id===a?{...c,quotes:[...c.quotes,b],status:"quoted"}:c)),await g()},j=async(a,b,c)=>{try{await fetch("/api/email/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:a,subject:b,html:c})})}catch{}},k=async(a,b)=>{let c=h(a);if(!c)return;let d=c.quotes.find(a=>a.id===b);d&&(f(c=>c.map(c=>c.id===a?{...c,selectedQuoteId:b,quotes:c.quotes.map(a=>({...a,status:a.id===b?"selected":a.status}))}:c)),await g(),await j(d.vendorEmail,"Interview Invitation",`<div>
        <p>Dear ${d.vendorName},</p>
        <p>Your quote has been shortlisted for interview.</p>
        <p>Item: ${c.item}</p>
        <p>Total Price: ${d.totalPrice}</p>
      </div>`))},l=async(a,b)=>{let c=h(a);if(!c)return;let d=c.quotes.find(a=>a.id===b);d&&(f(c=>c.map(c=>c.id===a?{...c,status:"awarded",selectedQuoteId:b,quotes:c.quotes.map(a=>({...a,status:a.id===b?"selected":a.status}))}:c)),await g(),await j(d.vendorEmail,"Award of Contract",`<div>
        <p>Dear ${d.vendorName},</p>
        <p>Your quote has been accepted.</p>
        <p>Item: ${c.item}</p>
        <p>Total Price: ${d.totalPrice}</p>
        <p>Please proceed with delivery according to agreed terms.</p>
      </div>`))};return(0,b.jsx)(d.Provider,{value:{procurements:e,addProcurement:a=>{f(b=>[a,...b])},getProcurement:h,addQuote:i,getQuotes:a=>{let b=h(a);return b?.quotes||[]},selectQuote:k,awardQuote:l},children:a})}function f(){let a=(0,c.useContext)(d);if(!a)throw Error("useProcurements must be used within ProcurementProvider");return a}a.s(["ProcurementProvider",()=>e,"useProcurements",()=>f])},96743,92616,a=>{"use strict";var b,c=a.i(72131),d=a.i(7554),e=a.i(30553),f=a.i(70121),g=a.i(46872),h=a.i(87924),i="dismissableLayer.update",j=c.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),k=c.forwardRef((a,k)=>{let{disableOutsidePointerEvents:l=!1,onEscapeKeyDown:o,onPointerDownOutside:p,onFocusOutside:q,onInteractOutside:r,onDismiss:s,...t}=a,u=c.useContext(j),[v,w]=c.useState(null),x=v?.ownerDocument??globalThis?.document,[,y]=c.useState({}),z=(0,f.useComposedRefs)(k,a=>w(a)),A=Array.from(u.layers),[B]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),C=A.indexOf(B),D=v?A.indexOf(v):-1,E=u.layersWithOutsidePointerEventsDisabled.size>0,F=D>=C,G=function(a,b=globalThis?.document){let d=(0,g.useCallbackRef)(a),e=c.useRef(!1),f=c.useRef(()=>{});return c.useEffect(()=>{let a=a=>{if(a.target&&!e.current){let c=function(){n("dismissableLayer.pointerDownOutside",d,e,{discrete:!0})},e={originalEvent:a};"touch"===a.pointerType?(b.removeEventListener("click",f.current),f.current=c,b.addEventListener("click",f.current,{once:!0})):c()}else b.removeEventListener("click",f.current);e.current=!1},c=window.setTimeout(()=>{b.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(c),b.removeEventListener("pointerdown",a),b.removeEventListener("click",f.current)}},[b,d]),{onPointerDownCapture:()=>e.current=!0}}(a=>{let b=a.target,c=[...u.branches].some(a=>a.contains(b));F&&!c&&(p?.(a),r?.(a),a.defaultPrevented||s?.())},x),H=function(a,b=globalThis?.document){let d=(0,g.useCallbackRef)(a),e=c.useRef(!1);return c.useEffect(()=>{let a=a=>{a.target&&!e.current&&n("dismissableLayer.focusOutside",d,{originalEvent:a},{discrete:!1})};return b.addEventListener("focusin",a),()=>b.removeEventListener("focusin",a)},[b,d]),{onFocusCapture:()=>e.current=!0,onBlurCapture:()=>e.current=!1}}(a=>{let b=a.target;![...u.branches].some(a=>a.contains(b))&&(q?.(a),r?.(a),a.defaultPrevented||s?.())},x);return!function(a,b=globalThis?.document){let d=(0,g.useCallbackRef)(a);c.useEffect(()=>{let a=a=>{"Escape"===a.key&&d(a)};return b.addEventListener("keydown",a,{capture:!0}),()=>b.removeEventListener("keydown",a,{capture:!0})},[d,b])}(a=>{D===u.layers.size-1&&(o?.(a),!a.defaultPrevented&&s&&(a.preventDefault(),s()))},x),c.useEffect(()=>{if(v)return l&&(0===u.layersWithOutsidePointerEventsDisabled.size&&(b=x.body.style.pointerEvents,x.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(v)),u.layers.add(v),m(),()=>{l&&1===u.layersWithOutsidePointerEventsDisabled.size&&(x.body.style.pointerEvents=b)}},[v,x,l,u]),c.useEffect(()=>()=>{v&&(u.layers.delete(v),u.layersWithOutsidePointerEventsDisabled.delete(v),m())},[v,u]),c.useEffect(()=>{let a=()=>y({});return document.addEventListener(i,a),()=>document.removeEventListener(i,a)},[]),(0,h.jsx)(e.Primitive.div,{...t,ref:z,style:{pointerEvents:E?F?"auto":"none":void 0,...a.style},onFocusCapture:(0,d.composeEventHandlers)(a.onFocusCapture,H.onFocusCapture),onBlurCapture:(0,d.composeEventHandlers)(a.onBlurCapture,H.onBlurCapture),onPointerDownCapture:(0,d.composeEventHandlers)(a.onPointerDownCapture,G.onPointerDownCapture)})});k.displayName="DismissableLayer";var l=c.forwardRef((a,b)=>{let d=c.useContext(j),g=c.useRef(null),i=(0,f.useComposedRefs)(b,g);return c.useEffect(()=>{let a=g.current;if(a)return d.branches.add(a),()=>{d.branches.delete(a)}},[d.branches]),(0,h.jsx)(e.Primitive.div,{...a,ref:i})});function m(){let a=new CustomEvent(i);document.dispatchEvent(a)}function n(a,b,c,{discrete:d}){let f=c.originalEvent.target,g=new CustomEvent(a,{bubbles:!1,cancelable:!0,detail:c});b&&f.addEventListener(a,b,{once:!0}),d?(0,e.dispatchDiscreteCustomEvent)(f,g):f.dispatchEvent(g)}l.displayName="DismissableLayerBranch",a.s(["Branch",()=>l,"DismissableLayer",()=>k,"Root",()=>k],96743);var o=a.i(35112),p=a.i(72752),q=c.forwardRef((a,b)=>{let{container:d,...f}=a,[g,i]=c.useState(!1);(0,p.useLayoutEffect)(()=>i(!0),[]);let j=d||g&&globalThis?.document?.body;return j?o.default.createPortal((0,h.jsx)(e.Primitive.div,{...f,ref:b}),j):null});q.displayName="Portal",a.s(["Portal",()=>q],92616)},28094,a=>{"use strict";var b=a.i(72131),c=a.i(30553),d=a.i(87924),e=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),f=b.forwardRef((a,b)=>(0,d.jsx)(c.Primitive.span,{...a,ref:b,style:{...e,...a.style}}));f.displayName="VisuallyHidden",a.s(["VISUALLY_HIDDEN_STYLES",()=>e,"VisuallyHidden",()=>f])},33508,21915,a=>{"use strict";let b=(0,a.i(70106).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);a.s(["default",()=>b],21915),a.s(["X",()=>b],33508)},85850,a=>{"use strict";var b=a.i(87924),c=a.i(72131);let d=(0,c.createContext)(void 0);function e({children:a}){let[e,f]=(0,c.useState)(null),[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(!1);(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/projects");if(a.ok){let b=await a.json();if(Array.isArray(b)){let a=b.map(a=>{let b=a.createdAt?new Date(a.createdAt):null,c=b?b.getFullYear():"",d=b?String(b.getMonth()+1).padStart(2,"0"):"",e=b?String(b.getDate()).padStart(2,"0"):"",f=b?String(b.getHours()).padStart(2,"0"):"",g=b?String(b.getMinutes()).padStart(2,"0"):"";return{...a,bids:"number"==typeof a.bidsCount?a.bidsCount:Number(a.bidsCount||a.bids||0),budget:null!=a.budget?String(a.budget):"",createdAt:b?`${c}-${d}-${e} ${f}:${g}`:"",acceptedBidDays:"number"==typeof a.acceptedBidDays?a.acceptedBidDays:null!=a.acceptedBidDays?Number(a.acceptedBidDays):void 0}});h(a)}}}catch{}finally{j(!0)}})()},[]),(0,c.useEffect)(()=>{},[g]);let k=async a=>{try{let b=await fetch("/api/projects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(b.ok){let a=await b.json();h(b=>[a,...b]);try{let a=await fetch("/api/projects");if(a.ok){let b=await a.json();if(Array.isArray(b)){let a=b.map(a=>{let b=a.createdAt?new Date(a.createdAt):null,c=b?b.getFullYear():"",d=b?String(b.getMonth()+1).padStart(2,"0"):"",e=b?String(b.getDate()).padStart(2,"0"):"",f=b?String(b.getHours()).padStart(2,"0"):"",g=b?String(b.getMinutes()).padStart(2,"0"):"";return{...a,bids:"number"==typeof a.bidsCount?a.bidsCount:Number(a.bidsCount||a.bids||0),budget:null!=a.budget?String(a.budget):"",createdAt:b?`${c}-${d}-${e} ${f}:${g}`:"",acceptedBidDays:"number"==typeof a.acceptedBidDays?a.acceptedBidDays:null!=a.acceptedBidDays?Number(a.acceptedBidDays):void 0}});h(a)}}}catch{}return{ok:!0}}{let a="Failed to create project";try{let c=await b.json();c?.error&&(a=String(c.error))}catch{}return{ok:!1,error:a}}}catch{}try{let a=await (async()=>(await fetch("/api/projects")).ok?"Server reachable":"Server unreachable")();return{ok:!1,error:a}}catch{return{ok:!1,error:"Network error"}}},l=async a=>{let b=null;try{let c=await fetch(`/api/projects/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"Closed"})});c.ok&&(b=await c.json())}catch{}h(c=>c.map(c=>{if(String(c.id)!==String(a))return c;if(b){let a=b.createdAt?new Date(b.createdAt):null,d=c.createdAt;if(a){let b=a.getFullYear(),c=String(a.getMonth()+1).padStart(2,"0"),e=String(a.getDate()).padStart(2,"0"),f=String(a.getHours()).padStart(2,"0"),g=String(a.getMinutes()).padStart(2,"0");d=`${b}-${c}-${e} ${f}:${g}`}return{...c,status:String(b.status||"Closed"),budget:null!=b.budget?String(b.budget):c.budget,createdAt:d}}return{...c,status:"Awarded"===c.status?"Awarded":"Closed"}}))},m=async(a,b)=>{try{if((await fetch(`/api/projects/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:b})})).ok)try{let a=await fetch("/api/projects");if(a.ok){let b=await a.json();if(Array.isArray(b)){let a=b.map(a=>{let b=a.createdAt?new Date(a.createdAt):null,c=b?b.getFullYear():"",d=b?String(b.getMonth()+1).padStart(2,"0"):"",e=b?String(b.getDate()).padStart(2,"0"):"",f=b?String(b.getHours()).padStart(2,"0"):"",g=b?String(b.getMinutes()).padStart(2,"0"):"";return{...a,bids:"number"==typeof a.bidsCount?a.bidsCount:Number(a.bidsCount||a.bids||0),budget:null!=a.budget?String(a.budget):"",createdAt:b?`${c}-${d}-${e} ${f}:${g}`:"",acceptedBidDays:"number"==typeof a.acceptedBidDays?a.acceptedBidDays:null!=a.acceptedBidDays?Number(a.acceptedBidDays):void 0}});h(a)}}}catch{}}catch{}h(c=>c.map(c=>String(c.id)===String(a)?{...c,status:b}:c))},n=async a=>{try{await fetch(`/api/projects/${a}`,{method:"DELETE"})}catch{}try{let a=await fetch("/api/projects");if(a.ok){let b=await a.json();if(Array.isArray(b)){let a=b.map(a=>{let b=a.createdAt?new Date(a.createdAt):null,c=b?b.getFullYear():"",d=b?String(b.getMonth()+1).padStart(2,"0"):"",e=b?String(b.getDate()).padStart(2,"0"):"",f=b?String(b.getHours()).padStart(2,"0"):"",g=b?String(b.getMinutes()).padStart(2,"0"):"";return{...a,bids:"number"==typeof a.bidsCount?a.bidsCount:Number(a.bidsCount||a.bids||0),budget:null!=a.budget?String(a.budget):"",createdAt:b?`${c}-${d}-${e} ${f}:${g}`:"",acceptedBidDays:"number"==typeof a.acceptedBidDays?a.acceptedBidDays:null!=a.acceptedBidDays?Number(a.acceptedBidDays):void 0}});h(a);return}}}catch{}h(b=>b.filter(b=>String(b.id)!==String(a)))};return(0,b.jsx)(d.Provider,{value:{projects:g,selectedProjectId:e,setSelectedProjectId:f,addProject:k,getProject:a=>{let b=g.find(b=>String(b.id)===String(a));if(b)return b;let c=String(a).toLowerCase();return g.find(a=>a.title?.toLowerCase()===c)},closeBidding:l,setProjectStatus:m,incrementBidCount:(a,b=1)=>{h(c=>c.map(c=>String(c.id)===String(a)?{...c,bids:Math.max(0,(c.bids||0)+b)}:c))},isLoaded:i,getAllProjects:()=>g,getOpenProjects:()=>g.filter(a=>"Published"===a.status||"Bidding"===a.status),getProjectsByContractor:a=>g.filter(b=>b.contractorId===a),getProjectByContractor:(a,b)=>g.find(c=>String(c.id)===String(a)&&c.contractorId===b),updateProject:(a,b)=>{let c;h(d=>d.map(d=>String(d.id)===String(a)?c={...d,...b}:d));try{fetch(`/api/projects/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})}catch{}return c},deleteProject:n,decrementBidCount:(a,b=1)=>{h(c=>c.map(c=>String(c.id)===String(a)?{...c,bids:Math.max(0,(c.bids||0)-b)}:c))}},children:a})}function f(){let a=(0,c.useContext)(d);if(!a)throw Error("useProjects must be used within ProjectProvider");return a}a.s(["ProjectProvider",()=>e,"useProjects",()=>f])},77687,a=>{"use strict";var b=a.i(72131);let c=0,d=new Map,e=a=>{if(d.has(a))return;let b=setTimeout(()=>{d.delete(a),h({type:"REMOVE_TOAST",toastId:a})},1e6);d.set(a,b)},f=[],g={toasts:[]};function h(a){g=((a,b)=>{switch(b.type){case"ADD_TOAST":return{...a,toasts:[b.toast,...a.toasts].slice(0,1)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(a=>a.id===b.toast.id?{...a,...b.toast}:a)};case"DISMISS_TOAST":{let{toastId:c}=b;return c?e(c):a.toasts.forEach(a=>{e(a.id)}),{...a,toasts:a.toasts.map(a=>a.id===c||void 0===c?{...a,open:!1}:a)}}case"REMOVE_TOAST":if(void 0===b.toastId)return{...a,toasts:[]};return{...a,toasts:a.toasts.filter(a=>a.id!==b.toastId)}}})(g,a),f.forEach(a=>{a(g)})}function i({...a}){let b=(c=(c+1)%Number.MAX_SAFE_INTEGER).toString(),d=()=>h({type:"DISMISS_TOAST",toastId:b});return h({type:"ADD_TOAST",toast:{...a,id:b,open:!0,onOpenChange:a=>{a||d()}}}),{id:b,dismiss:d,update:a=>h({type:"UPDATE_TOAST",toast:{...a,id:b}})}}function j(){let[a,c]=b.useState(g);return b.useEffect(()=>(f.push(c),()=>{let a=f.indexOf(c);a>-1&&f.splice(a,1)}),[a]),{...a,toast:i,dismiss:a=>h({type:"DISMISS_TOAST",toastId:a})}}a.s(["toast",()=>i,"useToast",()=>j])},84767,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(77687),e=a.i(85850);let f=(0,c.createContext)(void 0);function g({children:a}){let[g,h]=(0,c.useState)([]),{setProjectStatus:i,incrementBidCount:j,projects:k,updateProject:l}=(0,e.useProjects)(),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)([]);(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/bids");if(a.ok){let b=await a.json();Array.isArray(b)&&h(b)}}catch{try{let a=localStorage.getItem("bids");if(a){let b=JSON.parse(a);Array.isArray(b)&&h(b)}}catch{}try{let a=localStorage.getItem("bid_events");if(a){let b=JSON.parse(a);Array.isArray(b)&&p(b)}}catch{}}finally{n(!0)}})()},[]),(0,c.useEffect)(()=>{try{localStorage.setItem("bids",JSON.stringify(g))}catch{}},[g]),(0,c.useEffect)(()=>{try{localStorage.setItem("bid_events",JSON.stringify(o))}catch{}},[o]),(0,c.useEffect)(()=>{m&&h(a=>{let b=!1,c=a.map(a=>{if(k.find(b=>String(b.id)===String(a.projectId)))return a;let c=String(a.projectId).toLowerCase(),d=k.find(a=>a.title&&a.title.toLowerCase()===c);return d?(b=!0,{...a,projectId:String(d.id)}):a});return b?c:a})},[m,k]);let q=(a,b)=>{let c;return h(d=>d.map(d=>d.id===a?c={...d,...b}:d)),c},r=async(a,b,c,d)=>{let e=()=>{let c=new Date,d=c.getFullYear(),e=String(c.getMonth()+1).padStart(2,"0"),f=String(c.getDate()).padStart(2,"0"),g=String(c.getHours()).padStart(2,"0"),h=String(c.getMinutes()).padStart(2,"0");return q(a,{status:b,reviewedAt:c.toISOString(),recordDate:`${d}-${e}-${f}`,recordTime:`${g}:${h}`})};try{let c=await fetch(`/api/bids/${a}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:b})});if(c.ok){let d=await c.json();return h(c=>{let e=null,f=c.map(c=>c.id===a?(e=c.projectId,d):"Accepted"===b&&null!==e&&String(c.projectId)===String(e)?{...c,status:"Rejected"}:c);return"Accepted"===b&&null!==e&&i(e,"Active"),f}),{ok:!0,updated:d}}let d=await c.json().catch(()=>({}));if("Reviewed"===b){let a=e();return{ok:!1,updated:a,error:d?.error||"Failed to update status"}}return"Accepted"===b&&i(e()?.projectId||a,"Active"),{ok:!1,error:d?.error||"Failed to update status"}}catch{if("Reviewed"===b)return{ok:!1,updated:e(),error:"Network error"};return"Accepted"===b&&i(e()?.projectId||a,"Active"),{ok:!1,error:"Network error"}}},s=async(a,b)=>{try{let c=await fetch(`/api/projects/${a}/bids`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(c.ok){let b=await c.json();h(a=>[b,...a]),j(a,1),p(a=>[{id:`evt-${Date.now()}`,bidId:b.id,projectId:b.projectId,action:"submitted",timestamp:new Date().toISOString()},...a]);try{let c=k.find(b=>String(b.id)===String(a));(0,d.toast)({title:"New bid submitted",description:`${b.companyName} • ${c?.title||`Project ${a}`}`})}catch{}return{ok:!0,created:b}}let e=await c.json().catch(()=>({}));return{ok:!1,error:e?.error||"Failed to submit bid"}}catch{}return{ok:!1,error:"Network error"}},t=async(a,b,c)=>{try{await fetch("/api/email/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:a,subject:b,html:c})})}catch{}},u=async(a,b)=>{if(g.filter(b=>String(b.projectId)===String(a)&&"Reviewed"===b.status).length>=5)return;let c=g.find(a=>a.id===b);if(c&&"Reviewed"===c.status)return;try{let a=await fetch(`/api/bids/${b}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"Reviewed"})});if(a.ok){let c=await a.json();h(a=>a.map(a=>a.id===b?c:a))}else h(a=>a.map(a=>{if(a.id===b){let b=new Date,c=b.getFullYear(),d=String(b.getMonth()+1).padStart(2,"0"),e=String(b.getDate()).padStart(2,"0"),f=String(b.getHours()).padStart(2,"0"),g=String(b.getMinutes()).padStart(2,"0");return{...a,status:"Reviewed",reviewedAt:b.toISOString(),recordDate:`${c}-${d}-${e}`,recordTime:`${f}:${g}`}}return a}))}catch{h(a=>a.map(a=>{if(a.id===b){let b=new Date,c=b.getFullYear(),d=String(b.getMonth()+1).padStart(2,"0"),e=String(b.getDate()).padStart(2,"0"),f=String(b.getHours()).padStart(2,"0"),g=String(b.getMinutes()).padStart(2,"0");return{...a,status:"Reviewed",reviewedAt:b.toISOString(),recordDate:`${c}-${d}-${e}`,recordTime:`${f}:${g}`}}return a}))}p(c=>[{id:`evt-${Date.now()}`,bidId:b,projectId:a,action:"shortlisted",timestamp:new Date().toISOString()},...c]);let d=g.find(a=>a.id===b);if(d){let b=`/interview/${a}`;await t(d.email,"Interview Invitation",`<div><p>Dear ${d.bidderName},</p><p>Your bid has been shortlisted for interview.</p><p>Join the interview: <a href="${b}">${b}</a></p><p>Amount: ${(a=>{let b=Number(String(a).replace(/[^0-9.]/g,""))||0;try{return new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",maximumFractionDigits:0}).format(b)}catch{return`₦${b.toLocaleString("en-NG")}`}})(d.amount)}</p><p>Duration: ${d.duration} days</p></div>`)}},v=async(a,b)=>{let c=()=>{let c=new Date,d=c.getFullYear(),e=String(c.getMonth()+1).padStart(2,"0"),f=String(c.getDate()).padStart(2,"0"),g=String(c.getHours()).padStart(2,"0"),j=String(c.getMinutes()).padStart(2,"0");h(h=>h.map(h=>h.id===b?{...h,status:"Awarded",reviewedAt:c.toISOString(),recordDate:`${d}-${e}-${f}`,recordTime:`${g}:${j}`}:String(h.projectId)===String(a)?{...h,status:"Rejected",reviewedAt:c.toISOString(),recordDate:`${d}-${e}-${f}`,recordTime:`${g}:${j}`}:h)),i(a,"Awarded")};try{let d=await fetch(`/api/bids/${b}/award`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "},body:JSON.stringify({ownerName:"Manager"})});if(d.ok){let c=await d.json(),e=!!c?.contractSent,f=String(c?.contractSentAt||"");h(c=>c.map(c=>c.id===b?{...c,status:"Awarded",contractSent:e,contractSentAt:f}:String(c.projectId)===String(a)?{...c,status:"Rejected"}:c)),i(a,"Awarded");try{let c=g.find(a=>a.id===b);l(a,{acceptedBidDays:Number(c?.duration||0)||void 0})}catch{}}else c()}catch{c()}p(c=>[{id:`evt-${Date.now()}`,bidId:b,projectId:a,action:"awarded",timestamp:new Date().toISOString()},...c])};return(0,b.jsx)(f.Provider,{value:{bids:g,getBidsByProject:a=>g.filter(b=>String(b.projectId)===String(a)),submitBid:s,shortlistBid:u,awardBid:v,isLoaded:m,getAllBids:()=>g,getPendingBids:()=>g.filter(a=>"New"===a.status),getBid:a=>g.find(b=>b.id===a),updateBid:q,updateBidStatus:r,deleteBid:a=>{h(b=>b.filter(b=>b.id!==a))},logBidAction:(a,b,c)=>{let d=g.find(b=>b.id===a),e=d?.projectId||"";p(d=>[{id:`evt-${Date.now()}`,bidId:a,projectId:e,action:b,timestamp:new Date().toISOString(),notes:c},...d])},getEventsByProject:a=>o.filter(b=>String(b.projectId)===String(a)).sort((a,b)=>new Date(b.timestamp).getTime()-new Date(a.timestamp).getTime())},children:a})}function h(){let a=(0,c.useContext)(f);if(!a)throw Error("useBids must be used within BidProvider");return a}a.s(["BidProvider",()=>g,"useBids",()=>h])},7161,a=>{"use strict";var b=a.i(87924),c=a.i(72131);let d=(0,c.createContext)(void 0);function e({children:a}){let[e,f]=(0,c.useState)([]),g=async()=>{try{let a=await fetch("/api/manager/payments/requests",{headers:{}});if(a.ok){let b=await a.json();Array.isArray(b)&&f(b)}}catch{}};(0,c.useEffect)(()=>{g()},[]);let h=async(a,b)=>{try{(await fetch(`/api/manager/payments/requests/${a}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"APPROVED",reason:b})})).ok&&await g()}catch{}},i=async(a,b)=>{try{(await fetch(`/api/manager/payments/requests/${a}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"REJECTED",reason:b})})).ok&&await g()}catch{}};return(0,b.jsx)(d.Provider,{value:{payments:e,refresh:g,getPaymentRequest:a=>e.find(b=>b.id===a),getPendingRequests:()=>e.filter(a=>"Pending"===a.status),getHistory:()=>e.filter(a=>"Pending"!==a.status),approvePayment:h,declinePayment:i},children:a})}function f(){let a=(0,c.useContext)(d);if(!a)throw Error("usePayments must be used within PaymentProvider");return a}a.s(["PaymentProvider",()=>e,"usePayments",()=>f])},51234,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"HandleISRError",{enumerable:!0,get:function(){return e}});let d=a.r(56704).workAsyncStorage;function e({error:a}){if(d){let b=d.getStore();if(b?.isStaticGeneration)throw a&&console.error(a),a}return null}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},40622,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return h}});let d=a.r(87924),e=a.r(51234),f={fontFamily:'system-ui,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji"',height:"100vh",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},g={fontSize:"14px",fontWeight:400,lineHeight:"28px",margin:"0 8px"},h=function({error:a}){let b=a?.digest;return(0,d.jsxs)("html",{id:"__next_error__",children:[(0,d.jsx)("head",{}),(0,d.jsxs)("body",{children:[(0,d.jsx)(e.HandleISRError,{error:a}),(0,d.jsx)("div",{style:f,children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("h2",{style:g,children:["Application error: a ",b?"server":"client","-side exception has occurred while loading ",window.location.hostname," (see the"," ",b?"server logs":"browser console"," for more information)."]}),b?(0,d.jsx)("p",{style:g,children:`Digest: ${b}`}):null]})})]})]})};("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__46772004._.js.map