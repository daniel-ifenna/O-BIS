module.exports=[14747,(t,e,n)=>{e.exports=t.x("path",()=>require("path"))},22734,(t,e,n)=>{e.exports=t.x("fs",()=>require("fs"))},27087,t=>{"use strict";var e=t.i(22734),n=t.i(14747);let a=n.default.join(process.cwd(),"data");function r(t){let e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${a}`}function i(t){let e=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0");return`${e}:${n}`}async function o(){await e.promises.mkdir(a,{recursive:!0})}function s(t){return n.default.join(a,`${t}.json`)}async function c(t,n){await o();let a=s(t);try{let t=await e.promises.readFile(a,"utf8");return JSON.parse(t)}catch(t){if(t&&("ENOENT"===t.code||"ERR_MODULE_NOT_FOUND"===t.code))return await e.promises.writeFile(a,JSON.stringify(n,null,2),"utf8"),n;throw t}}async function d(t,n){await o();let a=s(t);await e.promises.writeFile(a,JSON.stringify(n,null,2),"utf8")}async function u(){return c("users",[])}async function f(t){return(await u()).find(e=>e.email.toLowerCase()===t.toLowerCase())}async function l(t,e){let n=(await u()).map(n=>n.id===t?{...n,passwordHash:e,updatedAt:new Date().toISOString()}:n);return await d("users",n),n.find(e=>e.id===t)}async function w(){return c("reset_tokens",[])}async function y(t){await d("reset_tokens",t)}async function g(t){let e=await u(),n=new Date,a=n.toISOString(),o={...t,id:`${Date.now()}`,createdAt:a,updatedAt:a};return o.recordDate=r(n),o.recordTime=i(n),await d("users",[o,...e]),o}function p(t){let{passwordHash:e,...n}=t;return n}async function m(t){let e=new Date,n=e.toISOString(),a={id:`${t.role}-${Date.now()}`,userId:t.id,email:t.email,companyName:t.company,createdAt:n,updatedAt:n};if(a.recordDate=r(e),a.recordTime=i(e),"vendor"===t.role){let t=await c("vendor_profiles",[]);await d("vendor_profiles",[a,...t]);return}if("manager"===t.role){let t=await c("managers",[]);await d("managers",[a,...t]);return}if("contractor"===t.role){let t=await c("contractors",[]);await d("contractors",[a,...t]);return}}async function S(){return c("public_procurements",[])}async function D(t){await d("public_procurements",t)}async function I(t){return(await S()).find(e=>e.id===t)}async function B(t,e){let n=(await S()).map(n=>n.id===t?{...n,quotes:[...n.quotes||[],e],status:"quoted"}:n);return await D(n),n.find(e=>e.id===t)}async function v(){return c("vendor_profiles",[])}async function P(t){await d("vendor_profiles",t)}async function j(t){return(await v()).find(e=>e.id===t)}async function O(t){let e=[t,...await v()];return await P(e),t}async function T(){return c("contractor_complaints",[])}async function $(t){await d("contractor_complaints",t)}async function _(t){let e=await T(),n=new Date,a=n.toISOString(),o=`complaint-${Date.now()}`,s={...t,id:o,filedAt:a};return s.recordDate=r(n),s.recordTime=i(n),await $([s,...e]),s}async function M(t,e){let n=await T(),a=new Date,o=n.map(n=>n.id===t?{...n,status:e,acknowledgedAt:"acknowledged"===e?a.toISOString():n.acknowledgedAt,recordDate:r(a),recordTime:i(a)}:n);return await $(o),o.find(e=>e.id===t)}async function h(t){return(await T()).filter(e=>e.managerId===t)}async function A(){return c("bids",[])}async function b(t){await d("bids",t)}async function N(t){return(await A()).filter(e=>String(e.projectId)===String(t))}async function R(t){return(await A()).find(e=>e.id===t)}async function k(t,e){let n=await A(),a=new Date,o=a.toISOString(),s={...e,id:`bid-${Date.now()}`,projectId:String(t),status:"New",submittedAt:o};return s.recordDate=r(a),s.recordTime=i(a),await b([s,...n]),s}async function C(t,e){let n=await A(),a=new Date,o=n.map(n=>n.id===t?{...n,...e,recordDate:r(a),recordTime:i(a)}:n);return await b(o),o.find(e=>e.id===t)}async function U(t){let e=await A();await b(e.filter(e=>e.id!==t))}async function x(){return c("bidInvitations",[])}async function q(t){await d("bidInvitations",t)}async function E(t){return(await x()).filter(e=>e.bidId===t)}async function F(t){let e=await x(),n=new Date,a=n.toISOString(),o={...t,id:`inv-${Date.now()}`,createdAt:a,recordDate:r(n),recordTime:i(n)};return await q([o,...e]),o}async function V(){return c("projects",[])}async function J(t){await d("projects",t)}async function L(t){return(await V()).find(e=>String(e.id)===String(t))}async function H(t){let e=await V(),n=Date.now(),a=new Date,o=a.toISOString(),s={...t,id:n,createdAt:o};return s.recordDate=r(a),s.recordTime=i(a),await J([s,...e]),s}async function z(t,e){let n=await V(),a=new Date,o=n.map(n=>String(n.id)===String(t)?{...n,...e,recordDate:r(a),recordTime:i(a)}:n);return await J(o),o.find(e=>String(e.id)===String(t))}async function Q(){return c("milestones",[])}async function Y(t){await d("milestones",t)}async function G(t){return(await Q()).filter(e=>String(e.projectId)===String(t))}async function K(t,e){let n=(await Q()).filter(e=>String(e.projectId)!==String(t)),a=e.map(e=>({id:`ms-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,projectId:String(t),name:e.name,startDate:e.startDate,endDate:e.endDate,weight:e.weight,progress:0,status:"Pending"}));return await Y([...a,...n]),a}async function W(t,e,n){let a=(await Q()).map(a=>{if(a.id===e&&String(a.projectId)===String(t)){let t=Math.max(a.progress,Math.min(100,n));return{...a,progress:t,status:t>=100?"Completed":t>0?"In Progress":"Pending"}}return a});return await Y(a),a.find(t=>t.id===e)}async function X(){return c("daily_reports",[])}async function Z(t){await d("daily_reports",t)}async function tt(t){return(await X()).filter(e=>String(e.projectId)===String(t))}async function te(t){let e=await X(),n=new Date,a={...t,id:`dr-${Date.now()}`};return a.recordDate=r(n),a.recordTime=i(n),await Z([a,...e]),a}t.s(["addBidInvitation",()=>F,"addQuoteToProcurement",()=>B,"createBid",()=>k,"createComplaint",()=>_,"createDailyReport",()=>te,"createProject",()=>H,"createRoleProfile",()=>m,"createUser",()=>g,"createVendorProfile",()=>O,"deleteBidById",()=>U,"findUserByEmail",()=>f,"findVendorProfileById",()=>j,"getBidById",()=>R,"getBidInvitations",()=>x,"getBidInvitationsByBidId",()=>E,"getBids",()=>A,"getBidsByProjectId",()=>N,"getComplaints",()=>T,"getComplaintsByManager",()=>h,"getDailyReports",()=>X,"getDailyReportsByProjectId",()=>tt,"getMilestones",()=>Q,"getMilestonesByProjectId",()=>G,"getProcurementById",()=>I,"getProcurements",()=>S,"getProjectById",()=>L,"getProjects",()=>V,"getResetTokens",()=>w,"getUsers",()=>u,"getVendorProfiles",()=>v,"sanitizeUser",()=>p,"saveBidInvitations",()=>q,"saveBids",()=>b,"saveComplaints",()=>$,"saveDailyReports",()=>Z,"saveMilestones",()=>Y,"saveProcurements",()=>D,"saveProjects",()=>J,"saveResetTokens",()=>y,"saveVendorProfiles",()=>P,"setProjectMilestones",()=>K,"updateBidById",()=>C,"updateComplaintStatus",()=>M,"updateMilestoneProgress",()=>W,"updateProjectById",()=>z,"updateUserPasswordById",()=>l])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__74e0f837._.js.map