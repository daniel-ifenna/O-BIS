{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/lib/project-context.tsx"],"sourcesContent":["\"use client\"\n\nimport { createContext, useContext, useEffect, useState, type ReactNode } from \"react\"\n\ninterface Project {\n  id: string | number\n  title: string\n  location: string\n  budget: string\n  status: string\n  bids: number\n  createdAt: string\n  estimatedCost: string\n  contingency: string\n  contingencyPercent: string\n  paymentSchedule: string\n  paymentTerms: string\n  retentionPercent: string\n  category?: string\n  description?: string\n  contractorId?: string\n  bidDays?: number\n  acceptedBidDays?: number\n}\n\ninterface ProjectContextType {\n  projects: Project[]\n  selectedProjectId: string | number | null\n  setSelectedProjectId: (id: string | number | null) => void\n  addProject: (project: Project) => Promise<{ ok: boolean; error?: string }>\n  getProject: (id: string | number) => Project | undefined\n  closeBidding: (id: string | number) => void\n  setProjectStatus: (id: string | number, status: string) => void\n  incrementBidCount: (id: string | number, delta?: number) => void\n  isLoaded: boolean\n  getAllProjects: () => Project[]\n  getOpenProjects: () => Project[]\n  getProjectsByContractor: (contractorId: string) => Project[]\n  getProjectByContractor: (projectId: string | number, contractorId: string) => Project | undefined\n  updateProject: (id: string | number, updates: Partial<Project>) => Project | undefined\n  deleteProject: (id: string | number) => void\n  decrementBidCount: (id: string | number, delta?: number) => void\n}\n\nconst ProjectContext = createContext<ProjectContextType | undefined>(undefined)\n\nexport function ProjectProvider({ children }: { children: ReactNode }) {\n  const [selectedProjectId, setSelectedProjectId] = useState<string | number | null>(null)\n  const [projects, setProjects] = useState<Project[]>([])\n  const [isLoaded, setIsLoaded] = useState(false)\n\n  useEffect(() => {\n    const load = async () => {\n      try {\n        const res = await fetch(\"/api/projects\")\n        if (res.ok) {\n          const items = await res.json()\n          if (Array.isArray(items)) {\n            const normalized = items.map((p: any) => {\n              const d = p.createdAt ? new Date(p.createdAt) : null\n              const y = d ? d.getFullYear() : \"\"\n              const m = d ? String(d.getMonth() + 1).padStart(2, \"0\") : \"\"\n              const day = d ? String(d.getDate()).padStart(2, \"0\") : \"\"\n              const h = d ? String(d.getHours()).padStart(2, \"0\") : \"\"\n              const min = d ? String(d.getMinutes()).padStart(2, \"0\") : \"\"\n              return {\n                ...p,\n                bids: typeof p.bidsCount === \"number\" ? p.bidsCount : Number(p.bidsCount || p.bids || 0),\n                budget: p.budget != null ? String(p.budget) : \"\",\n                createdAt: d ? `${y}-${m}-${day} ${h}:${min}` : \"\",\n                acceptedBidDays: typeof p.acceptedBidDays === \"number\" ? p.acceptedBidDays : (p.acceptedBidDays != null ? Number(p.acceptedBidDays) : undefined),\n              }\n            })\n            setProjects(normalized)\n          }\n        }\n      } catch {\n      } finally {\n        setIsLoaded(true)\n      }\n    }\n    void load()\n  }, [])\n\n  useEffect(() => {\n    // no-op: keep state in memory; source of truth is Prisma via /api/projects\n  }, [projects])\n\n  const addProject = async (project: Project) => {\n    try {\n    const token = (typeof window !== \"undefined\" && (localStorage.getItem(\"token\") || localStorage.getItem(\"authToken\") || localStorage.getItem(\"auth_token\") || localStorage.getItem(\"managerToken\") || \"\")) || \"\"\n      const res = await fetch(\"/api/projects\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\", ...(token ? { Authorization: `Bearer ${token}` } : {}) },\n        body: JSON.stringify(project),\n      })\n      if (res.ok) {\n        const created = await res.json()\n        setProjects((prev) => [created, ...prev])\n        try {\n          const listRes = await fetch(\"/api/projects\")\n          if (listRes.ok) {\n            const items = await listRes.json()\n            if (Array.isArray(items)) {\n              const normalized = items.map((p: any) => {\n                const d = p.createdAt ? new Date(p.createdAt) : null\n                const y = d ? d.getFullYear() : \"\"\n                const m = d ? String(d.getMonth() + 1).padStart(2, \"0\") : \"\"\n                const day = d ? String(d.getDate()).padStart(2, \"0\") : \"\"\n                const h = d ? String(d.getHours()).padStart(2, \"0\") : \"\"\n                const min = d ? String(d.getMinutes()).padStart(2, \"0\") : \"\"\n                return {\n                  ...p,\n                  bids: typeof p.bidsCount === \"number\" ? p.bidsCount : Number(p.bidsCount || p.bids || 0),\n                  budget: p.budget != null ? String(p.budget) : \"\",\n                  createdAt: d ? `${y}-${m}-${day} ${h}:${min}` : \"\",\n                  acceptedBidDays: typeof p.acceptedBidDays === \"number\" ? p.acceptedBidDays : (p.acceptedBidDays != null ? Number(p.acceptedBidDays) : undefined),\n                }\n              })\n              setProjects(normalized)\n            }\n          }\n        } catch {}\n        return { ok: true as const }\n      } else {\n        let err = \"Failed to create project\"\n        try {\n          const j = await res.json()\n          if (j?.error) err = String(j.error)\n        } catch {}\n        return { ok: false as const, error: err }\n      }\n    } catch {}\n    try {\n      const msg = await (async () => {\n        const r = await fetch(\"/api/projects\")\n        return r.ok ? \"Server reachable\" : \"Server unreachable\"\n      })()\n      return { ok: false as const, error: msg }\n    } catch {\n      return { ok: false as const, error: \"Network error\" }\n    }\n  }\n\n  const getProject = (id: string | number) => {\n    const foundById = projects.find((p) => String(p.id) === String(id))\n    if (foundById) return foundById\n    const key = String(id).toLowerCase()\n    return projects.find((p) => p.title?.toLowerCase() === key)\n  }\n\n  const closeBidding = async (id: string | number) => {\n    let updatedRemote: any = null\n    try {\n      const res = await fetch(`/api/projects/${id}`, {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ status: \"Closed\" }),\n      })\n      if (res.ok) {\n        updatedRemote = await res.json()\n      }\n    } catch {}\n    setProjects((prev) =>\n      prev.map((p) => {\n        if (String(p.id) !== String(id)) return p\n        if (updatedRemote) {\n          const d = updatedRemote.createdAt ? new Date(updatedRemote.createdAt) : null\n          let createdAt = p.createdAt\n          if (d) {\n            const y = d.getFullYear()\n            const m = String(d.getMonth() + 1).padStart(2, \"0\")\n            const day = String(d.getDate()).padStart(2, \"0\")\n            const h = String(d.getHours()).padStart(2, \"0\")\n            const min = String(d.getMinutes()).padStart(2, \"0\")\n            createdAt = `${y}-${m}-${day} ${h}:${min}`\n          }\n          return {\n            ...p,\n            status: String(updatedRemote.status || \"Closed\"),\n            budget: updatedRemote.budget != null ? String(updatedRemote.budget) : p.budget,\n            createdAt,\n          }\n        }\n        return { ...p, status: p.status === \"Awarded\" ? \"Awarded\" : \"Closed\" }\n      }),\n    )\n  }\n\n  const setProjectStatus = async (id: string | number, status: string) => {\n    try {\n      const res = await fetch(`/api/projects/${id}`, {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ status }),\n      })\n      if (res.ok) {\n        try {\n          const latest = await fetch(\"/api/projects\")\n          if (latest.ok) {\n            const items = await latest.json()\n            if (Array.isArray(items)) {\n              const normalized = items.map((p: any) => {\n                const d = p.createdAt ? new Date(p.createdAt) : null\n                const y = d ? d.getFullYear() : \"\"\n                const m = d ? String(d.getMonth() + 1).padStart(2, \"0\") : \"\"\n                const day = d ? String(d.getDate()).padStart(2, \"0\") : \"\"\n                const h = d ? String(d.getHours()).padStart(2, \"0\") : \"\"\n                const min = d ? String(d.getMinutes()).padStart(2, \"0\") : \"\"\n                return {\n                  ...p,\n                  bids: typeof p.bidsCount === \"number\" ? p.bidsCount : Number(p.bidsCount || p.bids || 0),\n                  budget: p.budget != null ? String(p.budget) : \"\",\n                  createdAt: d ? `${y}-${m}-${day} ${h}:${min}` : \"\",\n                  acceptedBidDays: typeof p.acceptedBidDays === \"number\" ? p.acceptedBidDays : (p.acceptedBidDays != null ? Number(p.acceptedBidDays) : undefined),\n                }\n              })\n              setProjects(normalized)\n            }\n          }\n        } catch {}\n      }\n    } catch {}\n    setProjects((prev) => prev.map((p) => (String(p.id) === String(id) ? { ...p, status } : p)))\n  }\n\n  const incrementBidCount = (id: string | number, delta: number = 1) => {\n    setProjects((prev) =>\n      prev.map((p) => (String(p.id) === String(id) ? { ...p, bids: Math.max(0, (p.bids || 0) + delta) } : p)),\n    )\n  }\n\n  const getAllProjects = () => projects\n\n  const getOpenProjects = () => projects.filter((p) => p.status === \"Published\" || p.status === \"Bidding\")\n\n  const getProjectsByContractor = (contractorId: string) => projects.filter((p) => p.contractorId === contractorId)\n\n  const getProjectByContractor = (projectId: string | number, contractorId: string) =>\n    projects.find((p) => String(p.id) === String(projectId) && p.contractorId === contractorId)\n\n  const updateProject = (id: string | number, updates: Partial<Project>) => {\n    let updated: Project | undefined\n    setProjects((prev) =>\n      prev.map((p) => {\n        if (String(p.id) === String(id)) {\n          updated = { ...p, ...updates }\n          return updated\n        }\n        return p\n      }),\n    )\n    try {\n      fetch(`/api/projects/${id}`, {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(updates),\n      })\n    } catch {}\n    return updated\n  }\n\n  const deleteProject = async (id: string | number) => {\n    try {\n      await fetch(`/api/projects/${id}`, { method: \"DELETE\" })\n    } catch {}\n    try {\n      const latest = await fetch(\"/api/projects\")\n      if (latest.ok) {\n        const items = await latest.json()\n        if (Array.isArray(items)) {\n          const normalized = items.map((p: any) => {\n            const d = p.createdAt ? new Date(p.createdAt) : null\n            const y = d ? d.getFullYear() : \"\"\n            const m = d ? String(d.getMonth() + 1).padStart(2, \"0\") : \"\"\n            const day = d ? String(d.getDate()).padStart(2, \"0\") : \"\"\n            const h = d ? String(d.getHours()).padStart(2, \"0\") : \"\"\n            const min = d ? String(d.getMinutes()).padStart(2, \"0\") : \"\"\n            return {\n              ...p,\n              bids: typeof p.bidsCount === \"number\" ? p.bidsCount : Number(p.bidsCount || p.bids || 0),\n              budget: p.budget != null ? String(p.budget) : \"\",\n              createdAt: d ? `${y}-${m}-${day} ${h}:${min}` : \"\",\n              acceptedBidDays: typeof p.acceptedBidDays === \"number\" ? p.acceptedBidDays : (p.acceptedBidDays != null ? Number(p.acceptedBidDays) : undefined),\n            }\n          })\n          setProjects(normalized)\n          return\n        }\n      }\n    } catch {}\n    setProjects((prev) => prev.filter((p) => String(p.id) !== String(id)))\n  }\n\n  const decrementBidCount = (id: string | number, delta: number = 1) => {\n    setProjects((prev) =>\n      prev.map((p) =>\n        String(p.id) === String(id) ? { ...p, bids: Math.max(0, (p.bids || 0) - delta) } : p,\n      ),\n    )\n  }\n\n  return (\n    <ProjectContext.Provider\n      value={{\n        projects,\n        selectedProjectId,\n        setSelectedProjectId,\n        addProject,\n        getProject,\n        closeBidding,\n        setProjectStatus,\n        incrementBidCount,\n        isLoaded,\n        getAllProjects,\n        getOpenProjects,\n        getProjectsByContractor,\n        getProjectByContractor,\n        updateProject,\n        deleteProject,\n        decrementBidCount,\n      }}\n    >\n      {children}\n    </ProjectContext.Provider>\n  )\n}\n\nexport function useProjects() {\n  const context = useContext(ProjectContext)\n  if (!context) {\n    throw new Error(\"useProjects must be used within ProjectProvider\")\n  }\n  return context\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 352, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/lib/auth-context.tsx"],"sourcesContent":["\"use client\"\n\nimport { createContext, useContext, useState, useEffect, type ReactNode } from \"react\"\nimport { useRouter } from \"next/navigation\"\n\nexport interface User {\n  id: string\n  name: string\n  email: string\n  role: \"manager\" | \"contractor\" | \"vendor\"\n  company?: string\n  isVerified?: boolean\n}\n\ninterface AuthContextType {\n  user: User | null\n  isLoading: boolean\n  signUp: (data: {\n    name: string\n    email: string\n    password: string\n    role: \"manager\" | \"contractor\" | \"vendor\"\n    company?: string\n  }) => Promise<void>\n  signIn: (email: string, password: string) => Promise<void>\n  signInWithRole: (email: string, password: string, role: \"manager\" | \"contractor\" | \"vendor\") => Promise<void>\n  signOut: () => void\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null)\n  const [isLoading, setIsLoading] = useState(true)\n  const router = useRouter()\n\n  // Load user from localStorage on mount\n  useEffect(() => {\n    const savedUser = localStorage.getItem(\"auth_user\")\n    if (savedUser) {\n      try {\n        const parsedUser = JSON.parse(savedUser)\n        fetch(`/api/auth/exists?email=${encodeURIComponent(parsedUser.email)}`)\n          .then(async (res) => {\n            if (!res.ok) throw new Error(\"verify failed\")\n            const data = await res.json()\n            if (data?.exists && data.user?.email === parsedUser.email) {\n              setUser(data.user)\n              try { document.cookie = `auth_role=${data.user.role}; Path=/; SameSite=Lax` } catch {}\n              console.log(\"[v0] User verified via Prisma:\", parsedUser.email)\n            } else {\n              localStorage.removeItem(\"auth_user\")\n            }\n          })\n          .catch(() => {\n            localStorage.removeItem(\"auth_user\")\n          })\n      } catch (error) {\n        console.error(\"[v0] Failed to parse saved user:\", error)\n        localStorage.removeItem(\"auth_user\")\n      }\n    }\n    setIsLoading(false)\n  }, [])\n\n  const signUp = async (data: {\n    name: string\n    email: string\n    password: string\n    role: \"manager\" | \"contractor\" | \"vendor\"\n    company?: string\n  }) => {\n    setIsLoading(true)\n    try {\n      console.log(\"[v0] Signing up user:\", data.email)\n      const response = await fetch(\"/api/auth/signup\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(data),\n      })\n\n      if (!response.ok) {\n        let errorMessage = \"Sign up failed\"\n        try {\n          const errorData = await response.json()\n          errorMessage = errorData.error || errorMessage\n        } catch (e) {\n          errorMessage = `Sign up failed: ${response.statusText}`\n        }\n        throw new Error(errorMessage)\n      }\n\n      let userData\n      try {\n        userData = await response.json()\n      } catch (e) {\n        throw new Error(\"Invalid server response\")\n      }\n\n      setUser(userData)\n      localStorage.setItem(\"auth_user\", JSON.stringify(userData))\n      if ((userData as any)?.token) {\n        try { localStorage.setItem(\"auth_token\", String((userData as any).token)) } catch {}\n      }\n      try { document.cookie = `auth_role=${userData.role}; Path=/; SameSite=Lax` } catch {}\n      const next = userData.role === \"vendor\" ? \"/vendor/portal\" : userData.role === \"contractor\" ? \"/contractor/dashboard\" : \"/manager/dashboard\"\n      console.log(\"[v0] Sign up successful, redirecting to:\", next)\n      router.push(next)\n    } catch (err) {\n      console.error(\"[v0] Sign up error:\", err)\n      throw err\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const signIn = async (email: string, password: string) => {\n    setIsLoading(true)\n    try {\n      console.log(\"[v0] Signing in user:\", email)\n      const response = await fetch(\"/api/auth/signin\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email, password }),\n      })\n\n      if (!response.ok) {\n        let errorMessage = \"Sign in failed\"\n        try {\n          const errorData = await response.json()\n          errorMessage = errorData.error || errorMessage\n        } catch (e) {\n          errorMessage = `Sign in failed: ${response.statusText}`\n        }\n        throw new Error(errorMessage)\n      }\n\n      let userData\n      try {\n        userData = await response.json()\n      } catch (e) {\n        throw new Error(\"Invalid server response\")\n      }\n\n      setUser(userData)\n      localStorage.setItem(\"auth_user\", JSON.stringify(userData))\n      if ((userData as any)?.token) {\n        try { localStorage.setItem(\"auth_token\", String((userData as any).token)) } catch {}\n      }\n      try {\n        document.cookie = `auth_role=${userData.role}; Path=/; SameSite=Lax`\n      } catch {}\n      const next = userData.role === \"vendor\" ? \"/vendor/portal\" : userData.role === \"contractor\" ? \"/contractor/dashboard\" : \"/manager/dashboard\"\n      console.log(\"[v0] Sign in successful, redirecting to:\", next)\n      router.push(next)\n    } catch (err) {\n      console.error(\"[v0] Sign in error:\", err)\n      throw err\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const signOut = () => {\n    console.log(\"[v0] Signing out user\")\n    setUser(null)\n    localStorage.removeItem(\"auth_user\")\n    try {\n      document.cookie = \"auth_role=; Path=/; Max-Age=0; SameSite=Lax\"\n    } catch {}\n    router.push(\"/\")\n  }\n\n  const signInWithRole = async (email: string, password: string, role: \"manager\" | \"contractor\" | \"vendor\") => {\n    setIsLoading(true)\n    try {\n      let endpoint = \"/api/auth/signin\"\n      if (role === \"contractor\") endpoint = \"/api/auth/contractor/signin\"\n      if (role === \"manager\") endpoint = \"/api/auth/manager/signin\"\n      if (role === \"vendor\") endpoint = \"/api/auth/vendor/signin\"\n      const response = await fetch(endpoint, { method: \"POST\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify({ email, password }) })\n      if (!response.ok) {\n        let msg = \"Sign in failed\"\n        try {\n          const e = await response.json()\n          msg = e.error || msg\n        } catch {}\n        throw new Error(msg)\n      }\n      let payload: any\n      try {\n        payload = await response.json()\n      } catch {\n        throw new Error(\"Invalid server response\")\n      }\n      const userData: User = payload?.user || payload\n      if (userData?.role !== role) {\n        throw new Error(\"Account role mismatch for this portal\")\n      }\n      setUser(userData)\n      localStorage.setItem(\"auth_user\", JSON.stringify(userData))\n      if (payload?.token) {\n        try { localStorage.setItem(\"auth_token\", String(payload.token)) } catch {}\n      }\n      try { document.cookie = `auth_role=${userData.role}; Path=/; SameSite=Lax` } catch {}\n      const next = userData.role === \"vendor\" ? \"/vendor/portal\" : userData.role === \"contractor\" ? \"/contractor/dashboard\" : \"/manager/dashboard\"\n      router.push(next)\n    } catch (err) {\n      throw err\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  return <AuthContext.Provider value={{ user, isLoading, signUp, signIn, signInWithRole, signOut }}>{children}</AuthContext.Provider>\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext)\n  if (!context) {\n    throw new Error(\"useAuth must be used within AuthProvider\")\n  }\n  return context\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 584, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/lib/procurement-context.tsx"],"sourcesContent":["\"use client\"\n\nimport { createContext, useContext, useEffect, useState, type ReactNode } from \"react\"\n\nexport interface PublicProcurementRequest {\n  id: string\n  projectId: string\n  contractorId: string\n  item: string\n  specification: string\n  quantity: number\n  unit: string\n  deliveryLocation: string\n  requestedDate: string\n  status: \"open\" | \"quoted\" | \"awarded\"\n  createdAt: string\n  isPublic: boolean\n  quotes: Quote[]\n  selectedQuoteId?: string\n}\n\nexport interface Quote {\n  id: string\n  procurementRequestId: string\n  vendorId: string\n  vendorName: string\n  vendorEmail: string\n  pricePerUnit: string\n  totalPrice: string\n  deliveryDays: number\n  deliveryDate: string\n  submittedAt: string\n  status: \"pending\" | \"selected\" | \"rejected\"\n  notes?: string\n  recordDate?: string\n  recordTime?: string\n}\n\ninterface ProcurementContextType {\n  procurements: PublicProcurementRequest[]\n  addProcurement: (procurement: PublicProcurementRequest) => void\n  getProcurement: (id: string) => PublicProcurementRequest | undefined\n  addQuote: (procurementId: string, quote: Quote) => void\n  getQuotes: (procurementId: string) => Quote[]\n  selectQuote: (procurementId: string, quoteId: string) => Promise<void>\n  awardQuote: (procurementId: string, quoteId: string) => Promise<void>\n}\n\nconst ProcurementContext = createContext<ProcurementContextType | undefined>(undefined)\n\nexport function ProcurementProvider({ children }: { children: ReactNode }) {\n  const [procurements, setProcurements] = useState<PublicProcurementRequest[]>([])\n\n  useEffect(() => {\n    const load = async () => {\n      try {\n        const res = await fetch(\"/api/procurements/public\")\n        if (res.ok) {\n          const items = await res.json()\n          if (Array.isArray(items)) setProcurements(items)\n        }\n      } catch {}\n    }\n    void load()\n  }, [])\n\n  const revalidate = async () => {\n    try {\n      const res = await fetch(\"/api/procurements/public\")\n      if (res.ok) {\n        const items = await res.json()\n        if (Array.isArray(items)) setProcurements(items)\n      }\n    } catch {}\n  }\n\n  const addProcurement = (procurement: PublicProcurementRequest) => {\n    setProcurements((prev) => [procurement, ...prev])\n  }\n\n  const getProcurement = (id: string) => {\n    return procurements.find((p) => p.id === id)\n  }\n\n  const addQuote = async (procurementId: string, quote: Quote) => {\n    try {\n      const res = await fetch(`/api/procurements/${procurementId}/quotes`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(quote),\n      })\n      if (res.ok) {\n        const saved = await res.json()\n        setProcurements((prev) =>\n          prev.map((p) => (p.id === procurementId ? { ...p, quotes: [...p.quotes, saved], status: \"quoted\" } : p)),\n        )\n        await revalidate()\n        return\n      }\n    } catch {}\n    setProcurements((prev) =>\n      prev.map((p) => (p.id === procurementId ? { ...p, quotes: [...p.quotes, quote], status: \"quoted\" } : p)),\n    )\n    await revalidate()\n  }\n\n  const getQuotes = (procurementId: string) => {\n    const procurement = getProcurement(procurementId)\n    return procurement?.quotes || []\n  }\n\n  const sendEmail = async (to: string, subject: string, html: string) => {\n    try {\n      await fetch(\"/api/email/send\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ to, subject, html }),\n      })\n    } catch {}\n  }\n\n  const selectQuote = async (procurementId: string, quoteId: string) => {\n    const procurement = getProcurement(procurementId)\n    if (!procurement) return\n    const quote = procurement.quotes.find((q) => q.id === quoteId)\n    if (!quote) return\n    setProcurements((prev) =>\n      prev.map((p) =>\n        p.id === procurementId\n          ? {\n              ...p,\n              selectedQuoteId: quoteId,\n              quotes: p.quotes.map((q) => ({ ...q, status: q.id === quoteId ? \"selected\" : q.status })),\n            }\n          : p,\n      ),\n    )\n    await revalidate()\n    await sendEmail(\n      quote.vendorEmail,\n      \"Interview Invitation\",\n      `<div>\n        <p>Dear ${quote.vendorName},</p>\n        <p>Your quote has been shortlisted for interview.</p>\n        <p>Item: ${procurement.item}</p>\n        <p>Total Price: ${quote.totalPrice}</p>\n      </div>`,\n    )\n  }\n\n  const awardQuote = async (procurementId: string, quoteId: string) => {\n    const procurement = getProcurement(procurementId)\n    if (!procurement) return\n    const quote = procurement.quotes.find((q) => q.id === quoteId)\n    if (!quote) return\n    setProcurements((prev) =>\n      prev.map((p) =>\n        p.id === procurementId\n          ? {\n              ...p,\n              status: \"awarded\",\n              selectedQuoteId: quoteId,\n              quotes: p.quotes.map((q) => ({ ...q, status: q.id === quoteId ? \"selected\" : q.status })),\n            }\n          : p,\n      ),\n    )\n    await revalidate()\n    await sendEmail(\n      quote.vendorEmail,\n      \"Award of Contract\",\n      `<div>\n        <p>Dear ${quote.vendorName},</p>\n        <p>Your quote has been accepted.</p>\n        <p>Item: ${procurement.item}</p>\n        <p>Total Price: ${quote.totalPrice}</p>\n        <p>Please proceed with delivery according to agreed terms.</p>\n      </div>`,\n    )\n  }\n\n  return (\n    <ProcurementContext.Provider\n      value={{\n        procurements,\n        addProcurement,\n        getProcurement,\n        addQuote,\n        getQuotes,\n        selectQuote,\n        awardQuote,\n      }}\n    >\n      {children}\n    </ProcurementContext.Provider>\n  )\n}\n\nexport function useProcurements() {\n  const context = useContext(ProcurementContext)\n  if (!context) {\n    throw new Error(\"useProcurements must be used within ProcurementProvider\")\n  }\n  return context\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 752, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/lib/complaint-context.tsx"],"sourcesContent":["\"use client\"\n\nimport { createContext, useContext, useState, type ReactNode } from \"react\"\n\nexport interface ContractorComplaint {\n  id: string\n  projectId: string\n  contractorId: string\n  contractorName: string\n  managerId: string\n  category: \"vendor-performance\" | \"quality-issue\" | \"safety-concern\" | \"payment-delay\" | \"other\"\n  subject: string\n  description: string\n  severity: \"low\" | \"medium\" | \"high\" | \"critical\"\n  attachments?: string[]\n  status: \"open\" | \"acknowledged\" | \"investigating\" | \"resolved\" | \"closed\"\n  filedAt: string\n  acknowledgedAt?: string\n  acknowledgedBy?: string\n  resolution?: string\n  resolvedAt?: string\n  feedback?: string\n  activities: ComplaintActivity[]\n}\n\nexport interface ComplaintActivity {\n  id: string\n  complaintId: string\n  managerId?: string\n  action: \"created\" | \"acknowledged\" | \"assigned\" | \"updated\" | \"resolved\"\n  notes: string\n  timestamp: string\n}\n\ninterface ComplaintContextType {\n  complaints: ContractorComplaint[]\n  addComplaint: (complaint: Omit<ContractorComplaint, \"id\" | \"filedAt\" | \"activities\">) => void\n  getComplaint: (id: string) => ContractorComplaint | undefined\n  getComplaintsByProject: (projectId: string) => ContractorComplaint[]\n  getComplaintsByContractor: (contractorId: string) => ContractorComplaint[]\n  getComplaintsByManager: (managerId: string) => ContractorComplaint[]\n  updateComplaintStatus: (id: string, status: ContractorComplaint[\"status\"]) => void\n  resolveComplaint: (id: string, resolution: string) => void\n  addActivity: (complaintId: string, activity: Omit<ComplaintActivity, \"id\">) => void\n}\n\nconst ComplaintContext = createContext<ComplaintContextType | undefined>(undefined)\n\nexport function ComplaintProvider({ children }: { children: ReactNode }) {\n  const [complaints, setComplaints] = useState<ContractorComplaint[]>([])\n\n  const addComplaint = async (complaint: Omit<ContractorComplaint, \"id\" | \"filedAt\" | \"activities\">) => {\n    try {\n      const res = await fetch(\"/api/complaints\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(complaint),\n      })\n      if (res.ok) {\n        const created = (await res.json()) as ContractorComplaint\n        setComplaints((prev) => [created, ...prev])\n        return\n      }\n    } catch {}\n    const fallback: ContractorComplaint = {\n      ...complaint,\n      id: `complaint-${Date.now()}`,\n      filedAt: new Date().toISOString(),\n      activities: [],\n      status: \"open\",\n    }\n    setComplaints((prev) => [fallback, ...prev])\n  }\n\n  const getComplaint = (id: string) => {\n    return complaints.find((c) => c.id === id)\n  }\n\n  const getComplaintsByProject = (projectId: string) => {\n    return complaints.filter((c) => c.projectId === projectId)\n  }\n\n  const getComplaintsByContractor = (contractorId: string) => {\n    return complaints.filter((c) => c.contractorId === contractorId)\n  }\n\n  const getComplaintsByManager = (managerId: string) => {\n    return complaints.filter((c) => c.managerId === managerId)\n  }\n\n  const updateComplaintStatus = (id: string, status: ContractorComplaint[\"status\"]) => {\n    setComplaints((prev) =>\n      prev.map((c) => {\n        if (c.id === id) {\n          const activity: ComplaintActivity = {\n            id: `activity-${Date.now()}`,\n            complaintId: id,\n            action: \"updated\",\n            notes: `Status changed to ${status}`,\n            timestamp: new Date().toISOString(),\n          }\n          return {\n            ...c,\n            status,\n            acknowledgedAt: status === \"acknowledged\" ? new Date().toISOString() : c.acknowledgedAt,\n            activities: [...c.activities, activity],\n          }\n        }\n        return c\n      }),\n    )\n  }\n\n  const resolveComplaint = (id: string, resolution: string) => {\n    setComplaints((prev) =>\n      prev.map((c) => {\n        if (c.id === id) {\n          const activity: ComplaintActivity = {\n            id: `activity-${Date.now()}`,\n            complaintId: id,\n            action: \"resolved\",\n            notes: resolution,\n            timestamp: new Date().toISOString(),\n          }\n          return {\n            ...c,\n            status: \"resolved\",\n            resolution,\n            resolvedAt: new Date().toISOString(),\n            activities: [...c.activities, activity],\n          }\n        }\n        return c\n      }),\n    )\n  }\n\n  const addActivity = (complaintId: string, activity: Omit<ComplaintActivity, \"id\">) => {\n    setComplaints((prev) =>\n      prev.map((c) => {\n        if (c.id === complaintId) {\n          return {\n            ...c,\n            activities: [\n              ...c.activities,\n              {\n                ...activity,\n                id: `activity-${Date.now()}`,\n              },\n            ],\n          }\n        }\n        return c\n      }),\n    )\n  }\n\n  return (\n    <ComplaintContext.Provider\n      value={{\n        complaints,\n        addComplaint,\n        getComplaint,\n        getComplaintsByProject,\n        getComplaintsByContractor,\n        getComplaintsByManager,\n        updateComplaintStatus,\n        resolveComplaint,\n        addActivity,\n      }}\n    >\n      {children}\n    </ComplaintContext.Provider>\n  )\n}\n\nexport function useComplaints() {\n  const context = useContext(ComplaintContext)\n  if (!context) {\n    throw new Error(\"useComplaints must be used within ComplaintProvider\")\n  }\n  return context\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 902, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/lib/payment-context.tsx"],"sourcesContent":["\"use client\"\n\nimport { createContext, useContext, useEffect, useState, type ReactNode } from \"react\"\nimport type { PaymentRequest } from \"@/lib/database-schema\"\n\ninterface PaymentContextType {\n  payments: PaymentRequest[]\n  refresh: () => Promise<void>\n  getPaymentRequest: (id: string) => PaymentRequest | undefined\n  getPendingRequests: () => PaymentRequest[]\n  getHistory: () => PaymentRequest[]\n  approvePayment: (id: string, reason?: string) => Promise<void>\n  declinePayment: (id: string, reason?: string) => Promise<void>\n}\n\nconst PaymentContext = createContext<PaymentContextType | undefined>(undefined)\n\nexport function PaymentProvider({ children }: { children: ReactNode }) {\n  const [payments, setPayments] = useState<PaymentRequest[]>([])\n\n  const getToken = () => {\n    if (typeof window === \"undefined\") return \"\"\n    return (\n      localStorage.getItem(\"token\") ||\n      localStorage.getItem(\"authToken\") ||\n      localStorage.getItem(\"auth_token\") ||\n      localStorage.getItem(\"managerToken\") ||\n      \"\"\n    )\n  }\n\n  const refresh = async () => {\n    try {\n      const token = getToken()\n      const res = await fetch(\"/api/manager/payments/requests\", { headers: token ? { Authorization: `Bearer ${token}` } : {} })\n      if (res.ok) {\n        const items = await res.json()\n        if (Array.isArray(items)) setPayments(items)\n      }\n    } catch {}\n  }\n\n  useEffect(() => {\n    void refresh()\n  }, [])\n\n  const approvePayment = async (id: string, reason?: string) => {\n    try {\n      const token = getToken()\n      const res = await fetch(`/api/manager/payments/requests/${id}/status`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\", ...(token ? { Authorization: `Bearer ${token}` } : {}) },\n        body: JSON.stringify({ status: \"APPROVED\", reason }),\n      })\n      if (res.ok) await refresh()\n    } catch {}\n  }\n\n  const getPaymentRequest = (id: string) => payments.find((p) => p.id === id)\n\n  const getPendingRequests = () => payments.filter((p) => p.status === \"Pending\")\n\n  const getHistory = () => payments.filter((p) => p.status !== \"Pending\")\n\n  const declinePayment = async (id: string, reason?: string) => {\n    try {\n      const token = getToken()\n      const res = await fetch(`/api/manager/payments/requests/${id}/status`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\", ...(token ? { Authorization: `Bearer ${token}` } : {}) },\n        body: JSON.stringify({ status: \"REJECTED\", reason }),\n      })\n      if (res.ok) await refresh()\n    } catch {}\n  }\n\n  return (\n    <PaymentContext.Provider\n      value={{\n        payments,\n        refresh,\n        getPaymentRequest,\n        getPendingRequests,\n        getHistory,\n        approvePayment,\n        declinePayment,\n      }}\n    >\n      {children}\n    </PaymentContext.Provider>\n  )\n}\n\nexport function usePayments() {\n  const ctx = useContext(PaymentContext)\n  if (!ctx) {\n    throw new Error(\"usePayments must be used within PaymentProvider\")\n  }\n  return ctx\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AAFA;;;AAeA,MAAM,+BAAiB,IAAA,sNAAa,EAAiC;AAE9D,SAAS,gBAAgB,EAAE,QAAQ,EAA2B;IACnE,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAmB,EAAE;IAE7D,MAAM,WAAW;QACf,wCAAmC,OAAO;;;IAQ5C;IAEA,MAAM,UAAU;QACd,IAAI;YACF,MAAM,QAAQ;YACd,MAAM,MAAM,MAAM,MAAM,kCAAkC;gBAAE,SAAS,QAAQ;oBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;gBAAC,IAAI,CAAC;YAAE;YACvH,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,QAAQ,MAAM,IAAI,IAAI;gBAC5B,IAAI,MAAM,OAAO,CAAC,QAAQ,YAAY;YACxC;QACF,EAAE,OAAM,CAAC;IACX;IAEA,IAAA,kNAAS,EAAC;QACR,KAAK;IACP,GAAG,EAAE;IAEL,MAAM,iBAAiB,OAAO,IAAY;QACxC,IAAI;YACF,MAAM,QAAQ;YACd,MAAM,MAAM,MAAM,MAAM,CAAC,+BAA+B,EAAE,GAAG,OAAO,CAAC,EAAE;gBACrE,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;oBAAoB,GAAI,QAAQ;wBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;oBAAC,IAAI,CAAC,CAAC;gBAAE;gBACtG,MAAM,KAAK,SAAS,CAAC;oBAAE,QAAQ;oBAAY;gBAAO;YACpD;YACA,IAAI,IAAI,EAAE,EAAE,MAAM;QACpB,EAAE,OAAM,CAAC;IACX;IAEA,MAAM,oBAAoB,CAAC,KAAe,SAAS,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAExE,MAAM,qBAAqB,IAAM,SAAS,MAAM,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK;IAErE,MAAM,aAAa,IAAM,SAAS,MAAM,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK;IAE7D,MAAM,iBAAiB,OAAO,IAAY;QACxC,IAAI;YACF,MAAM,QAAQ;YACd,MAAM,MAAM,MAAM,MAAM,CAAC,+BAA+B,EAAE,GAAG,OAAO,CAAC,EAAE;gBACrE,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;oBAAoB,GAAI,QAAQ;wBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;oBAAC,IAAI,CAAC,CAAC;gBAAE;gBACtG,MAAM,KAAK,SAAS,CAAC;oBAAE,QAAQ;oBAAY;gBAAO;YACpD;YACA,IAAI,IAAI,EAAE,EAAE,MAAM;QACpB,EAAE,OAAM,CAAC;IACX;IAEA,qBACE,8OAAC,eAAe,QAAQ;QACtB,OAAO;YACL;YACA;YACA;YACA;YACA;YACA;YACA;QACF;kBAEC;;;;;;AAGP;AAEO,SAAS;IACd,MAAM,MAAM,IAAA,mNAAU,EAAC;IACvB,IAAI,CAAC,KAAK;QACR,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}},
    {"offset": {"line": 1007, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/hooks/use-toast.ts"],"sourcesContent":["'use client'\n\n// Inspired by react-hot-toast library\nimport * as React from 'react'\n\nimport type { ToastActionElement, ToastProps } from '@/components/ui/toast'\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: 'ADD_TOAST',\n  UPDATE_TOAST: 'UPDATE_TOAST',\n  DISMISS_TOAST: 'DISMISS_TOAST',\n  REMOVE_TOAST: 'REMOVE_TOAST',\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType['ADD_TOAST']\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType['UPDATE_TOAST']\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType['DISMISS_TOAST']\n      toastId?: ToasterToast['id']\n    }\n  | {\n      type: ActionType['REMOVE_TOAST']\n      toastId?: ToasterToast['id']\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: 'REMOVE_TOAST',\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case 'ADD_TOAST':\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case 'UPDATE_TOAST':\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t,\n        ),\n      }\n\n    case 'DISMISS_TOAST': {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t,\n        ),\n      }\n    }\n    case 'REMOVE_TOAST':\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, 'id'>\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: 'UPDATE_TOAST',\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: 'DISMISS_TOAST', toastId: id })\n\n  dispatch({\n    type: 'ADD_TOAST',\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: 'DISMISS_TOAST', toastId }),\n  }\n}\n\nexport { useToast, toast }\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1164, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/lib/bid-context.tsx"],"sourcesContent":["\"use client\"\n\nimport { createContext, useContext, useEffect, useState, type ReactNode } from \"react\"\nimport { toast } from \"@/hooks/use-toast\"\nimport type { Bid } from \"@/lib/database-schema\"\nimport { useProjects } from \"@/lib/project-context\"\n\ninterface BidContextType {\n  bids: Bid[]\n  getBidsByProject: (projectId: string | number) => Bid[]\n  submitBid: (\n    projectId: string | number,\n    bid: Omit<Bid, \"id\" | \"projectId\" | \"status\" | \"submittedAt\">,\n  ) => Promise<{ ok: boolean; created?: Bid; error?: string }>\n  shortlistBid: (projectId: string | number, bidId: string) => Promise<void>\n  awardBid: (projectId: string | number, bidId: string) => Promise<void>\n  isLoaded?: boolean\n  getAllBids: () => Bid[]\n  getPendingBids: () => Bid[]\n  getBid: (id: string) => Bid | undefined\n  updateBid: (id: string, updates: Partial<Bid>) => Bid | undefined\n  updateBidStatus: (\n    id: string,\n    status: Bid[\"status\"],\n    reviewedBy: string,\n    reviewNotes?: string,\n  ) => Promise<{ ok: boolean; updated?: Bid; error?: string }>\n  deleteBid: (id: string) => void\n  logBidAction: (bidId: string, action: \"submitted\" | \"shortlisted\" | \"rejected\" | \"invited\" | \"awarded\", notes?: string) => void\n  getEventsByProject: (projectId: string | number) => BidEvent[]\n}\n\ntype BidEvent = {\n  id: string\n  bidId: string\n  projectId: string | number\n  action: \"submitted\" | \"shortlisted\" | \"rejected\" | \"invited\" | \"awarded\"\n  actorRole?: string\n  actorId?: string\n  timestamp: string\n  notes?: string\n}\n\nconst BidContext = createContext<BidContextType | undefined>(undefined)\n\nexport function BidProvider({ children }: { children: ReactNode }) {\n  const [bids, setBids] = useState<Bid[]>([])\n  const { setProjectStatus, incrementBidCount, projects, updateProject } = useProjects()\n  const [isLoaded, setIsLoaded] = useState(false)\n  const [events, setEvents] = useState<BidEvent[]>([])\n\n  useEffect(() => {\n    const load = async () => {\n      try {\n        const res = await fetch(\"/api/bids\")\n        if (res.ok) {\n          const items = await res.json()\n          if (Array.isArray(items)) setBids(items)\n        }\n      } catch {\n        try {\n          const saved = localStorage.getItem(\"bids\")\n          if (saved) {\n            const data = JSON.parse(saved)\n            if (Array.isArray(data)) setBids(data)\n          }\n        } catch {}\n        try {\n          const evSaved = localStorage.getItem(\"bid_events\")\n          if (evSaved) {\n            const ev = JSON.parse(evSaved)\n            if (Array.isArray(ev)) setEvents(ev)\n          }\n        } catch {}\n      } finally {\n        setIsLoaded(true)\n      }\n    }\n    void load()\n  }, [])\n\n  useEffect(() => {\n    try {\n      localStorage.setItem(\"bids\", JSON.stringify(bids))\n    } catch {}\n  }, [bids])\n\n  useEffect(() => {\n    try {\n      localStorage.setItem(\"bid_events\", JSON.stringify(events))\n    } catch {}\n  }, [events])\n\n  // Reconcile legacy bids whose projectId stored as project title instead of ID\n  useEffect(() => {\n    if (!isLoaded) return\n    setBids((prev) => {\n      let changed = false\n      const next = prev.map((b) => {\n        const byId = projects.find((p) => String(p.id) === String(b.projectId))\n        if (byId) return b\n        const key = String(b.projectId).toLowerCase()\n        const byTitle = projects.find((p) => p.title && p.title.toLowerCase() === key)\n        if (byTitle) {\n          changed = true\n          return { ...b, projectId: String(byTitle.id) }\n        }\n        return b\n      })\n      return changed ? next : prev\n    })\n  }, [isLoaded, projects])\n\n  const getBidsByProject = (projectId: string | number) => bids.filter((b) => String(b.projectId) === String(projectId))\n\n  const getEventsByProject = (projectId: string | number) =>\n    events\n      .filter((e) => String(e.projectId) === String(projectId))\n      .sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime())\n\n  const getAllBids = () => bids\n\n  const getPendingBids = () => bids.filter((b) => b.status === \"New\")\n\n  const getBid = (id: string) => bids.find((b) => b.id === id)\n\n  const updateBid = (id: string, updates: Partial<Bid>) => {\n    let updated: Bid | undefined\n    setBids((prev) =>\n      prev.map((b) => {\n        if (b.id === id) {\n          updated = { ...b, ...updates }\n          return updated\n        }\n        return b\n      }),\n    )\n    return updated\n  }\n\n  const updateBidStatus = async (\n    id: string,\n    status: Bid[\"status\"],\n    reviewedBy: string,\n    reviewNotes?: string,\n  ): Promise<{ ok: boolean; updated?: Bid; error?: string }> => {\n    const optimistic = () => {\n      const now = new Date()\n      const y = now.getFullYear()\n      const m = String(now.getMonth() + 1).padStart(2, \"0\")\n      const d = String(now.getDate()).padStart(2, \"0\")\n      const h = String(now.getHours()).padStart(2, \"0\")\n      const min = String(now.getMinutes()).padStart(2, \"0\")\n      const updated = updateBid(id, { status, reviewedAt: now.toISOString(), recordDate: `${y}-${m}-${d}`, recordTime: `${h}:${min}` } as any)\n      return updated\n    }\n    try {\n      const res = await fetch(`/api/bids/${id}/status`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ status }),\n      })\n      if (res.ok) {\n        const updated = await res.json()\n        setBids((prev) => {\n          let projectId: string | number | null = null\n          const next = prev.map((b) => {\n            if (b.id === id) { projectId = b.projectId; return updated }\n            if (status === \"Accepted\" && projectId !== null && String(b.projectId) === String(projectId)) {\n              return { ...b, status: \"Rejected\" as any }\n            }\n            return b\n          })\n          if (status === \"Accepted\" && projectId !== null) {\n            setProjectStatus(projectId, \"Active\")\n          }\n          return next\n        })\n        return { ok: true, updated }\n      }\n      const msg = await res.json().catch(() => ({}))\n      // Only fallback to local for \"Reviewed\" to avoid desync on decision errors\n      if (status === \"Reviewed\") {\n        const u = optimistic()\n        return { ok: false, updated: u, error: msg?.error || \"Failed to update status\" }\n      }\n      if (status === \"Accepted\") {\n        setProjectStatus(optimistic()?.projectId || id, \"Active\")\n      }\n      return { ok: false, error: msg?.error || \"Failed to update status\" }\n    } catch {\n      if (status === \"Reviewed\") {\n        const u = optimistic()\n        return { ok: false, updated: u, error: \"Network error\" }\n      }\n      if (status === \"Accepted\") {\n        setProjectStatus(optimistic()?.projectId || id, \"Active\")\n      }\n      return { ok: false, error: \"Network error\" }\n    }\n  }\n\n  const deleteBid = (id: string) => {\n    setBids((prev) => prev.filter((b) => b.id !== id))\n  }\n\n  const submitBid = async (\n    projectId: string | number,\n    bid: Omit<Bid, \"id\" | \"projectId\" | \"status\" | \"submittedAt\">,\n  ) => {\n    try {\n      const res = await fetch(`/api/projects/${projectId}/bids`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(bid),\n      })\n      if (res.ok) {\n        const created = await res.json()\n        setBids((prev) => [created, ...prev])\n        incrementBidCount(projectId, 1)\n        setEvents((prev) => [\n          { id: `evt-${Date.now()}`, bidId: created.id, projectId: created.projectId, action: \"submitted\", timestamp: new Date().toISOString() },\n          ...prev,\n        ])\n        try {\n          const p = projects.find((p) => String(p.id) === String(projectId))\n          toast({ title: \"New bid submitted\", description: `${created.companyName}  ${(p?.title || `Project ${projectId}`)}` })\n        } catch {}\n        return { ok: true, created }\n      }\n      const msg = await res.json().catch(() => ({}))\n      return { ok: false, error: msg?.error || \"Failed to submit bid\" }\n    } catch {}\n    return { ok: false, error: \"Network error\" }\n  }\n\n  const sendEmail = async (to: string, subject: string, html: string) => {\n    try {\n      await fetch(\"/api/email/send\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ to, subject, html }),\n      })\n    } catch {}\n  }\n\n  const formatNairaAmount = (value: any) => {\n    const num = Number(String(value).replace(/[^0-9.]/g, \"\")) || 0\n    try {\n      return new Intl.NumberFormat(\"en-NG\", { style: \"currency\", currency: \"NGN\", maximumFractionDigits: 0 }).format(num)\n    } catch {\n      return `${num.toLocaleString(\"en-NG\")}`\n    }\n  }\n\n  const shortlistBid = async (projectId: string | number, bidId: string) => {\n    const countShortlisted = bids.filter((b) => String(b.projectId) === String(projectId) && b.status === \"Reviewed\").length\n    if (countShortlisted >= 5) return\n    const existing = bids.find((b) => b.id === bidId)\n    if (existing && existing.status === \"Reviewed\") return\n    try {\n      const res = await fetch(`/api/bids/${bidId}/status`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ status: \"Reviewed\" }),\n      })\n      if (res.ok) {\n        const updated = await res.json()\n        setBids((prev) => prev.map((b) => (b.id === bidId ? updated : b)))\n      } else {\n        setBids((prev) =>\n          prev.map((b) => {\n            if (b.id === bidId) {\n              const now = new Date()\n              const y = now.getFullYear()\n              const m = String(now.getMonth() + 1).padStart(2, \"0\")\n              const d = String(now.getDate()).padStart(2, \"0\")\n              const h = String(now.getHours()).padStart(2, \"0\")\n              const min = String(now.getMinutes()).padStart(2, \"0\")\n              return { ...b, status: \"Reviewed\", reviewedAt: now.toISOString(), recordDate: `${y}-${m}-${d}`, recordTime: `${h}:${min}` }\n            }\n            return b\n          }),\n        )\n      }\n    } catch {\n      setBids((prev) =>\n        prev.map((b) => {\n          if (b.id === bidId) {\n            const now = new Date()\n            const y = now.getFullYear()\n            const m = String(now.getMonth() + 1).padStart(2, \"0\")\n            const d = String(now.getDate()).padStart(2, \"0\")\n            const h = String(now.getHours()).padStart(2, \"0\")\n            const min = String(now.getMinutes()).padStart(2, \"0\")\n            return { ...b, status: \"Reviewed\", reviewedAt: now.toISOString(), recordDate: `${y}-${m}-${d}`, recordTime: `${h}:${min}` }\n          }\n          return b\n        }),\n      )\n    }\n    setEvents((prev) => [\n      { id: `evt-${Date.now()}`, bidId, projectId, action: \"shortlisted\", timestamp: new Date().toISOString() },\n      ...prev,\n    ])\n    const bid = bids.find((b) => b.id === bidId)\n    if (bid) {\n      const interviewUrl = `/interview/${projectId}`\n      await sendEmail(\n        bid.email,\n        \"Interview Invitation\",\n        `<div><p>Dear ${bid.bidderName},</p><p>Your bid has been shortlisted for interview.</p><p>Join the interview: <a href=\"${interviewUrl}\">${interviewUrl}</a></p><p>Amount: ${formatNairaAmount(bid.amount)}</p><p>Duration: ${bid.duration} days</p></div>`,\n      )\n    }\n  }\n\n  const awardBid = async (projectId: string | number, bidId: string) => {\n    const getToken = () => {\n      if (typeof window === \"undefined\") return \"\"\n      return (\n        localStorage.getItem(\"token\") ||\n        localStorage.getItem(\"authToken\") ||\n        localStorage.getItem(\"auth_token\") ||\n        localStorage.getItem(\"managerToken\") ||\n        \"\"\n      )\n    }\n    const optimistic = () => {\n      const now = new Date()\n      const y = now.getFullYear()\n      const m = String(now.getMonth() + 1).padStart(2, \"0\")\n      const d = String(now.getDate()).padStart(2, \"0\")\n      const h = String(now.getHours()).padStart(2, \"0\")\n      const min = String(now.getMinutes()).padStart(2, \"0\")\n      setBids((prev) =>\n        prev.map((b) => {\n          if (b.id === bidId) return { ...b, status: \"Awarded\", reviewedAt: now.toISOString(), recordDate: `${y}-${m}-${d}`, recordTime: `${h}:${min}` }\n          return String(b.projectId) === String(projectId) ? { ...b, status: \"Rejected\", reviewedAt: now.toISOString(), recordDate: `${y}-${m}-${d}`, recordTime: `${h}:${min}` } : b\n        }),\n      )\n      setProjectStatus(projectId, \"Awarded\")\n    }\n    try {\n      const res = await fetch(`/api/bids/${bidId}/award`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\", Authorization: `Bearer ${getToken()}` },\n        body: JSON.stringify({ ownerName: \"Manager\" }),\n      })\n      if (res.ok) {\n        const data = await res.json()\n        const contractSent = Boolean(data?.contractSent)\n        const contractSentAt = String(data?.contractSentAt || \"\")\n        setBids((prev) => prev.map((b) => (b.id === bidId ? { ...b, status: \"Awarded\", contractSent, contractSentAt } : String(b.projectId) === String(projectId) ? { ...b, status: \"Rejected\" } : b)))\n        setProjectStatus(projectId, \"Awarded\")\n        try {\n          const target = bids.find((b) => b.id === bidId)\n          updateProject(projectId, { acceptedBidDays: Number(target?.duration || 0) || undefined })\n        } catch {}\n      } else {\n        optimistic()\n      }\n    } catch {\n      optimistic()\n    }\n    setEvents((prev) => [\n      { id: `evt-${Date.now()}`, bidId, projectId, action: \"awarded\", timestamp: new Date().toISOString() },\n      ...prev,\n    ])\n  }\n\n  const logBidAction = (bidId: string, action: \"submitted\" | \"shortlisted\" | \"rejected\" | \"invited\" | \"awarded\", notes?: string) => {\n    const bid = bids.find((b) => b.id === bidId)\n    const projectId = bid?.projectId || \"\"\n    setEvents((prev) => [\n      { id: `evt-${Date.now()}`, bidId, projectId, action, timestamp: new Date().toISOString(), notes },\n      ...prev,\n    ])\n  }\n\n  return (\n    <BidContext.Provider\n      value={{\n        bids,\n        getBidsByProject,\n        submitBid,\n        shortlistBid,\n        awardBid,\n        isLoaded,\n        getAllBids,\n        getPendingBids,\n        getBid,\n        updateBid,\n        updateBidStatus,\n        deleteBid,\n        logBidAction,\n        getEventsByProject,\n      }}\n    >\n      {children}\n    </BidContext.Provider>\n  )\n}\n\nexport function useBids() {\n  const context = useContext(BidContext)\n  if (!context) {\n    throw new Error(\"useBids must be used within BidProvider\")\n  }\n  return context\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAEA;AALA;;;;;AA2CA,MAAM,2BAAa,IAAA,sNAAa,EAA6B;AAEtD,SAAS,YAAY,EAAE,QAAQ,EAA2B;IAC/D,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAQ,EAAE;IAC1C,MAAM,EAAE,gBAAgB,EAAE,iBAAiB,EAAE,QAAQ,EAAE,aAAa,EAAE,GAAG,IAAA,yIAAW;IACpF,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IACzC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAa,EAAE;IAEnD,IAAA,kNAAS,EAAC;QACR,MAAM,OAAO;YACX,IAAI;gBACF,MAAM,MAAM,MAAM,MAAM;gBACxB,IAAI,IAAI,EAAE,EAAE;oBACV,MAAM,QAAQ,MAAM,IAAI,IAAI;oBAC5B,IAAI,MAAM,OAAO,CAAC,QAAQ,QAAQ;gBACpC;YACF,EAAE,OAAM;gBACN,IAAI;oBACF,MAAM,QAAQ,aAAa,OAAO,CAAC;oBACnC,IAAI,OAAO;wBACT,MAAM,OAAO,KAAK,KAAK,CAAC;wBACxB,IAAI,MAAM,OAAO,CAAC,OAAO,QAAQ;oBACnC;gBACF,EAAE,OAAM,CAAC;gBACT,IAAI;oBACF,MAAM,UAAU,aAAa,OAAO,CAAC;oBACrC,IAAI,SAAS;wBACX,MAAM,KAAK,KAAK,KAAK,CAAC;wBACtB,IAAI,MAAM,OAAO,CAAC,KAAK,UAAU;oBACnC;gBACF,EAAE,OAAM,CAAC;YACX,SAAU;gBACR,YAAY;YACd;QACF;QACA,KAAK;IACP,GAAG,EAAE;IAEL,IAAA,kNAAS,EAAC;QACR,IAAI;YACF,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;QAC9C,EAAE,OAAM,CAAC;IACX,GAAG;QAAC;KAAK;IAET,IAAA,kNAAS,EAAC;QACR,IAAI;YACF,aAAa,OAAO,CAAC,cAAc,KAAK,SAAS,CAAC;QACpD,EAAE,OAAM,CAAC;IACX,GAAG;QAAC;KAAO;IAEX,8EAA8E;IAC9E,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,UAAU;QACf,QAAQ,CAAC;YACP,IAAI,UAAU;YACd,MAAM,OAAO,KAAK,GAAG,CAAC,CAAC;gBACrB,MAAM,OAAO,SAAS,IAAI,CAAC,CAAC,IAAM,OAAO,EAAE,EAAE,MAAM,OAAO,EAAE,SAAS;gBACrE,IAAI,MAAM,OAAO;gBACjB,MAAM,MAAM,OAAO,EAAE,SAAS,EAAE,WAAW;gBAC3C,MAAM,UAAU,SAAS,IAAI,CAAC,CAAC,IAAM,EAAE,KAAK,IAAI,EAAE,KAAK,CAAC,WAAW,OAAO;gBAC1E,IAAI,SAAS;oBACX,UAAU;oBACV,OAAO;wBAAE,GAAG,CAAC;wBAAE,WAAW,OAAO,QAAQ,EAAE;oBAAE;gBAC/C;gBACA,OAAO;YACT;YACA,OAAO,UAAU,OAAO;QAC1B;IACF,GAAG;QAAC;QAAU;KAAS;IAEvB,MAAM,mBAAmB,CAAC,YAA+B,KAAK,MAAM,CAAC,CAAC,IAAM,OAAO,EAAE,SAAS,MAAM,OAAO;IAE3G,MAAM,qBAAqB,CAAC,YAC1B,OACG,MAAM,CAAC,CAAC,IAAM,OAAO,EAAE,SAAS,MAAM,OAAO,YAC7C,IAAI,CAAC,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO,KAAK,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO;IAEnF,MAAM,aAAa,IAAM;IAEzB,MAAM,iBAAiB,IAAM,KAAK,MAAM,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK;IAE7D,MAAM,SAAS,CAAC,KAAe,KAAK,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAEzD,MAAM,YAAY,CAAC,IAAY;QAC7B,IAAI;QACJ,QAAQ,CAAC,OACP,KAAK,GAAG,CAAC,CAAC;gBACR,IAAI,EAAE,EAAE,KAAK,IAAI;oBACf,UAAU;wBAAE,GAAG,CAAC;wBAAE,GAAG,OAAO;oBAAC;oBAC7B,OAAO;gBACT;gBACA,OAAO;YACT;QAEF,OAAO;IACT;IAEA,MAAM,kBAAkB,OACtB,IACA,QACA,YACA;QAEA,MAAM,aAAa;YACjB,MAAM,MAAM,IAAI;YAChB,MAAM,IAAI,IAAI,WAAW;YACzB,MAAM,IAAI,OAAO,IAAI,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG;YACjD,MAAM,IAAI,OAAO,IAAI,OAAO,IAAI,QAAQ,CAAC,GAAG;YAC5C,MAAM,IAAI,OAAO,IAAI,QAAQ,IAAI,QAAQ,CAAC,GAAG;YAC7C,MAAM,MAAM,OAAO,IAAI,UAAU,IAAI,QAAQ,CAAC,GAAG;YACjD,MAAM,UAAU,UAAU,IAAI;gBAAE;gBAAQ,YAAY,IAAI,WAAW;gBAAI,YAAY,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,GAAG;gBAAE,YAAY,GAAG,EAAE,CAAC,EAAE,KAAK;YAAC;YAC/H,OAAO;QACT;QACA,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,UAAU,EAAE,GAAG,OAAO,CAAC,EAAE;gBAChD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;gBAAO;YAChC;YACA,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,UAAU,MAAM,IAAI,IAAI;gBAC9B,QAAQ,CAAC;oBACP,IAAI,YAAoC;oBACxC,MAAM,OAAO,KAAK,GAAG,CAAC,CAAC;wBACrB,IAAI,EAAE,EAAE,KAAK,IAAI;4BAAE,YAAY,EAAE,SAAS;4BAAE,OAAO;wBAAQ;wBAC3D,IAAI,WAAW,cAAc,cAAc,QAAQ,OAAO,EAAE,SAAS,MAAM,OAAO,YAAY;4BAC5F,OAAO;gCAAE,GAAG,CAAC;gCAAE,QAAQ;4BAAkB;wBAC3C;wBACA,OAAO;oBACT;oBACA,IAAI,WAAW,cAAc,cAAc,MAAM;wBAC/C,iBAAiB,WAAW;oBAC9B;oBACA,OAAO;gBACT;gBACA,OAAO;oBAAE,IAAI;oBAAM;gBAAQ;YAC7B;YACA,MAAM,MAAM,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAC5C,2EAA2E;YAC3E,IAAI,WAAW,YAAY;gBACzB,MAAM,IAAI;gBACV,OAAO;oBAAE,IAAI;oBAAO,SAAS;oBAAG,OAAO,KAAK,SAAS;gBAA0B;YACjF;YACA,IAAI,WAAW,YAAY;gBACzB,iBAAiB,cAAc,aAAa,IAAI;YAClD;YACA,OAAO;gBAAE,IAAI;gBAAO,OAAO,KAAK,SAAS;YAA0B;QACrE,EAAE,OAAM;YACN,IAAI,WAAW,YAAY;gBACzB,MAAM,IAAI;gBACV,OAAO;oBAAE,IAAI;oBAAO,SAAS;oBAAG,OAAO;gBAAgB;YACzD;YACA,IAAI,WAAW,YAAY;gBACzB,iBAAiB,cAAc,aAAa,IAAI;YAClD;YACA,OAAO;gBAAE,IAAI;gBAAO,OAAO;YAAgB;QAC7C;IACF;IAEA,MAAM,YAAY,CAAC;QACjB,QAAQ,CAAC,OAAS,KAAK,MAAM,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAChD;IAEA,MAAM,YAAY,OAChB,WACA;QAEA,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,cAAc,EAAE,UAAU,KAAK,CAAC,EAAE;gBACzD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;YACvB;YACA,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,UAAU,MAAM,IAAI,IAAI;gBAC9B,QAAQ,CAAC,OAAS;wBAAC;2BAAY;qBAAK;gBACpC,kBAAkB,WAAW;gBAC7B,UAAU,CAAC,OAAS;wBAClB;4BAAE,IAAI,CAAC,IAAI,EAAE,KAAK,GAAG,IAAI;4BAAE,OAAO,QAAQ,EAAE;4BAAE,WAAW,QAAQ,SAAS;4BAAE,QAAQ;4BAAa,WAAW,IAAI,OAAO,WAAW;wBAAG;2BAClI;qBACJ;gBACD,IAAI;oBACF,MAAM,IAAI,SAAS,IAAI,CAAC,CAAC,IAAM,OAAO,EAAE,EAAE,MAAM,OAAO;oBACvD,IAAA,8HAAK,EAAC;wBAAE,OAAO;wBAAqB,aAAa,GAAG,QAAQ,WAAW,CAAC,GAAG,EAAG,GAAG,SAAS,CAAC,QAAQ,EAAE,WAAW,EAAG;oBAAC;gBACtH,EAAE,OAAM,CAAC;gBACT,OAAO;oBAAE,IAAI;oBAAM;gBAAQ;YAC7B;YACA,MAAM,MAAM,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAC5C,OAAO;gBAAE,IAAI;gBAAO,OAAO,KAAK,SAAS;YAAuB;QAClE,EAAE,OAAM,CAAC;QACT,OAAO;YAAE,IAAI;YAAO,OAAO;QAAgB;IAC7C;IAEA,MAAM,YAAY,OAAO,IAAY,SAAiB;QACpD,IAAI;YACF,MAAM,MAAM,mBAAmB;gBAC7B,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAI;oBAAS;gBAAK;YAC3C;QACF,EAAE,OAAM,CAAC;IACX;IAEA,MAAM,oBAAoB,CAAC;QACzB,MAAM,MAAM,OAAO,OAAO,OAAO,OAAO,CAAC,YAAY,QAAQ;QAC7D,IAAI;YACF,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;gBAAE,OAAO;gBAAY,UAAU;gBAAO,uBAAuB;YAAE,GAAG,MAAM,CAAC;QACjH,EAAE,OAAM;YACN,OAAO,CAAC,CAAC,EAAE,IAAI,cAAc,CAAC,UAAU;QAC1C;IACF;IAEA,MAAM,eAAe,OAAO,WAA4B;QACtD,MAAM,mBAAmB,KAAK,MAAM,CAAC,CAAC,IAAM,OAAO,EAAE,SAAS,MAAM,OAAO,cAAc,EAAE,MAAM,KAAK,YAAY,MAAM;QACxH,IAAI,oBAAoB,GAAG;QAC3B,MAAM,WAAW,KAAK,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;QAC3C,IAAI,YAAY,SAAS,MAAM,KAAK,YAAY;QAChD,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,UAAU,EAAE,MAAM,OAAO,CAAC,EAAE;gBACnD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,QAAQ;gBAAW;YAC5C;YACA,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,UAAU,MAAM,IAAI,IAAI;gBAC9B,QAAQ,CAAC,OAAS,KAAK,GAAG,CAAC,CAAC,IAAO,EAAE,EAAE,KAAK,QAAQ,UAAU;YAChE,OAAO;gBACL,QAAQ,CAAC,OACP,KAAK,GAAG,CAAC,CAAC;wBACR,IAAI,EAAE,EAAE,KAAK,OAAO;4BAClB,MAAM,MAAM,IAAI;4BAChB,MAAM,IAAI,IAAI,WAAW;4BACzB,MAAM,IAAI,OAAO,IAAI,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG;4BACjD,MAAM,IAAI,OAAO,IAAI,OAAO,IAAI,QAAQ,CAAC,GAAG;4BAC5C,MAAM,IAAI,OAAO,IAAI,QAAQ,IAAI,QAAQ,CAAC,GAAG;4BAC7C,MAAM,MAAM,OAAO,IAAI,UAAU,IAAI,QAAQ,CAAC,GAAG;4BACjD,OAAO;gCAAE,GAAG,CAAC;gCAAE,QAAQ;gCAAY,YAAY,IAAI,WAAW;gCAAI,YAAY,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,GAAG;gCAAE,YAAY,GAAG,EAAE,CAAC,EAAE,KAAK;4BAAC;wBAC5H;wBACA,OAAO;oBACT;YAEJ;QACF,EAAE,OAAM;YACN,QAAQ,CAAC,OACP,KAAK,GAAG,CAAC,CAAC;oBACR,IAAI,EAAE,EAAE,KAAK,OAAO;wBAClB,MAAM,MAAM,IAAI;wBAChB,MAAM,IAAI,IAAI,WAAW;wBACzB,MAAM,IAAI,OAAO,IAAI,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG;wBACjD,MAAM,IAAI,OAAO,IAAI,OAAO,IAAI,QAAQ,CAAC,GAAG;wBAC5C,MAAM,IAAI,OAAO,IAAI,QAAQ,IAAI,QAAQ,CAAC,GAAG;wBAC7C,MAAM,MAAM,OAAO,IAAI,UAAU,IAAI,QAAQ,CAAC,GAAG;wBACjD,OAAO;4BAAE,GAAG,CAAC;4BAAE,QAAQ;4BAAY,YAAY,IAAI,WAAW;4BAAI,YAAY,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,GAAG;4BAAE,YAAY,GAAG,EAAE,CAAC,EAAE,KAAK;wBAAC;oBAC5H;oBACA,OAAO;gBACT;QAEJ;QACA,UAAU,CAAC,OAAS;gBAClB;oBAAE,IAAI,CAAC,IAAI,EAAE,KAAK,GAAG,IAAI;oBAAE;oBAAO;oBAAW,QAAQ;oBAAe,WAAW,IAAI,OAAO,WAAW;gBAAG;mBACrG;aACJ;QACD,MAAM,MAAM,KAAK,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;QACtC,IAAI,KAAK;YACP,MAAM,eAAe,CAAC,WAAW,EAAE,WAAW;YAC9C,MAAM,UACJ,IAAI,KAAK,EACT,wBACA,CAAC,aAAa,EAAE,IAAI,UAAU,CAAC,wFAAwF,EAAE,aAAa,EAAE,EAAE,aAAa,mBAAmB,EAAE,kBAAkB,IAAI,MAAM,EAAE,iBAAiB,EAAE,IAAI,QAAQ,CAAC,eAAe,CAAC;QAE9P;IACF;IAEA,MAAM,WAAW,OAAO,WAA4B;QAClD,MAAM,WAAW;YACf,wCAAmC,OAAO;;;QAQ5C;QACA,MAAM,aAAa;YACjB,MAAM,MAAM,IAAI;YAChB,MAAM,IAAI,IAAI,WAAW;YACzB,MAAM,IAAI,OAAO,IAAI,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG;YACjD,MAAM,IAAI,OAAO,IAAI,OAAO,IAAI,QAAQ,CAAC,GAAG;YAC5C,MAAM,IAAI,OAAO,IAAI,QAAQ,IAAI,QAAQ,CAAC,GAAG;YAC7C,MAAM,MAAM,OAAO,IAAI,UAAU,IAAI,QAAQ,CAAC,GAAG;YACjD,QAAQ,CAAC,OACP,KAAK,GAAG,CAAC,CAAC;oBACR,IAAI,EAAE,EAAE,KAAK,OAAO,OAAO;wBAAE,GAAG,CAAC;wBAAE,QAAQ;wBAAW,YAAY,IAAI,WAAW;wBAAI,YAAY,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,GAAG;wBAAE,YAAY,GAAG,EAAE,CAAC,EAAE,KAAK;oBAAC;oBAC7I,OAAO,OAAO,EAAE,SAAS,MAAM,OAAO,aAAa;wBAAE,GAAG,CAAC;wBAAE,QAAQ;wBAAY,YAAY,IAAI,WAAW;wBAAI,YAAY,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,GAAG;wBAAE,YAAY,GAAG,EAAE,CAAC,EAAE,KAAK;oBAAC,IAAI;gBAC5K;YAEF,iBAAiB,WAAW;QAC9B;QACA,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,UAAU,EAAE,MAAM,MAAM,CAAC,EAAE;gBAClD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;oBAAoB,eAAe,CAAC,OAAO,EAAE,YAAY;gBAAC;gBACrF,MAAM,KAAK,SAAS,CAAC;oBAAE,WAAW;gBAAU;YAC9C;YACA,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,MAAM,eAAe,QAAQ,MAAM;gBACnC,MAAM,iBAAiB,OAAO,MAAM,kBAAkB;gBACtD,QAAQ,CAAC,OAAS,KAAK,GAAG,CAAC,CAAC,IAAO,EAAE,EAAE,KAAK,QAAQ;4BAAE,GAAG,CAAC;4BAAE,QAAQ;4BAAW;4BAAc;wBAAe,IAAI,OAAO,EAAE,SAAS,MAAM,OAAO,aAAa;4BAAE,GAAG,CAAC;4BAAE,QAAQ;wBAAW,IAAI;gBAC3L,iBAAiB,WAAW;gBAC5B,IAAI;oBACF,MAAM,SAAS,KAAK,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;oBACzC,cAAc,WAAW;wBAAE,iBAAiB,OAAO,QAAQ,YAAY,MAAM;oBAAU;gBACzF,EAAE,OAAM,CAAC;YACX,OAAO;gBACL;YACF;QACF,EAAE,OAAM;YACN;QACF;QACA,UAAU,CAAC,OAAS;gBAClB;oBAAE,IAAI,CAAC,IAAI,EAAE,KAAK,GAAG,IAAI;oBAAE;oBAAO;oBAAW,QAAQ;oBAAW,WAAW,IAAI,OAAO,WAAW;gBAAG;mBACjG;aACJ;IACH;IAEA,MAAM,eAAe,CAAC,OAAe,QAA0E;QAC7G,MAAM,MAAM,KAAK,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;QACtC,MAAM,YAAY,KAAK,aAAa;QACpC,UAAU,CAAC,OAAS;gBAClB;oBAAE,IAAI,CAAC,IAAI,EAAE,KAAK,GAAG,IAAI;oBAAE;oBAAO;oBAAW;oBAAQ,WAAW,IAAI,OAAO,WAAW;oBAAI;gBAAM;mBAC7F;aACJ;IACH;IAEA,qBACE,8OAAC,WAAW,QAAQ;QAClB,OAAO;YACL;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;QACF;kBAEC;;;;;;AAGP;AAEO,SAAS;IACd,MAAM,UAAU,IAAA,mNAAU,EAAC;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}},
    {"offset": {"line": 1642, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB"}},
    {"offset": {"line": 1657, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/components/ui/toast.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as ToastPrimitives from '@radix-ui/react-toast'\nimport { cva, type VariantProps } from 'class-variance-authority'\nimport { X } from 'lucide-react'\n\nimport { cn } from '@/lib/utils'\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      'fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]',\n      className,\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  'group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full',\n  {\n    variants: {\n      variant: {\n        default: 'border bg-background text-foreground',\n        destructive:\n          'destructive group border-destructive bg-destructive text-destructive-foreground',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n    },\n  },\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      'inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive',\n      className,\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      'absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600',\n      className,\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn('text-sm font-semibold', className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn('text-sm opacity-90', className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AAEA;AAPA;;;;;;;AASA,MAAM,gBAAgB,6KAAwB;AAE9C,MAAM,8BAAgB,mNAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,6KAAwB;QACvB,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,qIACA;QAED,GAAG,KAAK;;;;;;AAGb,cAAc,WAAW,GAAG,6KAAwB,CAAC,WAAW;AAEhE,MAAM,gBAAgB,IAAA,uKAAG,EACvB,6lBACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,MAAM,sBAAQ,mNAAgB,CAI5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE;IACnC,qBACE,8OAAC,yKAAoB;QACnB,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;AACA,MAAM,WAAW,GAAG,yKAAoB,CAAC,WAAW;AAEpD,MAAM,4BAAc,mNAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,2KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,sgBACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,2KAAsB,CAAC,WAAW;AAE5D,MAAM,2BAAa,mNAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,0KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,yVACA;QAEF,eAAY;QACX,GAAG,KAAK;kBAET,cAAA,8OAAC,iMAAC;YAAC,WAAU;;;;;;;;;;;AAGjB,WAAW,WAAW,GAAG,0KAAqB,CAAC,WAAW;AAE1D,MAAM,2BAAa,mNAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,0KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,yBAAyB;QACtC,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG,0KAAqB,CAAC,WAAW;AAE1D,MAAM,iCAAmB,mNAAgB,CAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,gLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,sBAAsB;QACnC,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG,gLAA2B,CAAC,WAAW"}},
    {"offset": {"line": 1775, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/components/ui/toaster.tsx"],"sourcesContent":["'use client'\n\nimport { useToast } from '@/hooks/use-toast'\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from '@/components/ui/toast'\nimport { useEffect } from 'react'\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  useEffect(() => {\n    try {\n      const params = new URLSearchParams(window.location.search)\n      const shouldClear = params.get('clear') === '1'\n      if (!shouldClear) return\n      try { localStorage.clear() } catch {}\n      try { sessionStorage.clear() } catch {}\n      try {\n        if ('caches' in window) {\n          caches.keys().then((keys) => keys.forEach((k) => caches.delete(k))).catch(() => {})\n        }\n      } catch {}\n      const url = new URL(window.location.href)\n      url.searchParams.delete('clear')\n      history.replaceState(null, '', url.toString())\n      window.location.reload()\n    } catch {}\n  }, [])\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAQA;AAXA;;;;;AAaO,SAAS;IACd,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,iIAAQ;IAE3B,IAAA,kNAAS,EAAC;QACR,IAAI;YACF,MAAM,SAAS,IAAI,gBAAgB,OAAO,QAAQ,CAAC,MAAM;YACzD,MAAM,cAAc,OAAO,GAAG,CAAC,aAAa;YAC5C,IAAI,CAAC,aAAa;YAClB,IAAI;gBAAE,aAAa,KAAK;YAAG,EAAE,OAAM,CAAC;YACpC,IAAI;gBAAE,eAAe,KAAK;YAAG,EAAE,OAAM,CAAC;YACtC,IAAI;gBACF,IAAI,YAAY,QAAQ;oBACtB,OAAO,IAAI,GAAG,IAAI,CAAC,CAAC,OAAS,KAAK,OAAO,CAAC,CAAC,IAAM,OAAO,MAAM,CAAC,KAAK,KAAK,CAAC,KAAO;gBACnF;YACF,EAAE,OAAM,CAAC;YACT,MAAM,MAAM,IAAI,IAAI,OAAO,QAAQ,CAAC,IAAI;YACxC,IAAI,YAAY,CAAC,MAAM,CAAC;YACxB,QAAQ,YAAY,CAAC,MAAM,IAAI,IAAI,QAAQ;YAC3C,OAAO,QAAQ,CAAC,MAAM;QACxB,EAAE,OAAM,CAAC;IACX,GAAG,EAAE;IAEL,qBACE,8OAAC,2IAAa;;YACX,OAAO,GAAG,CAAC,SAAU,EAAE,EAAE,EAAE,KAAK,EAAE,WAAW,EAAE,MAAM,EAAE,GAAG,OAAO;gBAChE,qBACE,8OAAC,mIAAK;oBAAW,GAAG,KAAK;;sCACvB,8OAAC;4BAAI,WAAU;;gCACZ,uBAAS,8OAAC,wIAAU;8CAAE;;;;;;gCACtB,6BACC,8OAAC,8IAAgB;8CAAE;;;;;;;;;;;;wBAGtB;sCACD,8OAAC,wIAAU;;;;;;mBARD;;;;;YAWhB;0BACA,8OAAC,2IAAa;;;;;;;;;;;AAGpB"}}]
}