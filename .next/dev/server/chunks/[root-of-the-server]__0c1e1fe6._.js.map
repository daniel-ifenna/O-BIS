{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/app/api/reports/generate/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\n\nexport async function POST(request: Request) {\n  try {\n    const body = await request.json()\n    const type = body.type || \"financial-summary\"\n    if (type === \"financial-summary\") {\n      const summary = body.summary || {}\n      const transactions: any[] = Array.isArray(body.transactions) ? body.transactions : []\n      const paymentRequests: any[] = Array.isArray(body.paymentRequests) ? body.paymentRequests : []\n\n      const summaryRows = Object.entries(summary).map(([k, v]) => `${k},${v}`)\n      const transactionHeaders = [\"Date\", \"Type\", \"Project\", \"Amount\", \"Description\"]\n      const transactionRows = transactions.map((tx) => [tx.date, tx.type, tx.projectId, tx.amount, tx.description].join(\",\"))\n      const paymentHeaders = [\"Date\", \"Requester\", \"Type\", \"Amount\", \"Status\"]\n      const paymentRows = paymentRequests.map((pr) => [pr.requestedAt, pr.requesterName, pr.type, pr.amount, pr.status].join(\",\"))\n\n      const csv = [\n        ...summaryRows,\n        \"\",\n        \"\",\n        \"Transaction History\",\n        transactionHeaders.join(\",\"),\n        ...transactionRows,\n        \"\",\n        \"\",\n        \"Payment Requests\",\n        paymentHeaders.join(\",\"),\n        ...paymentRows,\n      ].join(\"\\n\")\n\n      return new NextResponse(csv, { headers: { \"Content-Type\": \"text/csv; charset=utf-8\" } })\n    }\n    return NextResponse.json({ error: \"Unsupported report type\" }, { status: 400 })\n  } catch (e) {\n    return NextResponse.json({ error: \"Failed to generate report\" }, { status: 500 })\n  }\n}\n\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,OAAO,KAAK,IAAI,IAAI;QAC1B,IAAI,SAAS,qBAAqB;YAChC,MAAM,UAAU,KAAK,OAAO,IAAI,CAAC;YACjC,MAAM,eAAsB,MAAM,OAAO,CAAC,KAAK,YAAY,IAAI,KAAK,YAAY,GAAG,EAAE;YACrF,MAAM,kBAAyB,MAAM,OAAO,CAAC,KAAK,eAAe,IAAI,KAAK,eAAe,GAAG,EAAE;YAE9F,MAAM,cAAc,OAAO,OAAO,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,GAAK,GAAG,EAAE,CAAC,EAAE,GAAG;YACvE,MAAM,qBAAqB;gBAAC;gBAAQ;gBAAQ;gBAAW;gBAAU;aAAc;YAC/E,MAAM,kBAAkB,aAAa,GAAG,CAAC,CAAC,KAAO;oBAAC,GAAG,IAAI;oBAAE,GAAG,IAAI;oBAAE,GAAG,SAAS;oBAAE,GAAG,MAAM;oBAAE,GAAG,WAAW;iBAAC,CAAC,IAAI,CAAC;YAClH,MAAM,iBAAiB;gBAAC;gBAAQ;gBAAa;gBAAQ;gBAAU;aAAS;YACxE,MAAM,cAAc,gBAAgB,GAAG,CAAC,CAAC,KAAO;oBAAC,GAAG,WAAW;oBAAE,GAAG,aAAa;oBAAE,GAAG,IAAI;oBAAE,GAAG,MAAM;oBAAE,GAAG,MAAM;iBAAC,CAAC,IAAI,CAAC;YAEvH,MAAM,MAAM;mBACP;gBACH;gBACA;gBACA;gBACA,mBAAmB,IAAI,CAAC;mBACrB;gBACH;gBACA;gBACA;gBACA,eAAe,IAAI,CAAC;mBACjB;aACJ,CAAC,IAAI,CAAC;YAEP,OAAO,IAAI,gJAAY,CAAC,KAAK;gBAAE,SAAS;oBAAE,gBAAgB;gBAA0B;YAAE;QACxF;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA0B,GAAG;YAAE,QAAQ;QAAI;IAC/E,EAAE,OAAO,GAAG;QACV,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA4B,GAAG;YAAE,QAAQ;QAAI;IACjF;AACF"}}]
}