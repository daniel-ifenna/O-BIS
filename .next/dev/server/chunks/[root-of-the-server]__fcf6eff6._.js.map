{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/lib/db.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\"\n\nconst globalForPrisma = globalThis as unknown as { prisma?: PrismaClient }\n\nconst dbUrl = process.env.DATABASE_URL_PGBOUNCER || process.env.DATABASE_URL || \"\"\n\nfunction createPrismaOrMock(): PrismaClient | any {\n  if (dbUrl) {\n    return new PrismaClient({\n      datasources: {\n        db: { url: dbUrl },\n      },\n    })\n  }\n  const warn = (op: string) => {\n    throw new Error(`Database unavailable: set DATABASE_URL before calling ${op}`)\n  }\n  return new Proxy(\n    {},\n    {\n      get(_, prop) {\n        if (prop === \"$use\") return () => {}\n        if (prop === \"$transaction\") return () => warn(\"$transaction\")\n        return () => warn(String(prop))\n      },\n    },\n  ) as PrismaClient\n}\n\nexport const prisma = globalForPrisma.prisma || createPrismaOrMock()\n\nif (!globalForPrisma.prisma) globalForPrisma.prisma = prisma\n\nfunction fmtDate(d: Date): string {\n  const y = d.getFullYear()\n  const m = String(d.getMonth() + 1).padStart(2, \"0\")\n  const day = String(d.getDate()).padStart(2, \"0\")\n  return `${y}-${m}-${day}`\n}\n\nfunction fmtTime(d: Date): string {\n  const h = String(d.getHours()).padStart(2, \"0\")\n  const min = String(d.getMinutes()).padStart(2, \"0\")\n  return `${h}:${min}`\n}\n\nconst TARGET_MODELS = new Set([\n  \"User\",\n  \"Contractor\",\n  \"Vendor\",\n  \"Manager\",\n  \"Project\",\n  \"Bid\",\n  \"BidInvitation\",\n  \"ProcurementRequest\",\n  \"EscrowWalletTransaction\",\n  \"FileStorageRecord\",\n  \"PaymentRequest\",\n  \"Milestone\",\n  \"DailyReport\",\n  \"VendorQuote\",\n])\n\nif (typeof (prisma as any).$use === \"function\") (prisma as any).$use(async (params: any, next: any) => {\n  const now = new Date()\n  const date = fmtDate(now)\n  const time = fmtTime(now)\n  const modelMatches = TARGET_MODELS.has(params.model || \"\")\n  const preventDeletes = String(process.env.ALLOW_DELETE || \"\").toLowerCase() !== \"true\"\n  if (preventDeletes && (params.action === \"delete\" || params.action === \"deleteMany\")) {\n    throw new Error(\"Delete operations are disabled\")\n  }\n\n  if (modelMatches) {\n    if (params.action === \"create\") {\n      params.args.data = { ...(params.args.data || {}), recordDate: date, recordTime: time }\n    } else if (params.action === \"createMany\") {\n      const data = params.args.data\n      if (Array.isArray(data)) {\n        params.args.data = data.map((item: any) => ({ ...(item || {}), recordDate: date, recordTime: time }))\n      } else {\n        params.args.data = { ...(data || {}), recordDate: date, recordTime: time }\n      }\n    } else if (params.action === \"update\" || params.action === \"upsert\") {\n      params.args.data = { ...(params.args.data || {}), recordDate: date, recordTime: time }\n    } else if (params.action === \"updateMany\") {\n      const data = params.args.data\n      params.args.data = { ...(data || {}), recordDate: date, recordTime: time }\n    }\n  }\n\n  return next(params)\n})\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/lib/auth/jwt.ts"],"sourcesContent":["import jwt from \"jsonwebtoken\"\n\ntype Payload = { sub: string; role: \"manager\" | \"contractor\" | \"vendor\" }\n\nexport function signToken(payload: Payload, expiresIn: string = process.env.JWT_EXPIRES_IN || \"1h\") {\n  const secret = process.env.JWT_SECRET || \"\"\n  if (!secret) throw new Error(\"Missing JWT_SECRET\")\n  return jwt.sign(payload, secret as jwt.Secret, { algorithm: \"HS256\", expiresIn } as jwt.SignOptions)\n}\n\nexport function verifyToken(token: string): Payload | null {\n  const secret = process.env.JWT_SECRET || \"\"\n  if (!secret) throw new Error(\"Missing JWT_SECRET\")\n  try {\n    return jwt.verify(token, secret) as Payload\n  } catch {\n    return null\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAIO,SAAS,UAAU,OAAgB,EAAE,YAAoB,QAAQ,GAAG,CAAC,cAAc,IAAI,IAAI;IAChG,MAAM,SAAS,QAAQ,GAAG,CAAC,UAAU,IAAI;IACzC,IAAI,CAAC,QAAQ,MAAM,IAAI,MAAM;IAC7B,OAAO,kJAAG,CAAC,IAAI,CAAC,SAAS,QAAsB;QAAE,WAAW;QAAS;IAAU;AACjF;AAEO,SAAS,YAAY,KAAa;IACvC,MAAM,SAAS,QAAQ,GAAG,CAAC,UAAU,IAAI;IACzC,IAAI,CAAC,QAAQ,MAAM,IAAI,MAAM;IAC7B,IAAI;QACF,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAM;QACN,OAAO;IACT;AACF"}},
    {"offset": {"line": 215, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/lib/storage.ts"],"sourcesContent":["import admin from \"firebase-admin\"\nimport type { Bucket } from \"@google-cloud/storage\"\n\nexport type StorageCategory =\n  | \"bidding-documents\"\n  | \"technical-proposals\"\n  | \"financial-proposals\"\n  | \"procurement-specifications\"\n  | \"vendor-quotations\"\n  | \"contracts\"\n  | \"progress-photos\"\n  | \"proof-of-delivery\"\n\nexport type FirebaseConfig = {\n  projectId: string\n  clientEmail: string\n  privateKey: string\n  bucket: string\n}\n\nexport type UploadOptions = {\n  category: StorageCategory\n  filename: string\n  contentType: string\n  projectId?: string\n  bidId?: string\n  procurementId?: string\n  vendorId?: string\n  userId?: string\n  cacheControl?: string\n  makePublic?: boolean\n  gzip?: boolean\n  metadata?: Record<string, string>\n}\n\nexport type UploadResult = {\n  path: string\n  size: number\n  contentType: string\n  md5Hash?: string\n  generation?: string\n  etag?: string\n  mediaLink?: string\n  publicUrl?: string\n  signedUrl?: string\n}\n\nconst allowedMime = new Set<string>([\n  \"application/pdf\",\n  \"application/msword\",\n  \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n  \"application/vnd.ms-excel\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\n  \"text/csv\",\n  \"image/jpeg\",\n  \"image/png\",\n])\n\nfunction sanitize(name: string): string {\n  return name\n    .toLowerCase()\n    .replace(/[^a-z0-9_.-]+/g, \"-\")\n    .replace(/-+/g, \"-\")\n    .replace(/^-|-$|^\\.|\\.$/g, \"\")\n}\n\nfunction ts(): string {\n  return new Date().toISOString().replace(/[^0-9]/g, \"\")\n}\n\nfunction buildPath(o: UploadOptions): string {\n  const parts: string[] = [o.category]\n  if (o.projectId) parts.push(`project_${o.projectId}`)\n  if (o.bidId) parts.push(`bid_${o.bidId}`)\n  if (o.procurementId) parts.push(`proc_${o.procurementId}`)\n  if (o.vendorId) parts.push(`vendor_${o.vendorId}`)\n  if (o.userId) parts.push(`user_${o.userId}`)\n  const name = `${ts()}-${sanitize(o.filename)}`\n  parts.push(name)\n  return parts.join(\"/\")\n}\n\nclass FirebaseStorage {\n  private bucket: Bucket\n\n  constructor(cfg: FirebaseConfig) {\n    if (!admin.apps.length) {\n      admin.initializeApp({\n        credential: admin.credential.cert({\n          projectId: cfg.projectId,\n          clientEmail: cfg.clientEmail,\n          privateKey: cfg.privateKey.replace(/\\\\n/g, \"\\n\"),\n        }),\n        storageBucket: cfg.bucket,\n      })\n    }\n    this.bucket = admin.storage().bucket(cfg.bucket)\n  }\n\n  async uploadBuffer(buf: Buffer, opts: UploadOptions): Promise<UploadResult> {\n    if (!allowedMime.has(opts.contentType)) throw new Error(\"Unsupported content type\")\n    const path = buildPath(opts)\n    const file = this.bucket.file(path)\n    await file.save(buf, {\n      contentType: opts.contentType,\n      gzip: opts.gzip ?? true,\n      resumable: false,\n      metadata: { cacheControl: opts.cacheControl ?? \"public, max-age=31536000\", metadata: opts.metadata },\n    })\n    if (opts.makePublic) await file.makePublic()\n    const [meta] = await file.getMetadata()\n    const res: UploadResult = {\n      path,\n      size: Number(meta.size || 0),\n      contentType: meta.contentType || opts.contentType,\n      md5Hash: meta.md5Hash,\n      generation: meta.generation ? String(meta.generation) : undefined,\n      etag: meta.etag,\n      mediaLink: meta.mediaLink,\n      publicUrl: opts.makePublic ? this.getPublicUrl(path) : undefined,\n    }\n    return res\n  }\n\n  async uploadStream(readable: NodeJS.ReadableStream, opts: UploadOptions): Promise<UploadResult> {\n    if (!allowedMime.has(opts.contentType)) throw new Error(\"Unsupported content type\")\n    const path = buildPath(opts)\n    const file = this.bucket.file(path)\n    const ws = file.createWriteStream({\n      contentType: opts.contentType,\n      gzip: opts.gzip ?? true,\n      resumable: false,\n      metadata: { cacheControl: opts.cacheControl ?? \"public, max-age=31536000\", metadata: opts.metadata },\n    })\n    return new Promise<UploadResult>((resolve, reject) => {\n      ws.on(\"error\", reject)\n      ws.on(\"finish\", async () => {\n        try {\n          if (opts.makePublic) await file.makePublic()\n          const [meta] = await file.getMetadata()\n          resolve({\n            path,\n            size: Number(meta.size || 0),\n            contentType: meta.contentType || opts.contentType,\n            md5Hash: meta.md5Hash,\n            generation: meta.generation ? String(meta.generation) : undefined,\n            etag: meta.etag,\n            mediaLink: meta.mediaLink,\n            publicUrl: opts.makePublic ? this.getPublicUrl(path) : undefined,\n          })\n        } catch (e) {\n          reject(e)\n        }\n      })\n      readable.pipe(ws)\n    })\n  }\n\n  async getSignedUrl(path: string, expiresInSeconds: number = 3600): Promise<string> {\n    const file = this.bucket.file(path)\n    const options = { action: \"read\", expires: Date.now() + expiresInSeconds * 1000 } as any\n    const [url] = await file.getSignedUrl(options)\n    return url\n  }\n\n  getPublicUrl(path: string): string {\n    return `https://storage.googleapis.com/${this.bucket.name}/${path}`\n  }\n\n  async delete(path: string): Promise<void> {\n    const file = this.bucket.file(path)\n    await file.delete({ ignoreNotFound: true })\n  }\n\n  async exists(path: string): Promise<boolean> {\n    const file = this.bucket.file(path)\n    const [ok] = await file.exists()\n    return ok\n  }\n\n  async copy(srcPath: string, destPath: string): Promise<void> {\n    const src = this.bucket.file(srcPath)\n    const dest = this.bucket.file(destPath)\n    await src.copy(dest)\n  }\n\n  async move(srcPath: string, destPath: string): Promise<void> {\n    await this.copy(srcPath, destPath)\n    await this.delete(srcPath)\n  }\n\n  async getMetadata(path: string): Promise<Record<string, unknown>> {\n    const file = this.bucket.file(path)\n    const [meta] = await file.getMetadata()\n    return meta\n  }\n}\n\nexport function createFirebaseStorageFromEnv(): FirebaseStorage {\n  const projectId = process.env.FIREBASE_PROJECT_ID || \"\"\n  const clientEmail = process.env.FIREBASE_CLIENT_EMAIL || \"\"\n  const privateKey = (process.env.FIREBASE_PRIVATE_KEY || \"\").replace(/\\r?\\n/g, \"\\n\")\n  const bucket = process.env.FIREBASE_STORAGE_BUCKET || \"\"\n  if (!projectId || !clientEmail || !privateKey || !bucket) throw new Error(\"Missing Firebase credentials\")\n  return new FirebaseStorage({ projectId, clientEmail, privateKey, bucket })\n}\n\nexport { FirebaseStorage }\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 386, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/constructionplatform%20%281%29/app/api/projects/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport { prisma } from \"@/lib/db\"\nimport { verifyToken } from \"@/lib/auth/jwt\"\nimport { createFirebaseStorageFromEnv } from \"@/lib/storage\"\nimport type { Project } from \"@/lib/database-schema\"\n\nexport async function GET() {\n  try {\n    const items = await prisma.project.findMany({ orderBy: { createdAt: \"desc\" }, include: { _count: { select: { bids: true } }, files: true } })\n    let storage: any = null\n    try {\n      storage = createFirebaseStorageFromEnv()\n    } catch {}\n    const mapped = await Promise.all(\n      items.map(async (p: any) => {\n        const pick = (cat: string) => (p as any).files?.find((f: any) => String(f.category).toLowerCase() === cat)\n        const nameFromPath = (path?: string) => {\n          if (!path) return undefined\n          const base = path.split(\"/\").pop() || \"\"\n          const idx = base.indexOf(\"-\")\n          return idx >= 0 ? base.slice(idx + 1) : base\n        }\n        const withUrl = async (rec?: any) => {\n          if (!rec) return { name: undefined, url: undefined }\n          const name = nameFromPath(rec.path)\n          let url = rec.url\n          if (!url && rec.path && storage) {\n            try {\n              url = await storage.getSignedUrl(rec.path, 3600)\n            } catch {\n              try {\n                url = storage.getPublicUrl(rec.path)\n              } catch {}\n            }\n          }\n          return { name, url }\n        }\n        const itbRec = pick(\"bidding_documents\")\n        const specsRec = pick(\"technical_proposals\")\n        const boqRec = pick(\"procurement_specifications\")\n        const financialRec = pick(\"financial_proposals\")\n        const itbInfo = await withUrl(itbRec)\n        const specsInfo = await withUrl(specsRec)\n        const boqInfo = await withUrl(boqRec)\n        const financialInfo = await withUrl(financialRec)\n        const documents = {\n          itb: itbInfo.name,\n          itbUrl: itbInfo.url,\n          specs: specsInfo.name,\n          specsUrl: specsInfo.url,\n          boq: boqInfo.name,\n          boqUrl: boqInfo.url,\n          financial: financialInfo.name,\n          financialUrl: financialInfo.url,\n        }\n        return {\n          ...p,\n          id: p.id,\n          title: p.title,\n          location: p.location,\n          budget: String(p.budget ?? \"\"),\n          status: p.status,\n          bids: Number((p as any)._count?.bids || 0),\n          documents,\n        }\n      }),\n    )\n    return NextResponse.json(mapped)\n  } catch (e) {\n    return NextResponse.json({ error: \"Failed to load projects\" }, { status: 500 })\n  }\n}\n\nexport async function POST(request: Request) {\n  const body = await request.json()\n  try {\n    const required = [\"title\", \"location\", \"budget\"]\n    for (const k of required) if (!body[k]) return NextResponse.json({ error: `${k} is required` }, { status: 400 })\n    const cleanNum = (v: any) => {\n      const s = String(v ?? \"\")\n      const n = Number(s.replace(/[^0-9.\\-]/g, \"\"))\n      return Number.isFinite(n) ? String(n) : undefined\n    }\n    const auth = request.headers.get(\"authorization\") || \"\"\n    const bearerMatch = /^Bearer\\s+(.+)$/i.exec(auth)\n    const payload = bearerMatch ? verifyToken(bearerMatch[1]) : null\n    let managerId: string | null = null\n    if (payload && payload.role === \"manager\") {\n      try {\n        const mgr = await prisma.manager.findUnique({ where: { userId: payload.sub } })\n        managerId = mgr?.id || null\n      } catch {}\n    }\n    const now = new Date()\n    const y = now.getFullYear()\n    const mm = String(now.getMonth() + 1).padStart(2, \"0\")\n    const d = String(now.getDate()).padStart(2, \"0\")\n    const h = String(now.getHours()).padStart(2, \"0\")\n    const min = String(now.getMinutes()).padStart(2, \"0\")\n    const recordDate = `${y}-${mm}-${d}`\n    const recordTime = `${h}:${min}`\n    const budgetClean = cleanNum(body.budget)\n    if (budgetClean == null) {\n      return NextResponse.json({ error: \"Invalid budget\" }, { status: 400 })\n    }\n    const estimatedClean = body.estimatedCost != null ? cleanNum(body.estimatedCost) : undefined\n    if (body.estimatedCost != null && estimatedClean == null) {\n      return NextResponse.json({ error: \"Invalid estimatedCost\" }, { status: 400 })\n    }\n    const contingencyClean = body.contingency != null ? cleanNum(body.contingency) : undefined\n    if (body.contingency != null && contingencyClean == null) {\n      return NextResponse.json({ error: \"Invalid contingency\" }, { status: 400 })\n    }\n    const contingencyPercentClean = body.contingencyPercent != null ? cleanNum(body.contingencyPercent) : undefined\n    if (body.contingencyPercent != null && contingencyPercentClean == null) {\n      return NextResponse.json({ error: \"Invalid contingencyPercent\" }, { status: 400 })\n    }\n    const retentionPercentClean = body.retentionPercent != null ? cleanNum(body.retentionPercent) : undefined\n    if (body.retentionPercent != null && retentionPercentClean == null) {\n      return NextResponse.json({ error: \"Invalid retentionPercent\" }, { status: 400 })\n    }\n\n    let resolvedManagerId: string | null = managerId\n    if (!resolvedManagerId && body.managerId) {\n      try {\n        const mgrById = await prisma.manager.findUnique({ where: { id: String(body.managerId) } })\n        if (mgrById) {\n          resolvedManagerId = mgrById.id\n        } else {\n          const mgrByUser = await prisma.manager.findUnique({ where: { userId: String(body.managerId) } })\n          resolvedManagerId = mgrByUser?.id || null\n        }\n      } catch {}\n    }\n\n    let created: any = null\n    let mapped: any = null\n    try {\n      created = await prisma.project.create({\n        data: {\n          title: String(body.title),\n          location: String(body.location),\n          budget: budgetClean,\n          status: (body.status || \"Published\") as any,\n          bidsCount: Number(body.bids ?? 0),\n          estimatedCost: estimatedClean ?? null,\n          contingency: contingencyClean ?? null,\n          contingencyPercent: contingencyPercentClean ?? null,\n          paymentSchedule: body.paymentSchedule || null,\n          paymentTerms: body.paymentTerms || null,\n          retentionPercent: retentionPercentClean ?? null,\n          category: body.category || null,\n          description: (body.detailedDescription || body.description || null),\n          clientName: body.clientName || null,\n          clientCompany: body.clientCompany || null,\n          bidDays: body.bidDays ? Number(body.bidDays) : null,\n          maxBids: body.maxBids ? Number(body.maxBids) : null,\n          managerId: resolvedManagerId,\n          contractorId: body.contractorId || null,\n          recordDate,\n          recordTime,\n        },\n      })\n      mapped = { ...created, bids: Number(created.bidsCount || 0), budget: String(created.budget ?? \"\") }\n    } catch {\n      const { createProject } = await import(\"@/lib/file-db\")\n      const createdFile = await createProject({\n        title: String(body.title),\n        location: String(body.location),\n        budget: String(budgetClean),\n        status: (body.status || \"Published\") as any,\n        bids: Number(body.bids ?? 0),\n        estimatedCost: String(estimatedClean ?? \"\"),\n        contingency: String(contingencyClean ?? \"\"),\n        contingencyPercent: String(contingencyPercentClean ?? \"\"),\n        paymentSchedule: body.paymentSchedule || \"\",\n        paymentTerms: body.paymentTerms || \"\",\n        retentionPercent: String(retentionPercentClean ?? \"\"),\n        category: body.category || undefined,\n        description: body.detailedDescription || body.description || undefined,\n        detailedDescription: body.detailedDescription || undefined,\n        managerId: resolvedManagerId || (payload?.sub || \"manager-1\"),\n        contractorId: body.contractorId || undefined,\n        bidDays: body.bidDays ? Number(body.bidDays) : undefined,\n        maxBids: body.maxBids ? Number(body.maxBids) : undefined,\n        clientName: body.clientName || undefined,\n        clientCompany: body.clientCompany || undefined,\n        documents: {},\n      } as any)\n      mapped = { ...createdFile, budget: String(createdFile.budget ?? \"\") }\n    }\n\n    try {\n      const docsInput = body.documents || {}\n      const storage = createFirebaseStorageFromEnv()\n      const now2 = new Date()\n      const yy = now2.getFullYear()\n      const mm2 = String(now2.getMonth() + 1).padStart(2, \"0\")\n      const dd2 = String(now2.getDate()).padStart(2, \"0\")\n      const hh2 = String(now2.getHours()).padStart(2, \"0\")\n      const mn2 = String(now2.getMinutes()).padStart(2, \"0\")\n      const recordDate2 = `${yy}-${mm2}-${dd2}`\n      const recordTime2 = `${hh2}:${mn2}`\n      const nameAndUrl = async (label: string, url?: string, defaultCatHyphen?: string) => {\n        if (!url || typeof url !== \"string\") return undefined\n        if (!url.startsWith(\"data:\")) return undefined\n        const match = /^data:([^;]+);base64,(.+)$/i.exec(url)\n        if (!match) return undefined\n        const contentType = match[1]\n        const base64 = match[2]\n        const buffer = Buffer.from(base64, \"base64\")\n        const catHyphen = defaultCatHyphen || \"bidding-documents\"\n        const catDb = String(catHyphen).replace(/-/g, \"_\") as any\n        try {\n          const result = await storage.uploadBuffer(buffer, {\n            category: catHyphen as any,\n            filename: `${label}.pdf`,\n            contentType,\n            projectId: created.id,\n            makePublic: true,\n          })\n          const urlPublic = result.publicUrl || storage.getPublicUrl(result.path)\n          await prisma.fileStorageRecord.create({\n            data: {\n              category: catDb,\n              url: urlPublic,\n              path: result.path,\n              contentType,\n              size: result.size,\n              projectId: created.id,\n              recordDate: recordDate2,\n              recordTime: recordTime2,\n            },\n          })\n          return { name: `${label}.pdf`, url: urlPublic }\n        } catch {\n          const fakePath = `data-url/${created.id}/${label}.pdf`\n          await prisma.fileStorageRecord.create({\n            data: {\n              category: catDb,\n              url,\n              path: fakePath,\n              contentType,\n              size: buffer.length,\n              projectId: created.id,\n              recordDate: recordDate2,\n              recordTime: recordTime2,\n            },\n          })\n          return { name: `${label}.pdf`, url }\n        }\n      }\n      const itb = await nameAndUrl(\"itb\", docsInput.itbUrl, \"bidding-documents\")\n      const specs = await nameAndUrl(\"specs\", docsInput.specsUrl, \"technical-proposals\")\n      const boq = await nameAndUrl(\"boq\", docsInput.boqUrl, \"procurement-specifications\")\n      const financial = await nameAndUrl(\"financial\", docsInput.financialUrl, \"financial-proposals\")\n      mapped.documents = {\n        itb: itb?.name,\n        itbUrl: itb?.url,\n        specs: specs?.name,\n        specsUrl: specs?.url,\n        boq: boq?.name,\n        boqUrl: boq?.url,\n        financial: financial?.name,\n        financialUrl: financial?.url,\n      }\n    } catch {}\n    return NextResponse.json(mapped, { status: 201 })\n  } catch (e: any) {\n    return NextResponse.json({ error: String(e?.message || \"Failed to create project\") }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}